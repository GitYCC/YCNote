<!DOCTYPE html>
<html lang="zh">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Coding">
        <meta name="keywords" content="">
        <link rel="icon" href="../static/img/favicon.png">

        <title>Coding - YC Note</title>

        <!-- Stylesheets -->
        <link href="../theme/css/all.min.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="YCNote/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="YC Note Full Atom Feed" />
        <link href="YCNote/feeds/coding.atom.xml" type="application/atom+xml" rel="alternate" title="YC Note Categories Atom Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->



    </head>

    <body>

        <!-- Header -->
    <div class="header-container" style="background: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)), url('../images/welcome_front_board.jpg'); background-position: center; background-size: cover;">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="../"><img class="logo" src="../static/img/favicon.png" alt="logo">YC Note</a>
                    </div>
                    <div class="nav pull-right">
                                <a href="../category/coding.html">Coding</a>
                                <a href="../category/aiml.html">AI.ML</a>
                                <a href="../category/reading.html">Reading</a>
                                <a href="../category/recording.html">Recording</a>
                                <a href="../about-me.html">About Me</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title text-uppercase">Coding</h1>
                      <div class="header-underline"></div>
                      <p class="header-subtitle header-subtitle-homepage">www.ycc.idv.tw</p>
                  </div>
              </div>
        </div>
    </div>
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    <div class="archive-container">
        <div class="container content archive">
            <h2><a href="../category/coding.html">Coding : All Articles</u> </a></h2>
            <dl class="dl-horizontal">
            	<dt>2018 / 4月 14</dt>
            	<dd><a href="../introduction-object-oriented-programming_3.html">物件導向武功秘笈（3）：內功篇 — 物件導向指導原則SOLID</a></dd>
              <dd style="border:0.5px solid rgb(200,200,200);padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vh;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><h5><u>物件導向怎麼用才能成就好的程式碼？</u></h5>
<p>一個好的工具，也要配合對於工具的理解，才能發揮效用。<a href="http://www.ycc.idv.tw/YCNote/post/48">在上一回中</a>，我們完整介紹了Java和Python的物件導向實現方式，我們講到了「封裝」、「繼承」、「多型」等等物件導向的特色，也講了「抽象類別」、「接口」等抽象化的方法，不過我並沒有告訴大家該怎麼用這些工具？使用這些工具是不是有什麼樣的法則？</p>
<p>在接下來的這一篇，我將會介紹物件導向的使用方式，我會提到物件導向著名的六大法則：</p>
<ol>
<li>單一職責原理</li>
<li>開閉原理</li>
<li>里氏替換原則</li>
<li>迪米特法則</li>
<li>依賴倒置原則</li>
<li>接口分隔原則</li>
</ol>
<p>在這之前我們先來介紹描述類別關係的UML類別圖。</p>
<h5><u>UML類別圖</u></h5>
<p>開始介紹各種原則之前，先來介紹UML類別圖，UML全名稱為Unified Modeling Language，是一種使用圖形來描繪軟體工程架構的方法，這邊準備介紹的是它的類別圖，這個工具有助於我們快速的了解物件與物件之間的關係。</p>
<ul>
<li>類別(Class): -代表<code>private</code>，+代表<code>public</code>，#代表<code>protected</code></li>
</ul>
<p><img alt="Class" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Class.png"></p>
<ul>
<li>抽象類別(Abstract Class)</li>
</ul>
<p><img alt="AbstractClass" src="https://www.ycc.idv.tw/media/SOLID_Introduction/AbstractClass.png"></p>
<ul>
<li>接口(Interface)</li>
</ul>
<p><img alt="Interface" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Interface.png"></p>
<ul>
<li>繼承關係(Inheritance)和抽象類、接口實現</li>
</ul>
<p><img alt="Inheritance" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Inheritance.png"></p>
<ul>
<li>關聯關係(Association)：A類中使用B類當作「成員變數」，但是A和B並沒有「擁有」的關係，只能說是「有個」的關係，就稱為：A關聯到B，英文為"has-a"的關係。</li>
</ul>
<p><img alt="Associatione" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Association.png"></p>
<ul>
<li>聚合關係(Aggregation)：A類中使用B類當作「成員變數」，而且A和B有一個弱的「擁有」關係，A包含B，但B不是A的一部分，拔掉B，A依然能存在，就稱為：A聚合到B，英文為"owns-a"關係。</li>
</ul>
<p><img alt="Aggregation" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Aggregation.png"></p>
<ul>
<li>合成（組合）關係(Composition)：A類中使用B類當作「成員變數」，而且A和B有一個強的「擁有」關係，B是A的組成的一部分，拔掉B，A就不完整，就稱為：A合成到B，英文為"is-part-of"關係。</li>
</ul>
<p><img alt="Composition" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Composition.png"></p>
<ul>
<li>依賴關係(Dependency)：A類中使用到B類，但僅僅是弱連結，譬如：B類作為A類方法的參數、B類作為A類的局域變數、A類調用B類的靜態方法、B類作為A類方法的回傳值，就稱為：A依賴B，英文為"uses-a"的關係。</li>
</ul>
<p><img alt="Dependency" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Dependency.png"></p>
<h5><u>單一職責原則(Single Responsibility Principle, SRP)</u></h5>
<ul>
<li>
<p>定義：There should never be more than one reason for a class to change.（一個類別中不要有多於一個以上的變化理由）</p>
</li>
<li>
<p>簡單的說，就是一個類別中不要做超過一件事，要去切分直到不能再分割為止，如此一來可以提高內聚性。</p>
</li>
<li>
<p>乍看之下，這樣的原則很容易實現，但是魔鬼藏在細節裡，我們常常會沒注意到其實還可以繼續的切分。舉個例子，假設我想設計一個電話的接口，我可能是這樣設計的</p>
</li>
</ul>
<p><img alt="phone_1" src="https://www.ycc.idv.tw/media/SOLID_Introduction/phone_1.png"></p>
<p>乍看之下沒有問題，一個電話擁有撥號、掛號、數據傳送和接收，但是等等！連接的過程和數據的傳輸其實是兩個職責啊！它們之間沒有強烈的關聯性，完全是可以分開處理的，因此這個配置不符合「單一職責原則」，可以繼續切分下去，修改如下。</p>
<p><img alt="phone_2" src="https://www.ycc.idv.tw/media/SOLID_Introduction/phone_2.png"></p>
<ul>
<li>「單一職責原則」原文指的是類別的單一職責，但是務實上，類別如果切分到如此程度，程式碼會變得細碎不堪，這違反了程式碼的「可讀性」，所以我們一般只要求「接口必須保持單一原則」，而類別去套用接口，類別就盡量達成少的職責就好。</li>
</ul>
<h5><u>開閉原則(Open-Closed Principle, OCP)</u></h5>
<ul>
<li>
<p>定義：Software entities (classes, modules, functions, etc.) should be open for extension, but closed for modification.（軟體中的實體，例如：類、模組、函數等等，都必須對延伸開放，但對修改封閉）</p>
</li>
<li>
<p>對延伸開放：實體在因應新的改變時，必須是可以靈活擴充的。</p>
</li>
<li>
<p>對修改封閉：實體一旦完成，就盡量不要再去修改它了。</p>
</li>
<li>
<p>綜合以上兩點，我們可以總結出：實體本身的內聚性要高，可以讓我們未來不需要再做修改，單一職責可以做到增強內聚性；實體間的耦合性要低，所以實體像是積木一樣可以因應各種需求去任意組合、擴充。所以「開閉原則」只是進一步的把「低耦合高內聚」再說的更清楚一點，實現「開閉原則」將有利於單元測試、提高維護和擴充能力。</p>
</li>
</ul>
<h5><u>里氏替換原則(Liskov Subsititution Principle, LSP)</u></h5>
<ul>
<li>
<p>定義：What is wanted here is something like the following substitution property: If for each object o1 of type S there is an object o2 of type T such that for all programs P defined in terms of T, the behavior of P is unchanged when o1 is substituted for o2 then S is a subtype of T.（簡言之：子類對象能夠替換其父類對象，使用父類方法而不會有問題）</p>
</li>
<li>
<p>「里氏替換原則」用於規範繼承，子類繼承自父類的方法是保有彈性可以覆寫(Overriding)和多載(Overloading)的，但是應該怎麼做，程式碼才不會髒掉？「里氏替換原則」告訴我們一個簡單的法則，就是先寫一段父類的執行代碼，然後把父類替換成子類，然後再跑跑看能不能正常執行，如果正常執行代表這個繼承關係是健康的。</p>
</li>
<li>
<p>為什麼要這樣檢查？之前我們提過繼承主要是為了要避免Repeat Yourself而生，我們找出各種類別共享的屬性和方法，把它獨立出來，然後大家再一起繼承自它，所以我們要盡可能的避免父類出現不是共享的性質。也就是說在理想情況下「父類必須等於子類們的交集」，所以「父類必定是任一子類的子集合」，因此「使用子類來執行父類是不應該有問題的」，這就是「里氏替換原則」。</p>
</li>
<li>
<p>為了遵循「里氏替換原則」，則子類必須完全實現父類的方法。如果子類不能完整地實現父類的方法，或者父類的某些方法在子類中已經發生了「畸變」，則建議斷開父子繼承關係，採用依賴、聚集、組合等關係替代。</p>
</li>
<li>
<p>有了「里氏替換原則」，我們終於可以談談一個上一章沒提到的重要問題：什麼情況可以做繼承？有一些書籍會告訴你，繼承為"is-a"的關係，例如：瑪爾濟斯(B) is-a 狗(A)，所以瑪爾濟斯(B)可以繼承狗(A)，乍看之下沒問題，但這樣的說法存在缺陷，舉個例子，假設今天我先有了類別<code>Retangle</code>，也就是長方形，然後我想要弄一個新的類別<code>Square</code>，也就是正方形，我可以讓<code>Square</code>繼承自<code>Retangle</code>嗎？我們用"is-a"來檢視：正方形是一個長方形？答案是Yes，但是「里氏替換原則」持相反意見，來看一下，</p>
</li>
</ul>
<p><img alt="square_1" src="https://www.ycc.idv.tw/media/SOLID_Introduction/square_1.png"></p>
<p>依照「里氏替換原則」，<code>Square</code>不能繼承自<code>Retangle</code>，因為<code>Square</code>只需要<code>width</code>的成員變數，而<code>Retangle</code>則需要<code>width</code>和<code>height</code>兩個成員變數，當我們將子類<code>Square</code>放到父類<code>Retangle</code>的方法中，因為缺少<code>height</code>變數，必然會出錯，所以違反「里氏替換原則」，因此這兩類不適合作為「繼承」關係。我們可以這樣改善，讓<code>Square</code>應用<code>Retangle</code>來幫忙計算，使用「關聯」關係取代「繼承」關係。</p>
<p><img alt="square_2" src="https://www.ycc.idv.tw/media/SOLID_Introduction/square_2.png"></p>
<ul>
<li>下面這一張集合圖是我自創的，圖中清楚的指出「繼承」中的父類和子類應該是什麼樣的關係。</li>
</ul>
<p><img alt="Inheritance Principle.jpeg" src="https://www.ycc.idv.tw/media/SOLID_Introduction/inheritance_principle.jpeg"></p>
<h5><u>迪米特法則(Law of Demeter, LoD)</u></h5>
<ul>
<li>
<p>又稱為「最少知識原則」</p>
</li>
<li>
<p>定義：</p>
<ol>
<li>Each unit should have only limited knowledge about other units: only units "closely" related to the current unit.</li>
<li>Each unit should only talk to its friends; don't talk to strangers.</li>
<li>Only talk to your immediate friends.</li>
</ol>
</li>
<li>
<p>「朋友」的定義：對於類別C的所有方法M而言，在M的方法中僅能訪問以下物件的方法</p>
<ul>
<li><code>self</code>，類別C自身</li>
<li>M的輸入參數</li>
<li>C的成員變數</li>
<li>M的輸出物件</li>
<li>全域變數的物件</li>
</ul>
</li>
<li>
<p>白話總結：</p>
<ol>
<li>僅能訪問那些類別出現在自身、成員變數、方法的輸入和輸出參數中的方法。</li>
<li>減少類別的對外方法，將沒必要對外公布的方法隱藏起來。 </li>
</ol>
</li>
</ul>
<p><strong>（詳解）僅能訪問那些類別出現在自身、成員變數、方法的輸入和輸出參數中的方法。</strong></p>
<p>-- 例子: 假設今天一名老師給了學生名條想叫班長幫忙點名。</p>
<p>錯誤示範：</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Student</span><span class="p">:</span> <span class="c1">#friends: None</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

<span class="k">class</span> <span class="nc">Leader</span><span class="p">:</span> <span class="c1">#friends: Student</span>
    <span class="k">def</span> <span class="nf">countStudents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">student_list</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Total number of students is &quot;</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">student_list</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">Teacher</span><span class="p">:</span> <span class="c1">#friends: Leader</span>
    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name_list</span><span class="p">,</span><span class="n">leader</span><span class="p">):</span>
        <span class="n">student_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">:</span>
            <span class="n">student_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Student</span><span class="p">(</span><span class="n">name</span><span class="p">))</span> <span class="c1">#`Student` is not a friend</span>
        <span class="n">leader</span><span class="o">.</span><span class="n">countStudents</span><span class="p">(</span><span class="n">student_list</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">teacher</span> <span class="o">=</span> <span class="n">Teacher</span><span class="p">()</span>
    <span class="n">leader</span> <span class="o">=</span> <span class="n">Leader</span><span class="p">()</span>
    <span class="n">name_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>
    <span class="n">teacher</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span><span class="n">leader</span><span class="p">)</span>
</pre></div>


<p><img alt="teacher-leader-student_1" src="https://www.ycc.idv.tw/media/SOLID_Introduction/teacher-leader-student_1.png"></p>
<p>以上程式違反「迪米特法則」，因為在類別<code>Teacher</code>的方法<code>command</code>中訪問了不是朋友的<code>Student</code>，這會使得<code>Teacher</code>和<code>Student</code>會產生不必要的耦合，我們可以將創造<code>student_list</code>的權責轉移到<code>Leader</code>上，如此一來就可以斷開<code>Teacher</code>和<code>Student</code>的耦合。</p>
<p>正確示範：</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Student</span><span class="p">:</span> <span class="c1">#friends: None</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

<span class="k">class</span> <span class="nc">Leader</span><span class="p">:</span> <span class="c1">#friends: Student</span>
    <span class="k">def</span> <span class="nf">giveNameList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name_list</span><span class="p">):</span>
        <span class="n">student_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">:</span>
            <span class="n">student_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Student</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">__student_list</span> <span class="o">=</span> <span class="n">student_list</span>

    <span class="k">def</span> <span class="nf">countStudents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Total number of students is &quot;</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__student_list</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">Teacher</span><span class="p">:</span> <span class="c1">#friends: Leader</span>
    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name_list</span><span class="p">,</span><span class="n">leader</span><span class="p">):</span>
        <span class="n">leader</span><span class="o">.</span><span class="n">giveNameList</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span>
        <span class="n">leader</span><span class="o">.</span><span class="n">countStudents</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">teacher</span> <span class="o">=</span> <span class="n">Teacher</span><span class="p">()</span>
    <span class="n">leader</span> <span class="o">=</span> <span class="n">Leader</span><span class="p">()</span>
    <span class="n">name_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>
    <span class="n">teacher</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span><span class="n">leader</span><span class="p">)</span>
</pre></div>


<p><img alt="teacher-leader-student_2" src="https://www.ycc.idv.tw/media/SOLID_Introduction/teacher-leader-student_2.png"></p>
<p>-- Why it works? </p>
<p>先來想想「朋友」有什麼共通之處？其實它們都是類別本身無法斷開耦合的物件，既然無法斷開耦合，何不運用到底，運用這些「朋友」來完成任務，不要再去增加其他的耦合性，也同時幫助提升類別的內聚性，這就是「迪米特法則」真正想做的事。</p>
<p>以這樣的方式去寫程式，也可以避免寫出像是<code>A.getB().getC()</code>的程式碼（A和C不是朋友），這樣冗長的程式碼不僅增加了無益的耦合，也讓程式變得不利於可讀性。</p>
<p><strong>（詳解）減少類別的對外方法，將沒必要對外公布的方法隱藏起來。</strong></p>
<p>-- 例子: 安裝程式。</p>
<p>錯誤範例：</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Wizard</span><span class="p">:</span> <span class="c1"># 3 public methods</span>
    <span class="k">def</span> <span class="nf">first</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Install first step of wizard at mode&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Install second step of wizard at mode &quot;</span><span class="o">+</span><span class="n">mode</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">third</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Install third step of wizard&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Install</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">install</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wizard</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="n">wizard</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
        <span class="n">wizard</span><span class="o">.</span><span class="n">second</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
        <span class="n">wizard</span><span class="o">.</span><span class="n">third</span><span class="p">()</span>
</pre></div>


<p>有太多沒必要對外公布的細節了，依照「迪米特法則」，我們應該將盡量減少對外公布的資訊，把不必要公布的細節私有化。</p>
<p>正確範例：</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Wizard</span><span class="p">:</span> <span class="c1"># only 1 public method</span>
    <span class="k">def</span> <span class="nf">install</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__first</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__second</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__third</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__first</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Install first step of wizard&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Install second step of wizard at mode &quot;</span><span class="o">+</span><span class="n">mode</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__third</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Install third step of wizard&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Install</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">install</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wizard</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="n">wizard</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
</pre></div>


<h5><u>依賴倒置原則(Dependence Inversion Principle, DIP)</u></h5>
<ul>
<li>
<p>定義：High level modules should not depend upon low level modules. Both should depend upon abstractions. Abstractions should not depend upon details. Details should depend upon abstractions.（高層次模組不應該依賴低層次模組，兩者都應該依賴抽象。而抽象不應該依賴細節，反之細節應該要依賴抽象。）</p>
</li>
<li>
<p>範例：假設我們成立一家玩具車公司，開始著手設計我們的第一款車款A，設計的架構圖如下</p>
</li>
</ul>
<p><img alt="toycar_1" src="https://www.ycc.idv.tw/media/SOLID_Introduction/toycar_1.png"></p>
<p><code>ToyCarA</code>是我們的實體車子，可以使用<code>setRPM</code>來設定在幾秒之後到達什麼轉速，而控制他的是電腦模擬的虛擬車<code>VirtualCar</code>，虛擬車提供方法<code>setSpeeed</code>可以設定車速，當然！模擬的車速要和真實車速吻合，還需配合適當的調控實體車的轉速，所以<code>VirtualCarA</code>關聯到<code>ToyCarA</code>去做控制。然後我們公司會提供一個控制器<code>ControllerA</code>來控制車子，控制器上的搖桿分為五級，讓使用者可以控制速度，使用<code>controlBarLevel</code>方法根據級數去控制<code>VirtualCarA</code>的速度。</p>
<p>檢驗一下這個設計圖，它違反「依賴倒置原則」，<code>ControllerA</code>依賴<code>VirtualCarA</code>，<code>VirtualCarA</code>依賴<code>ToyCarA</code>，這些都是實體類別，高層次依賴了低層次。不過，公司的車子A還是賣得很好，沒有什麼大礙。</p>
<p>終於有一天災難降臨了，市場出現了比車子A馬力更強大的玩具車，我們公司如果不趕緊採用新的馬達推出新的車款，就會失去競爭力，我們需要採用新的玩具車<code>ToyCarB</code>，它擁有更好的馬達，我們需要為因應高速度而推出九級分級的搖桿，新的控制器<code>ControllerB</code>，結果回頭一看原本設計圖，完了！所有的A系列的程式碼都耦合在一起了，核心程式<code>VirtualCarA</code>原可以不需要大改，就建造出<code>VirtualCarB</code>的，但是現在程式碼全部耦合在一起，它已經變得不可擴張了。</p>
<p>如果我們一開始就依照「依賴倒置原則」，我們來看看擴張會有多容易</p>
<p><img alt="toycar_2" src="https://www.ycc.idv.tw/media/SOLID_Introduction/toycar_2.png"></p>
<p><code>VirtualCar</code>中的很多方法都可以在B車款上再重用，大大的減少重新開發的成本。</p>
<ul>
<li>
<p>依賴倒置原則又稱為「面向接口原則」，這裡的接口應該想的更廣義一點，不侷限在interface上，我認為只要藉由抽象化將架構擬定出來的這些抽象單元都可以稱作接口，「廣義的接口」可以是指</p>
</li>
<li>
<p>客戶端和業務邏輯的分離介面</p>
</li>
<li>物件的開放方法</li>
<li>抽象類別</li>
<li>定義行為的interface</li>
</ul>
<p>我們不讓作為實現的類別彼此依賴，而是使用接口將抽象架構擬定好，再讓類別去依賴接口實現目標。</p>
<h5><u>接口分隔原則(Interface Segregation Principle, ISP)</u></h5>
<ul>
<li>
<p>定義：Clients should not be forced to depend uponn interfaces that they don't use. The dependency of one class to another one should depend on the smallest possible interface.（客戶類不應該被強迫依賴那些它不需要的接口，類別間的彼此依賴應該建立在盡可能小的接口上）</p>
</li>
<li>
<p>這裡說的接口同樣的是剛剛所說的「廣義接口」，可以是客戶端和業務邏輯的分離介面、物件的開放方法、抽象類別和Interface。</p>
</li>
<li>
<p>接口分隔原則建議我們要讓這些廣義接口盡可能的細切，但在實務上，切的過細會導致程式碼非常零碎難以閱讀，所以YC的建議是切到遵守「單一職責原理」就足夠了，與剛剛的建議一致，Interface一定要遵守「單一職責原理」，但是類別就盡力而為吧！</p>
</li>
<li>
<p>範例：剛剛玩具車公司的設計圖其實還是不夠好，如果今天公司想要開發新的車款C，添加新「方向盤」的功能，你會發現夢魘又再次的降臨，抽象類別<code>ToyCar</code>、<code>VirtualCar</code>、<code>Controller</code>都需要改變，而且就算真的把「方向盤」的相關方法添加上去，抽象類別也會開始出現多於一的職責，所以我們用Interface來重新改寫架構，如下圖所示。不難看出，控制馬達、控制速度、控制搖桿的行為是彼此依賴的，我們可以將他們的行為由Interface獨立拉出並相互依賴。</p>
</li>
</ul>
<p><img alt="toycar_3" src="https://www.ycc.idv.tw/media/SOLID_Introduction/toycar_3.png"></p>
<p>如此一來，當我們想要開發新的車款C，添加新「方向盤」的功能，也能輕鬆的擴充，如下所示。<code>ToyCarPlus</code>、<code>VirtualCarPlus</code>、<code>ControllerPlus</code>是我們實作C車款的抽象類別，它現在可以直接套用<code>IMotor</code>、<code>ISpeed</code>、<code>IControlBar</code>的Interface。</p>
<p><img alt="toycar_4" src="https://www.ycc.idv.tw/media/SOLID_Introduction/toycar_4.png"></p>
<h5><u>總結：物件導向的指導原則—SOLID</u></h5>
<p>上面介紹的六大原理：</p>
<ol>
<li>Single Responsibility Principl</li>
<li>Open-Closed Principle</li>
<li>Liskov Subsititution Principle</li>
<li>Law of Demeter</li>
<li>Interface Segregation Principle</li>
<li>Dependence Inversion Principle</li>
</ol>
<p>剛剛好組成SOLID這個單字，所以又被統稱SOLID原則。</p>
<p>事實上，這些原則所要達到的目的，不外乎就是我們<a href="http://www.ycc.idv.tw/YCNote/post/47">第一篇</a>當中所介紹的好的程式碼特性：「正常執行」、「穩健」、「不重複撰寫」、「可讀性」、「可擴展」，或者是「低耦合、高內聚」，所以寫程式時如果能時時注意，說不定你也可以自己領會這六大法則。</p>
<p>我來快速的總結這六大法則告訴我們的事：</p>
<ol>
<li>在開發程式的初期，先定義好抽象架構，也就是廣義的接口，徹底的使客戶端與業務邏輯分離，將「行為」定義成Interface，將「類別的泛化」定義成Abstract Class。</li>
<li>所有的實體類別都依賴於抽象，細節依賴於抽象。</li>
<li>每個單元盡量達到：單一權責、對延伸開放但對修改封閉、盡可能少的對外方法。</li>
<li>牽涉「繼承」，必須要問自己：子類可以替換父類執行嗎？父類是不是為子類的交集？</li>
<li>類別中的方法僅能訪問那些類別出現在自身、成員變數、方法的輸入和輸出參數中的。</li>
</ol>
<p>如此一來，我們心中就有一個準則去使用物件導向。</p>
<p>在一般情形下，這三篇的內容應該就足夠讓你寫出好的程式碼，但是實際面上使用仍然會碰到許多問題，於是乎有人將問題整理並總結出一些套路，這就是「設計模式」，我們以後再來談談吧！今天就先到這。</p>
<h5><u>Reference</u></h5>
<ol>
<li><a href="https://www.tenlong.com.tw/products/9789866761799">大話設計模式</a></li>
<li><a href="https://www.tenlong.com.tw/products/9787111437871">設計模式之禪</a></li>
</ol></dd>
              
            	<dt>2018 / 4月 10</dt>
            	<dd><a href="../introduction-object-oriented-programming_2.html">物件導向武功秘笈（2）：招式篇 — Python與Java的物件導向編程介紹</a></dd>
              <dd style="border:0.5px solid rgb(200,200,200);padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vh;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><h5><u>物件導向編程</u></h5>
<p><a href="http://www.ycc.idv.tw/YCNote/post/47">在上一章當中</a>，我們藉由好的程式碼的特性：「正常執行」、「穩健」、「不重複撰寫」、「可讀性」、「可擴展」，自然而然引出物件導向的概念。在這一章當中YC會接續介紹完整的物件導向要如何實現，包括物件導向三大特性：封裝、繼承和多型。</p>
<p>在本章我會採用兩種語言交叉作說明，一種是靜態型別的語言Java，另一種是動態型別的語言Python，這兩種語言都是可以實現物件導向的語言，而所謂型別的動態與靜態可以用一個簡單的方法來區分：型別檢查(Type Checking)發生在什麼時候？像Java這類的靜態型別語言，它的型別檢查是在編譯時期(Compile Time)完成的，而像是Python這類的動態型別語言，它的型別檢查則是在執行時期(Runtime)才去做，所以Python可以不事先宣告變數型別，這點使得Python在開發上方便許多。</p>
<p>雖然Python和Java都是支援物件導向的語言，但在使用上有很大的差異，首先，因為Python的動態型別，所以有些物件導向的性質對它來說就不是那麼重要，另外，因為Python追求簡潔，簡化了相當多的東西，所以很多的使用方法不同於傳統的物件導向，需要認識到這些差異才可以讓你使用Python的物件導向不會顯得很彆扭。Java是一套對物件導向支援非常完整的語言，而Python是一套易於快速開發的語言，使用兩種語言說明物件導向是為了讓讀者更能了解物件導向的本質，而非語言本身。</p>
<p>本篇採用『<a href="https://www.tenlong.com.tw/products/9789866761799">大話設計模式</a>』書中的物件導向篇範例。</p>
<h5><u>類別(Class)與物件(Object)</u></h5>
<p>首先來看物件導向的基本組成，類別(Class)與物件(Object)。
<em> 類別：建立物件的藍圖，描述所建立的物件共同的屬性和方法。
</em> 物件：一個自我包含的實體，物件包括屬性（Properties）和方法（Methods），屬性就是需要記憶的資訊，方法就是物件能夠提供的服務。</p>
<p>舉個例子，我想要創造一隻有名字的貓，她有喵喵叫的能力，在Java中可以寫成</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">class</span> <span class="nc">Cat</span> <span class="o">{</span>  <span class="c1">//{1}</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span> <span class="c1">//{2}</span>

    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="c1">//{3}</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span> <span class="c1">//{4}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span> <span class="c1">//{5}</span>
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. meow~&quot;</span><span class="o">;</span> <span class="c1">//{6}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span> <span class="c1">//{7}</span>
        <span class="n">Cat</span> <span class="n">cat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cat</span><span class="o">(</span><span class="s">&quot;May&quot;</span><span class="o">);</span> <span class="c1">//{8}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">shout</span><span class="o">());</span> <span class="c1">//{9}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// output:</span>
<span class="c1">// My name is May. meow~</span>
</pre></div>


<p>{1} 建構一個<code>Cat</code>的類別，類別不是物件，類別只是物件的藍圖。</p>
<p>{2} 建立一個私有變數<code>name</code>，用來代表貓的名字，我們使用<code>private</code>的修飾詞讓它是私有的，也就是說外部環境沒辦法去讀取到這個變數，只有物件內部才可以讀取的到</p>
<p>{3} 提供建造方法(constructor)來初始化這一個物件，初始化需要<code>name</code>的參數。</p>
<p>{4} 在初始化的過程中，我們會將從外部讀取的<code>name</code>存入私有變數<code>this.name</code>裡，在Java裡頭，如果外部變數名稱與本地變數名稱相同，需要使用<code>this</code>來特別區分。</p>
<p>{5} 創造一個公開的類別方法<code>shout()</code>。</p>
<p>{6} 使用私有變數<code>name</code>讓貓可以自我介紹，再發出喵喵叫的聲音。</p>
<p>{7} Java只要遇到<code>main</code>就會去執行，方法<code>main</code>具有靜態方法的修飾詞<code>static</code>，也就是說<code>Test</code>不需要被實體化也能執行<code>main</code>這個方法。</p>
<p>{8} 使用<code>new</code>來創造一個物件，在創造的過程會執行初始化，所以必須放入初始化需要的參數<code>name</code>，所以上面的新的物件有了<code>"May"</code>的名字。</p>
<p>{9} 接下來使用<code>cat.shout()</code>去執行喵喵叫的動作，這個方法會回傳字串，再利用<code>System.out.println</code>的方法將字串顯示出來。注意！在物件導向的習慣中，會用<code>.</code>來表示在那物件中的方法或屬性，所以<code>cat.shout()</code>就是執行在物件<code>cat</code>中的方法<code>shout()</code>。</p>
<p>再來看Python怎麼表示，</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span> <span class="c1">#{1}</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span> <span class="c1">#{2}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__name</span> <span class="o">=</span> <span class="n">name</span> <span class="c1">#{3}</span>

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1">#{4}</span>
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">__name</span><span class="o">+</span><span class="s2">&quot;. meow~&quot;</span> <span class="c1">#{5}</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">cat</span> <span class="o">=</span> <span class="n">Cat</span><span class="p">(</span><span class="s2">&quot;May&quot;</span><span class="p">)</span> <span class="c1">#{6}</span>
    <span class="k">print</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">shout</span><span class="p">())</span> <span class="c1">#{7}</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span> <span class="c1">#{8}</span>
    <span class="n">main</span><span class="p">()</span>

<span class="c1"># output:</span>
<span class="c1"># My name is May. meow~</span>
</pre></div>


<p>{1} 建構<code>Cat</code>的類別，這是Python3的表示方法，如果是使用Python2.7的話，要寫成<code>class Cat(object):</code>才可以。</p>
<p>{2} Python的初始化方法，Python在初始化之前會先自行執行<code>__new__</code>的方法，這個過程會產生一個新的物件，也就是實體化，而這個新的物件會以第一個參數的方法被帶入<code>__init__</code>的方法裡進行初始化，我們通常會命名這個變數為<code>self</code>，這裡的<code>self</code>已經是個物件而不是類別，那初始化的過程需要引入外部資訊<code>name</code>的參數來進行命名，所以第二個參數就要設<code>name</code>，記住喔！第一個參數是Python自動產生的，不是由外部帶入的，所以外部只要給<code>name</code>一個參數就足夠了。</p>
<p>{3} 創造一個私有本地變數<code>__name</code>來將<code>name</code>存入，在Python當中以雙底線<code>__</code>開頭的變數會被視為是「私有的」，效果和Java的<code>private</code>接近，不過Python並沒有這麼嚴格禁止外部去讀取私有變數，所以需要配合工程師的自我規範。</p>
<p>{4} 類別方法<code>shout()</code>，只要你不是靜態的類別方法，Python都會自動幫你帶入物件資訊當作第一個參數，通常命名為<code>self</code>，那為什麼靜態方法沒有自動帶入，因為靜態方法不用實體化，所以根本不擁有物件的資訊。</p>
<p>{5} 使用到本地的<code>self.__name</code>變數</p>
<p>{6} 創造一個物件，在創造的過程會執行初始化，所以必須放入初始化需要的參數<code>name</code>，所以上面的新的物件有了<code>"May"</code>的名字。</p>
<p>{7} 接下來使用<code>cat.shout()</code>去執行喵喵叫的動作，這個方法會回傳字串，再利用<code>print</code>的方法將字串顯示出來。注意！在物件導向的習慣中，會用<code>.</code>來表示在那物件中的方法或屬性，所以<code>cat.shout()</code>就是執行在物件<code>cat</code>中的方法<code>shout()</code>。</p>
<p>{8} 在Python程式執行時，它的<code>__name__</code>會是<code>"__main__"</code>，也就是說會去執行這個<code>if</code>判斷式下面的程式。</p>
<h5><u>方法多載（Method Overloading）</u></h5>
<p>物件導向允許「使用不同的參數形式去實現同一個方法」，這就稱之為方法多載，這個方法涵蓋一般方法和構造初始化方法。</p>
<p>來延伸剛剛的貓的例子，假設今天我們允許用戶不去設定貓咪的名字，而程式會預先給貓咪No-Name的預設值，所以我們需要另外一個初始化方法是不用貓咪名字的參數形式。</p>
<p>Java的實現程式碼如下所示，如此一來只要碰到沒有參數的形式，程式會給予<code>"No-Name"</code>的名字去當作貓咪的名字，並進行初始化。</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">class</span> <span class="nc">Cat</span> <span class="o">{</span>  
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span> 

    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> 
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span> 
    <span class="o">}</span>
    <span class="c1">// method overloading</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="s">&quot;No-Name&quot;</span><span class="o">);</span> <span class="c1">// given &quot;No-Name&quot; as its name</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. meow~&quot;</span><span class="o">;</span> 
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span> 
        <span class="n">Cat</span> <span class="n">cat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cat</span><span class="o">();</span> <span class="c1">// no-argumant format</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">shout</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// output:</span>
<span class="c1">// My name is No-Name. meow~</span>
</pre></div>


<p>但在Python當中，不允許這種「相同方法名稱，卻又不同參數形式」，Python採用其他的方式來產生同樣的方法多載效果，如以下所示，我們可以看到Python使用default方法來實現多載，只要我們不給予<code>name</code>，它的default就是<code>"No-Name"</code>。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span> 
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;No-Name&quot;</span><span class="p">):</span> <span class="c1"># name&#39;s default is &quot;No-Name&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__name</span> <span class="o">=</span> <span class="n">name</span> 

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">__name</span><span class="o">+</span><span class="s2">&quot;. meow~&quot;</span> 

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">cat</span> <span class="o">=</span> <span class="n">Cat</span><span class="p">()</span> <span class="c1"># no-argument format</span>
    <span class="k">print</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">shout</span><span class="p">())</span> 

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span> 
    <span class="n">main</span><span class="p">()</span>

<span class="c1"># output:</span>
<span class="c1"># My name is No-Name. meow~</span>
</pre></div>


<h5><u>物件導向三大特性—封裝(Encapsulation)</u></h5>
<p>還記得「低耦合，高內聚」的原則嗎？為了符合這原則，每個物件都要盡可能的去包含需要用到的屬性和方法，並且使得外部不能以不合理的方法去影響物件，這就稱之為「封裝」。</p>
<p>我們來看看上次的成果，我們就用這個例子來說明「封裝」。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">class</span> <span class="nc">Calculation</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nums</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span> <span class="o">=</span> <span class="n">nums</span> <span class="c1">#{1}</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__checkPositiveInteger</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__checkPositiveInteger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span> <span class="c1">#{2}</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">num</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid positive integer: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__primeFactorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span> <span class="c1">#{3}</span>
        <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">while</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">prime_factorize</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">num</span> <span class="o">/=</span> <span class="n">i</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">prime_factorize</span>

    <span class="k">def</span> <span class="nf">findGCF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span><span class="p">:</span>
            <span class="n">prime_factorize</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__primeFactorize</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

        <span class="n">common_prime</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">prime_factorize</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">common_prime</span> <span class="o">&amp;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pf</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="n">gcf</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="n">common_prime</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
            <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">prime_factorize</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">pf</span><span class="p">[</span><span class="n">prime</span><span class="p">])</span>
            <span class="n">gcf</span> <span class="o">=</span> <span class="n">gcf</span> <span class="o">*</span> <span class="p">(</span><span class="n">prime</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">gcf</span>

    <span class="k">def</span> <span class="nf">findLCM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">gcf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findGCF</span><span class="p">()</span>
        <span class="n">lcm</span> <span class="o">=</span> <span class="n">gcf</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span><span class="p">:</span>
            <span class="n">lcm</span> <span class="o">*=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="o">/</span><span class="n">gcf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lcm</span>
</pre></div>


<p>{1} 使用私有變數，讓外部不能任意的改變<code>self.__name</code>變數，在這個例子當中，如果<code>self.__name</code>被任意改變，它將會逃過<code>__checkPositiveInteger</code>的檢查。
{2}&amp;{3} 不需要由外部讀取的方法，就盡量讓它是私有的。</p>
<p>再回到貓咪的這個例子，如果我們想要可以調控「叫聲次數」的話，可以這樣實現。</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">class</span> <span class="nc">Cat</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="s">&quot;No-Name&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">shout_num</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span> <span class="c1">//{1}</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getShoutNum</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">shout_num</span><span class="o">;</span> <span class="o">}</span> <span class="c1">//{2}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setShoutNum</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span> <span class="c1">//{3}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">IllegalArgumentException</span><span class="o">();</span>
        <span class="n">shout_num</span> <span class="o">=</span> <span class="n">num</span><span class="o">;</span> 
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">shout_num</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s">&quot;meow~ &quot;</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Cat</span> <span class="n">cat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cat</span><span class="o">(</span><span class="s">&quot;May&quot;</span><span class="o">);</span>
        <span class="n">cat</span><span class="o">.</span><span class="na">setShoutNum</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span> <span class="c1">//{4}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">shout</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// output:</span>
<span class="c1">// My name is May. meow~ meow~ meow~ meow~ meow~</span>
</pre></div>


<p>{1} 設置私有變數<code>shout_num</code>來決定叫聲次數。</p>
<p>{2} 為了做到封裝，外部不能直接去讀取<code>shout_num</code>，而是經由<code>getShoutNum</code>的外部方法來得到叫聲次數，這個<code>getXXX</code>的形式在物件導向裡頭被稱為Getter。</p>
<p>{3} 為了做到封裝，外部不能直接去改變<code>shout_num</code>，而是經由<code>setShoutNum</code>的外部方法來以合理的方法改變叫聲次數，在這個方法中，我們會先檢查再設定，如果是直接的改變<code>shout_num</code>將會少了這一份檢查，這個<code>setXXX</code>的形式在物件導向裡頭被稱為Setter。</p>
<p>{4} 使用Setter方法由外部來改變叫聲次數。</p>
<p>在Python中，Getter和Setter被簡化了。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;No-Name&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__shout_num</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="nd">@property</span>  <span class="c1">#{1}</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__shout_num</span>

    <span class="nd">@shoutNum.setter</span>  <span class="c1">#{2}</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__shout_num</span> <span class="o">=</span> <span class="n">num</span>

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__shout_num</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;meow~ &quot;</span>
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">__name</span><span class="o">+</span><span class="s2">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">cat</span> <span class="o">=</span> <span class="n">Cat</span><span class="p">(</span><span class="s2">&quot;May&quot;</span><span class="p">)</span>
    <span class="n">cat</span><span class="o">.</span><span class="n">shout_num</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1">#{3}</span>
    <span class="k">print</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">shout</span><span class="p">())</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

<span class="c1"># output:</span>
<span class="c1"># My name is May. meow~ meow~ meow~ meow~ meow~</span>
</pre></div>


<p>{1} Python使用Decorator<code>@property</code>來創造Getter，一旦加上了<code>@property</code>，當下的函數方法就會變成一種性質。</p>
<p>{2} 再使用<code>shout_num.setter</code>來替<code>shout_num</code>這個特性加上Setter。</p>
<p>{3} 然後我們就可以以像是修改一般變數的方式來修改<code>shout_num</code>，但實際上<code>shout_num</code>是有被封裝的，如此一來就可以更為簡潔，不用去寫<code>getXX</code>和<code>setXXX</code>等囉唆的寫法。</p>
<h5><u>物件導向三大特性—繼承(Inheritance)</u></h5>
<p>還記得「Don't Repeat Yourself」原則嗎？物件導向同樣提供了這個選項，「繼承」可以讓子類擁有父類的屬性和方法，避免不必要的重寫，但同時也會增加父類和子類之間的耦合，所以使用時要去評估它影響了多少耦合性。</p>
<p>子類可以先繼承父類的屬性和方法，再去新增屬於子類自己的屬性和方法，甚至還可以去覆寫父類的方法，這稱之為方法覆寫(Method Overriding)，有了這些方法，子類可以在不重複撰寫父類方法的情況下，去增加自己的特色和自己的功能。</p>
<p>依循著剛剛的例子，如果我們今天想要增加狗的類別，但是又不想重複撰寫相同的部分，所以我們可以選擇創造動物的類別，再讓貓和狗繼承自動物。</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">class</span> <span class="nc">Animal</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span> <span class="c1">//{1}</span>

    <span class="kd">public</span> <span class="nf">Animal</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Animal</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="s">&quot;No-Name&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kt">int</span> <span class="n">shout_num</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getShoutNum</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">shout_num</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setShoutNum</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">IllegalArgumentException</span><span class="o">();</span>
        <span class="n">shout_num</span> <span class="o">=</span> <span class="n">num</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Cat</span> <span class="kd">extends</span> <span class="n">Animal</span><span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="c1">//{2}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">shout_num</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s">&quot;meow~ &quot;</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">extends</span> <span class="n">Animal</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">shout_num</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s">&quot;woof~ &quot;</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>{1} <code>protected</code>的效果和<code>private</code>一樣，讓外部無法讀取到內部的私有化，但是<code>private</code>無法被「繼承」，而<code>protected</code>可以被繼承，所以如果希望可以被繼承的私有變數或方法，就使用<code>protected</code>。</p>
<p>{2} <code>super</code>指的是父類，這裡我們使用父類來做初始化，事實上這邊可以不用再初始化一次，子類本身就會繼承父類的初始化方法，所以可以像<code>Dog</code>一樣省略不寫。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Animal</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;No-Name&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#{1}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span>
    <span class="nd">@shout_num.setter</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span> <span class="o">=</span> <span class="n">num</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;No_Name&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>  <span class="c1">#{2}</span>

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;meow~ &quot;</span>
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="o">+</span><span class="s2">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span>
<span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;woof~ &quot;</span>
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="o">+</span><span class="s2">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span>
</pre></div>


<p>{1} Python的<code>protected</code>使用單底線<code>_</code>開頭表示。</p>
<p>{2} <code>super</code>指的是父類，這裡我們使用父類來做初始化，事實上這邊可以不用再初始化一次，子類本身就會繼承父類的初始化方法，所以可以像<code>Dog</code>一樣省略不寫。</p>
<h5><u>抽象化：抽象類別(Abstract Class)、抽象方法(Abstract Method)和接口(Interface)</u></h5>
<p>事實上，剛剛使用<code>Animal</code>的方法並不是很正確，我們將<code>Animal</code>當作一個類別處理，所以<code>Animal</code>其實是可以被實例化的，但是<code>Animal</code>根本沒有什麼有用的方法，它必須被繼承後再添加方法才有用處，所以我們其實可以把<code>Animal</code>抽象化，將<code>Animal</code>視為抽象類別，其中擁有一些方法需要在子類實現的，稱為抽象方法，我們直接看怎麼做。</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Animal</span> <span class="o">{</span> <span class="c1">//{1}</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Animal</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Animal</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="s">&quot;No-Name&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kt">int</span> <span class="n">shout_num</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getShoutNum</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">shout_num</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setShoutNum</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">IllegalArgumentException</span><span class="o">();</span>
        <span class="n">shout_num</span> <span class="o">=</span> <span class="n">num</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span> <span class="c1">//{2}</span>
        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">shout_num</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">getShoutSound</span><span class="o">()+</span><span class="s">&quot; &quot;</span><span class="o">;</span> <span class="c1">//{3}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">abstract</span> <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getShoutSound</span><span class="o">();</span> <span class="c1">//{4}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Cat</span> <span class="kd">extends</span> <span class="n">Animal</span><span class="o">{</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getShoutSound</span><span class="o">()</span> <span class="o">{</span> <span class="c1">//{5}</span>
        <span class="k">return</span> <span class="s">&quot;meow~&quot;</span><span class="o">;</span> 
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">extends</span> <span class="n">Animal</span><span class="o">{</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getShoutSound</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;woof~&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>{1} 使用<code>abstract class</code>修飾詞來創建抽象類別，只有在抽象類別中才可以擁有抽象方法，抽象類別不能直接被實例化。</p>
<p>{2} 抽象類別也可以有一般的具體方法。</p>
<p>{3} 這裡使用的<code>getShoutSound()</code>方法要等在子類才會被實現。</p>
<p>{4} 使用<code>abstract</code>設置抽象方法，繼承自抽象類別的子類必須要完全實現所有的抽象方法。</p>
<p>{5} 實現抽象方法。</p>
<p>在Python中沒有原生的抽象類別和方法，必須<code>import abc</code>。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="k">class</span> <span class="nc">Animal</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span> <span class="c1">#{1}</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;No-Name&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span>
    <span class="nd">@shout_num.setter</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span> <span class="o">=</span> <span class="n">num</span>

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getShoutSound</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; &quot;</span>
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="o">+</span><span class="s2">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span>  
    <span class="nd">@abc.abstractmethod</span>  <span class="c1">#{2}</span>
    <span class="k">def</span> <span class="nf">_getShoutSound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_getShoutSound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1">#{3}</span>
        <span class="k">return</span> <span class="s2">&quot;meow~&quot;</span>

<span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_getShoutSound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;woof~&quot;</span>
</pre></div>


<p>{1} 繼承<code>abc.ABC</code>來建立抽象類別。</p>
<p>{2} 使用<code>@abc.abstractmethod</code>來建立抽象方法。</p>
<p>{3} 實現抽象方法。</p>
<p>還有一種類型抽象化的更為徹底，稱之為「接口」，「接口」上的所有方法都是抽象未實現的，「接口」不能擁有任何具體的方法。雖然「接口」很像是完全抽象化的「抽象類別」，也確實可以利用「抽象類別」來創造「接口」，但是兩者的意義是不同的，「抽象類別」是從子類中發現共通的東西，而泛化出現的，但是「接口」可以根本不預先知道子類是什麼，而僅僅事先定義行為本身，換句話說，「抽象類別」是類別的抽象化，而「接口」則是行為的抽象化。</p>
<p>例如，我想要讓某些動物擁有「飛」的能力，這是一個行為，而不會事先知道它會套用到哪一個類別上面。</p>
<p>在Java之中只允許單一繼承，但是卻可以有多個「接口」；而Python沒有現成的「接口」可以使用，我們必須使用「抽象方法」來創造「接口」，所以開發者要謹記「接口」的限制：不能有任何的具體方法，因為Python允許多重繼承，所以就可以直接將模擬「接口」的抽象類別直接疊加上去。</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">interface</span> <span class="nc">IFly</span> <span class="o">{</span> <span class="c1">//{1}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">flyTo</span><span class="o">(</span><span class="n">String</span> <span class="n">place</span><span class="o">);</span> <span class="c1">//{2}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">FlyingCat</span> <span class="kd">extends</span> <span class="n">Cat</span> <span class="kd">implements</span> <span class="n">IFly</span> <span class="o">{</span> <span class="c1">//{3}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">flyTo</span><span class="o">(</span><span class="n">String</span> <span class="n">place</span><span class="o">)</span> <span class="o">{</span> <span class="c1">//{4}</span>
        <span class="k">return</span> <span class="n">shout</span><span class="o">()+</span><span class="s">&quot; I&#39;m going to fly to &quot;</span><span class="o">+</span><span class="n">place</span><span class="o">+</span><span class="s">&quot;.&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">FlyingCat</span> <span class="n">cat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlyingCat</span><span class="o">(</span><span class="s">&quot;May&quot;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">flyTo</span><span class="o">(</span><span class="s">&quot;Taiwan&quot;</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// output: </span>
<span class="c1">// My name is May. meow~ meow~ meow~ I&#39;m going to fly to Taiwan.</span>
</pre></div>


<p>{1} 使用<code>interface</code>創建「接口」，我們習慣會使用開頭大寫I來表示Interface(接口)。</p>
<p>{2} 「接口」定義未實現的抽象方法<code>flyTo</code>。</p>
<p>{3} <code>FlyingCat</code>繼承自<code>Cat</code>並且裝上<code>IFly</code>的「接口」。</p>
<p>{4} 必須實現「接口」上所有的抽象方法。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="k">class</span> <span class="nc">IFly</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span> <span class="c1">#{1}</span>
    <span class="nd">@abc.abstractmethod</span> <span class="c1">#{2}</span>
    <span class="k">def</span> <span class="nf">flyTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">place</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">FlyingCat</span><span class="p">(</span><span class="n">Cat</span><span class="p">,</span><span class="n">IFly</span><span class="p">):</span> <span class="c1">#{3}</span>
    <span class="k">def</span> <span class="nf">flyTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">place</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shout</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; I&#39;m going to fly to &quot;</span><span class="o">+</span><span class="n">place</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">cat</span> <span class="o">=</span> <span class="n">FlyingCat</span><span class="p">(</span><span class="s2">&quot;May&quot;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">fly</span><span class="p">(</span><span class="s2">&quot;Taiwan&quot;</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

<span class="c1"># output: </span>
<span class="c1"># My name is May. meow~ meow~ meow~ I&#39;m going to fly to Taiwan.</span>
</pre></div>


<p>{1} 使用抽象類別來創造「接口」。</p>
<p>{2} 要注意！「接口」裡頭不能有具體方法。</p>
<p>{3} 直接使用多重繼承，將<code>IFly</code>安裝上去。</p>
<h5><u>物件導向三大特性—多型(Polymorphism)</u></h5>
<p>最後，來講講物件導向的最後一個特性，那就是「多型」。「多型」的涵義是指「子類可以以父類的身分出現」，而因為是以父類的角色出現，所以只能執行父類擁有的方法，也就是只能執行這些子類共同泛化分享的方法，當然不同的子類實現後的效果會不一樣，不然使用「多型」的意義就不大了，至於子類自己的特殊方法則不可以使用「多型」去執行。</p>
<p>直接來看範例，假設今天我要邀請三隻貓貓狗狗來參加叫聲比賽，分別請他們叫個幾聲來聽聽，此時就需要使用到「多型」的方法。</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Animal</span> <span class="o">{</span> 
    <span class="kd">protected</span> <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Animal</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Animal</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="s">&quot;No-Name&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kt">int</span> <span class="n">shout_num</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getShoutNum</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">shout_num</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setShoutNum</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">IllegalArgumentException</span><span class="o">();</span>
        <span class="n">shout_num</span> <span class="o">=</span> <span class="n">num</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span> 
        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">shout_num</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">getShoutSound</span><span class="o">()+</span><span class="s">&quot; &quot;</span><span class="o">;</span> 
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">abstract</span> <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getShoutSound</span><span class="o">();</span> 
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Cat</span> <span class="kd">extends</span> <span class="n">Animal</span><span class="o">{</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getShoutSound</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="s">&quot;meow~&quot;</span><span class="o">;</span> 
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">extends</span> <span class="n">Animal</span><span class="o">{</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getShoutSound</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;woof~&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ShoutGame</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Animal</span><span class="o">[]</span> <span class="n">arrayAnimal</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Animal</span><span class="o">[</span><span class="mi">3</span><span class="o">];</span> <span class="c1">//{1}</span>
        <span class="c1">// polymorphism</span>
        <span class="n">arrayAnimal</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cat</span><span class="o">(</span><span class="s">&quot;May&quot;</span><span class="o">);</span> <span class="c1">//{2}</span>
        <span class="n">arrayAnimal</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Dog</span><span class="o">(</span><span class="s">&quot;Linda&quot;</span><span class="o">);</span>
        <span class="n">arrayAnimal</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cat</span><span class="o">(</span><span class="s">&quot;Joy&quot;</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Animal</span> <span class="n">animal</span><span class="o">:</span> <span class="n">arrayAnimal</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">animal</span><span class="o">.</span><span class="na">shout</span><span class="o">());</span> <span class="c1">//{3}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// output: </span>
<span class="c1">// My name is May. meow~ meow~ meow~</span>
<span class="c1">// My name is Linda. woof~ woof~ woof~</span>
<span class="c1">// My name is Joy. meow~ meow~ meow~</span>
</pre></div>


<p>{1} 創建<code>Animal</code>的Array，Animal是抽象類別不能實體化，這裡預定要放的是它的繼承實現類別。</p>
<p>{2} 將<code>Cat</code>和<code>Dog</code>任意放到<code>Animal</code>的Array是可以的，此時就套用「多型」，不管是<code>Cat</code>和<code>Dog</code>都是以<code>Animal</code>的形式出現，只能執行<code>Animal</code>有的方法。</p>
<p>{3} <code>shout()</code>是父類<code>Animal</code>有的方法，可以被執行。</p>
<p>而在Python當中，「多型」就沒這麼重要了，因為Python具有「鴨子型別」（Duck Typing），什麼是「鴨子型別」呢？有一句話道出它的意義：「當看到一隻鳥走起來像鴨子、游泳起來像鴨子、叫起來也像鴨子，那麼這隻鳥就可以被稱為鴨子」，因為Python是動態型別的語言，變數型態不需要事先宣告，所以一個變數具有彈性可以放入任意型別，直到出現不合適的使用方法，才會報錯，所以在Python中變數可以任意放入不同的類別的物件，只要確保這些類別都具有這些變數所需要用到的方法，就可以了，這不正是接近「多型」的概念。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="k">class</span> <span class="nc">Animal</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span> 
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;No-Name&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span>
    <span class="nd">@shout_num.setter</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span> <span class="o">=</span> <span class="n">num</span>

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getShoutSound</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; &quot;</span>
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="o">+</span><span class="s2">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span>  
    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">_getShoutSound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_getShoutSound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;meow~&quot;</span>

<span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_getShoutSound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;woof~&quot;</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Shout Game</span>
    <span class="n">arrayAnimal</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#{1}</span>
    <span class="n">arrayAnimal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Cat</span><span class="p">(</span><span class="s2">&quot;May&quot;</span><span class="p">))</span> 
    <span class="n">arrayAnimal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Dog</span><span class="p">(</span><span class="s2">&quot;Linda&quot;</span><span class="p">))</span>
    <span class="n">arrayAnimal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Cat</span><span class="p">(</span><span class="s2">&quot;Joy&quot;</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">animal</span> <span class="ow">in</span> <span class="n">arrayAnimal</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">animal</span><span class="p">,</span><span class="n">Animal</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">TypeError</span> <span class="c1">#not necessary #{2}</span>
        <span class="k">print</span><span class="p">(</span><span class="n">animal</span><span class="o">.</span><span class="n">shout</span><span class="p">())</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

<span class="c1"># output: </span>
<span class="c1"># My name is May. meow~ meow~ meow~</span>
<span class="c1"># My name is Linda. woof~ woof~ woof~</span>
<span class="c1"># My name is Joy. meow~ meow~ meow~</span>
</pre></div>


<p>{1} 要存入多型的List不需要特別處理。</p>
<p>{2} 可以檢查是不是繼承自<code>Animal</code>，以確保多型的嚴格定義，但這個過程是非必要的。</p>
<h5><u>總結：物件導向使用方法</u></h5>
<p>好！我們花了好大的力氣，終於了解如何在Java和Python中使用物件導向。從一開始的「類別」和「物件」講起，再來談到物件導向的三大特性：「封裝」、「繼承」和「多型」，還談到方法可以「多載」也可以「覆寫」，以及一些抽象化的東西，包括「抽象類別」、「抽象方法」和「接口」。</p>
<p>但是等等！你知道該怎麼運用這些技巧嗎？沒錯，僅僅是了解這些招式不足以讓你寫出卓越的程式碼，你還需要了解如何使用，就像是外功招式還得配合內功才可以是一套完整的功夫，否則只是半吊子而已，我們將在下一章節中來帶大家了解如何去使用這些招式。</p></dd>
              
            	<dt>2018 / 4月 05</dt>
            	<dd><a href="../introduction-object-oriented-programming_1.html">物件導向武功秘笈（1）：認知篇 — 什麼是好的程式？</a></dd>
              <dd style="border:0.5px solid rgb(200,200,200);padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vh;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><h5><u>物件導向為何重要？</u></h5>
<p>我相信很多朋友一定像YC我一樣，想要學某個程式語言，就去買那個程式語言的簡介書籍，然後一章一章的唸下去，這種書通常會先教變數怎麼設定？然後再教if、while、for、function等程式邏輯。</p>
<p>那如果你學的是「物件導向」的語言，譬如：Java、C++、Python，接下來的章節就會開始介紹「類別」、「物件」等等難懂的東西，然後就會陷入一種霧煞煞的狀態，然後心中就會出現一種聲音：為什麼寫個程式你跟我扯什麼「物件」？我原本用前面所學的方法就可以完成所有事情啦！為何要把事情弄的這麼複雜？這東西到底有什麼好處啊？</p>
<p>YC一開始也是充滿著疑惑，然後一知半解的就把這些定義記在心中，然後天真的認為「物件導向」只是讓程式比較整齊的方法罷了！直到後來學了資料結構與演算法，然後又學了一點設計模式，然後又有過幾個大型軟體開發的經驗，一路走過才漸漸的了解「物件導向」是怎麼一回事？</p>
<p>所以我打算把這些收穫用三篇文章來說明，好讓讀者們可以少走一點冤枉路，在第一篇中，也就是本篇，我會帶大家認識好的程式是長什麼樣子的，它擁有什麼樣的特點，有了正確的認知，除了可以讓我們避免寫出糟糕的程式之外，我們也才能漸漸的認識到「物件導向」為何重要。</p>
<h5><u>程式的好壞？</u></h5>
<p>一開始，我們必須要對程式培養出鑑賞能力，我曾經聽過電視上有一位歌唱老師說過：「好的歌手必須先練他的聽力」，我覺得相同的，一個好的Programmer要先培養出對於程式的鑑賞能力。</p>
<p>首先，一個好的程式當然要「能正常執行」，要能滿足客戶的需求，這是基本款，所以一般而言我們會使用很多的測試去看看程式是否可以正常運作，我們會找一些一般的條件來測試，我們也會找一些合法但是位於極端條件的例子，也就是邊界條件（Edge Case）來測試，或者找一些不合法的例子試試程式是否可以排除錯誤條件。</p>
<p>測試可以即早的發現Bug，即早的治療，如果真的發現有Bug的話，接下來就是去找出Bug的源頭，這可就相當的困難，這裡想像一下喔！如果你的程式總共有1000行，而當你測試時發現有Bug，那想從這麼多行當中找出Bug的來源是相當困難的，所以好的方法是這樣的，先將一個大任務分解成為幾個小任務，然後完成這幾個小任務後，逐一的進行測試，稱之為「單元測試」，最後在將這些測試完成的小任務組合成為大任務，然後再做最後的總測試，這麼一來就可以避免在大範圍中找尋Bug，又可以做到對程式從裡到外的完整測試以達到程式「能正常執行」的目的。</p>
<p>這裡提出一個問題讓大家思考，究竟要使用什麼方法去解析問題？讓我們可以有條理的拆解出小「單元」，來組合出最後的目標，有沒有一個系統化的思考方法？</p>
<p>第二點，一個好的程式必須是「穩健的」(Robust)，程式原本能用的功能，不會因為更新、不會因為添加新功能，就出現錯誤！要做到這一點，除了剛剛說的「單元」拆分以外，還要讓「單元」和「單元」之間不會有太多的彼此影響，這麼一來在原先的功能所調用的「單元」不被動到的前提下，我還可以新增新的功能，才能做到「穩健的」特質。</p>
<p>第三點，一個好的程式必須具備「不重複撰寫」的特性，有一句經典的法則叫做「Don't Repeat Yourself」，不要去重複寫已經寫過的程式碼，如果是重複需要用到的「單元」我們就把它獨立出來，讓其他程式去調用它，對於工程師來說，「不重複撰寫」意味著可以少寫一點程式碼，增加開發的速度，更重要的是，調用公享的程式碼可以讓程式更有邏輯，更具一致性，能夠減少出錯的可能性。</p>
<p>第四點，好的程式要具有「可讀性」，軟體開發常常是長時間、多人合作、龐大的程式碼，如果程式碼沒有具備清晰的邏輯、沒有在該註解的部分寫清楚、沒有一個統一的規範，這樣的開發終就會陷入泥坑，永遠解不完的Bug會不斷的出現，解了一個又產生一個，永無止盡的輪迴，而且最慘的是完全不清楚真正的源頭在哪裡，這可是軟體工程師的夢魘啊！</p>
<p>第五點，一個好的程式要具備「可擴展」，工程師最討厭的一句話應該就是客戶說：「我突然想到我還需要XXX功能，這只是在這邊再多一點而已，應該不難吧！」呵呵～通常「這多一點」就要大大的修改整個程式碼，弄不好還可能把原本的功能給搞壞，所以工程師應該在設計的一開始就考慮到會有什麼潛在需要更改的部分，而先採取因應措施，好讓程式易於擴展，好讓自己不會因此而加班！</p>
<h5><u>低耦合、高內聚</u></h5>
<p>再重複一次，一個好的程式要具備「正常執行」、「穩健」、「不重複撰寫」、「可讀性」、「可擴展」的特性，請將這些原則記在心裡，隨時的檢視自己的程式是不是有違反這些規則。</p>
<p>而剛剛我們有了一個大致的想法：將任務分成幾個小的「單元」是一個很好的策略，而為了讓程式「穩健」，這些「單元」之間不能有太多的相依性；但是站在另外一個角度看，為了讓程式「不重複撰寫」，我們需要讓一個「單元」使用另外一個「單元」，好讓工程師可以做到「Don't Repeat Yourself」，如此一來則是增加了「單元」間的相依性，這兩者是一個Trade-off。</p>
<p>有關「單元」的相依性有兩個重要術語—耦合性(Coupling)和聚合性(Cohesion)，耦合性指的是「單元」和「單元」之間資訊或參數依賴的程度，所以我們要追求「低耦合」。聚合性指的是「單元」內使用到自身資訊或參數的程度，所以我們要追求「高內聚」，通常「低耦合」都會伴隨著「高內聚」。</p>
<h5><u>程式碼精練之旅</u></h5>
<p>來看個例子，假設今天我想要實現一個求最大公因數的計算機，使用<strong>Python</strong>隨便寫一段程式碼可能是這樣的。</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">str_numA</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer A: &quot;</span><span class="p">)</span>
    <span class="n">str_numB</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer B: &quot;</span><span class="p">)</span>

    <span class="n">numA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numA</span><span class="p">)</span>
    <span class="n">numB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numB</span><span class="p">)</span>

    <span class="n">prime_factorize_A</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span><span class="p">(</span><span class="n">numA</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">numA</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prime_factorize_A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize_A</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">numA</span> <span class="o">/=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">prime_factorize_B</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span><span class="p">(</span><span class="n">numB</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">numB</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prime_factorize_B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize_B</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">numB</span> <span class="o">/=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>    

    <span class="n">common_prime</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize_A</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize_B</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">gcf</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">common_prime</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">prime_factorize_A</span><span class="p">[</span><span class="n">prime</span><span class="p">],</span><span class="n">prime_factorize_B</span><span class="p">[</span><span class="n">prime</span><span class="p">])</span>
        <span class="n">gcf</span> <span class="o">=</span> <span class="n">gcf</span> <span class="o">*</span> <span class="p">(</span><span class="n">prime</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Greatest Common Factor: &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gcf</span><span class="p">))</span>
</pre></div>


<p>好！那接下來用剛剛的規則來檢視看看這個程式，第一點，有沒有「可正常執行」？上述的例子，沒有考慮到一些Edge Case，當輸入的值不是正整數，必須要報錯，所以我們將程式修改一下。</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">str_numA</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer A: &quot;</span><span class="p">)</span>
    <span class="n">str_numB</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer B: &quot;</span><span class="p">)</span>

    <span class="n">numA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numA</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">numA</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid positive integer: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">numA</span><span class="p">))</span>
    <span class="n">numB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numB</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">numB</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid positive integer: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">numB</span><span class="p">))</span>

    <span class="n">prime_factorize_A</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span><span class="p">(</span><span class="n">numA</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">numA</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prime_factorize_A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize_A</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">numA</span> <span class="o">/=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">prime_factorize_B</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span><span class="p">(</span><span class="n">numB</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">numB</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prime_factorize_B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize_B</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">numB</span> <span class="o">/=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>    

    <span class="n">common_prime</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize_A</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize_B</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">gcf</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">common_prime</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">prime_factorize_A</span><span class="p">[</span><span class="n">prime</span><span class="p">],</span><span class="n">prime_factorize_B</span><span class="p">[</span><span class="n">prime</span><span class="p">])</span>
        <span class="n">gcf</span> <span class="o">=</span> <span class="n">gcf</span> <span class="o">*</span> <span class="p">(</span><span class="n">prime</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Greatest Common Factor: &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gcf</span><span class="p">))</span>
</pre></div>


<p>再來檢查一下是不是具有「不重複撰寫」的特性？也就是Don't Repeat Yourself，顯然是沒有遵守，<code>numA</code>和<code>numB</code>處理方法幾乎一模一樣，這會造成程式碼很冗長，來稍做修改。</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">checkPositiveInteger</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">num</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid positive integer: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">primeFactorize</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">checkPositiveInteger</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

    <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prime_factorize</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">num</span> <span class="o">/=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">prime_factorize</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">str_numA</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer A: &quot;</span><span class="p">)</span>
    <span class="n">str_numB</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer B: &quot;</span><span class="p">)</span>

    <span class="n">numA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numA</span><span class="p">)</span>
    <span class="n">numB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numB</span><span class="p">)</span>

    <span class="n">prime_factorize_A</span> <span class="o">=</span> <span class="n">primeFactorize</span><span class="p">(</span><span class="n">numA</span><span class="p">)</span>
    <span class="n">prime_factorize_B</span> <span class="o">=</span> <span class="n">primeFactorize</span><span class="p">(</span><span class="n">numB</span><span class="p">)</span>

    <span class="n">common_prime</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize_A</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize_B</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">gcf</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">common_prime</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">prime_factorize_A</span><span class="p">[</span><span class="n">prime</span><span class="p">],</span><span class="n">prime_factorize_B</span><span class="p">[</span><span class="n">prime</span><span class="p">])</span>
        <span class="n">gcf</span> <span class="o">=</span> <span class="n">gcf</span> <span class="o">*</span> <span class="p">(</span><span class="n">prime</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Greatest Common Factor: &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gcf</span><span class="p">))</span>
</pre></div>


<p>接下來來檢查一下「穩健度」和「可擴展」，也就是程式是否符合：低耦合、高內聚，其實上面的程式碼有一個大問題，客戶端邏輯和業務邏輯混為一談，客戶端邏輯就是實現功能的部分，而業務邏輯就是實作的細節，所以上面的程式碼把所有的實作的細節全部攤在客戶端，這是相當不好的，這會造成不易更改，因此我們將程式作單元的拆分，讓業務邏輯和客戶端邏輯相分離，讓不直接實現客戶端的程式碼可以隱藏起來，減少客戶端和業務邏輯的耦合。然後順道加入求取最小公倍數的功能。</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="k">def</span> <span class="nf">checkPositiveInteger</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">num</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid positive integer: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">primeFactorize</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">checkPositiveInteger</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

    <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prime_factorize</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">num</span> <span class="o">/=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">prime_factorize</span>

<span class="k">def</span> <span class="nf">findGCF</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>
    <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
        <span class="n">prime_factorize</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">primeFactorize</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

    <span class="n">common_prime</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">prime_factorize</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">common_prime</span> <span class="o">&amp;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pf</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">gcf</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="n">common_prime</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">prime_factorize</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">pf</span><span class="p">[</span><span class="n">prime</span><span class="p">])</span>
        <span class="n">gcf</span> <span class="o">=</span> <span class="n">gcf</span> <span class="o">*</span> <span class="p">(</span><span class="n">prime</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">gcf</span>

<span class="k">def</span> <span class="nf">findLCM</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>
    <span class="n">gcf</span> <span class="o">=</span> <span class="n">findGCF</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
    <span class="n">lcm</span> <span class="o">=</span> <span class="n">gcf</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
        <span class="n">lcm</span> <span class="o">*=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="o">/</span><span class="n">gcf</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lcm</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">str_numA</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer A: &quot;</span><span class="p">)</span>
    <span class="n">str_numB</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer B: &quot;</span><span class="p">)</span>

    <span class="n">numA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numA</span><span class="p">)</span>
    <span class="n">numB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numB</span><span class="p">)</span>

    <span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">numA</span><span class="p">,</span><span class="n">numB</span><span class="p">]</span>    
    <span class="n">gcf</span> <span class="o">=</span> <span class="n">findGCF</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
    <span class="n">lcm</span> <span class="o">=</span> <span class="n">findLCM</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Greatest Common Factor: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gcf</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Lowest Common Multiple: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lcm</span><span class="p">))</span>
</pre></div>


<p>如此一來程式碼就看起來乾淨很多，function和function之間的耦合性被降低了，而function本身的內聚性提高了，程式碼達到了低耦合、高內聚，但是似乎還可以更好。</p>
<h5><u>形塑出物件導向</u></h5>
<p>剛剛我們已經完成了一個看起來很乾淨的程式碼了，但是其實還可以更好，在這裡我們就必須形塑出物件導向，才有辦法再前進一步。</p>
<p>剛剛的程式碼當中的<code>checkPositiveInteger(num)</code>, <code>primeFactorize(num)</code>, <code>findGCF(nums)</code>, <code>findLCM(nums)</code>函數其實都是實現同一個目標—因式計算，但卻是被寫成一個一個獨立的函數，這裡的內聚性還可以再更好。</p>
<p>而且<code>checkPositiveInteger(num)</code>, <code>primeFactorize(num)</code>並不是用來實現主要的目的，而只是實現目的過程中，為了避免重複而產生的，這樣寫很容易讓人不清楚什麼是重要的函數，而什麼只是中繼的函數，這裡的「可讀性」應該還可以再提升。</p>
<p>輸入的數字<code>nums</code>對於<code>findGCF</code>和<code>findLCM</code>，應該是一模一樣的，有沒有一個方法可以讓<code>nums</code>避免重複呢？以增強「不要重複撰寫」的原則。</p>
<p>要擁有以上的功能，我們需要一個「物件」，這個「物件」能夠保有屬於它的變數，才可以儲存<code>nums</code>等參數，變數可以是對外公布的，也可以是私有的。另外,這個「對象」擁有屬於它的函數方法，而方法一樣可以是對外公布的，也可以是私有的，所以我們可以公布<code>findGCF(nums)</code>, <code>findLCM(nums)</code>，而私有化
<code>checkPositiveInteger(num)</code>, <code>primeFactorize(num)</code>。我們使用「藍圖」去建構「物件」的模版，再由「藍圖」配合不同的輸入參數去生成一個一個獨立的「物件」，以因應不同的狀況。</p>
<p>這就是物件導向！</p>
<p>接下來，我將上面程式碼引入物件導向改寫如下。（看不懂～沒關係！未來會詳述）</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="k">class</span> <span class="nc">Calculation</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nums</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span> <span class="o">=</span> <span class="n">nums</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__checkPositiveInteger</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__checkPositiveInteger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">num</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid positive integer: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__primeFactorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
        <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">while</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">prime_factorize</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">num</span> <span class="o">/=</span> <span class="n">i</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">prime_factorize</span>

    <span class="k">def</span> <span class="nf">findGCF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span><span class="p">:</span>
            <span class="n">prime_factorize</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__primeFactorize</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

        <span class="n">common_prime</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">prime_factorize</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">common_prime</span> <span class="o">&amp;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pf</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="n">gcf</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="n">common_prime</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
            <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">prime_factorize</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">pf</span><span class="p">[</span><span class="n">prime</span><span class="p">])</span>
            <span class="n">gcf</span> <span class="o">=</span> <span class="n">gcf</span> <span class="o">*</span> <span class="p">(</span><span class="n">prime</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">gcf</span>

    <span class="k">def</span> <span class="nf">findLCM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">gcf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findGCF</span><span class="p">()</span>
        <span class="n">lcm</span> <span class="o">=</span> <span class="n">gcf</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span><span class="p">:</span>
            <span class="n">lcm</span> <span class="o">*=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="o">/</span><span class="n">gcf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lcm</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">str_numA</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer A: &quot;</span><span class="p">)</span>
    <span class="n">str_numB</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer B: &quot;</span><span class="p">)</span>

    <span class="n">numA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numA</span><span class="p">)</span>
    <span class="n">numB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numB</span><span class="p">)</span>

    <span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">numA</span><span class="p">,</span><span class="n">numB</span><span class="p">]</span>
    <span class="n">calc</span> <span class="o">=</span> <span class="n">Calculation</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
    <span class="n">gcf</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">findGCF</span><span class="p">()</span>
    <span class="n">lcm</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">findLCM</span><span class="p">()</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Greatest Common Factor: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gcf</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Lowest Common Multiple: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lcm</span><span class="p">))</span>
</pre></div>


<h5><u>總結：程式碼鑑賞能力</u></h5>
<p>本章YC帶大家建立一種品味，像是藝術評論家一樣，我們學會了如何鑑賞好的程式碼，我們提到了好的程式碼須要符合「正常執行」、「穩健」、「不重複撰寫」、「可讀性」、「可擴展」的特性，並且提到我們要追求低耦合、高內聚，但是「不重複撰寫」的這個原則會和低耦合相互違和，所以工程師要小心拿捏！有了鑑賞能力，我們開始精練我們的程式，而自然而然就可以引出物件導向的概念。當然，物件導向不只如此啦！我們下章就會看到物件導向還有什麼花拳繡腿。</p></dd>
              
            	<dt>2017 / 5月 06</dt>
            	<dd><a href="../python-play-with-data_3.html">Python玩數據 (3)：Numpy [2/2]</a></dd>
              <dd style="border:0.5px solid rgb(200,200,200);padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vh;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><p>在上一章節的討論，我們已經有了Numpy的基礎概念，在這一篇當中，我們會更深入的了解Numpy還有什麼進階的功能，包括：產生ndarray的多種方法、broadcast的概念以及ndarray的進階操作手法。</p>
<h5><u>產生ndarray的其他方法</u></h5>
<p>在上一章，ndarray的產生方法是由list產生的。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>


<p>Numpy還提供產生ndarray的其他方式，幫助我們更容易的產生ndarray，譬如，產生一個數列。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">E</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">stop</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">stop</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">3.</span> <span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>  <span class="mf">4.</span> <span class="p">,</span>  <span class="mf">4.5</span><span class="p">,</span>  <span class="mf">5.</span> <span class="p">,</span>  <span class="mf">5.5</span><span class="p">])</span>
</pre></div>


<p>stop指的是停止的那點，那點是不包含在產生的數列的。</p>
<p>1D的數列也可轉換成多維度的數列。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span>
<span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">K</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">K</span>
<span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]])</span>
</pre></div>


<p>另外還有一種可以產生連續數列的方法。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">0.</span>  <span class="p">,</span>  <span class="mf">0.25</span><span class="p">,</span>  <span class="mf">0.5</span> <span class="p">,</span>  <span class="mf">0.75</span><span class="p">,</span>  <span class="mf">1.</span>  <span class="p">,</span>  <span class="mf">1.25</span><span class="p">,</span>  <span class="mf">1.5</span> <span class="p">,</span>  <span class="mf">1.75</span><span class="p">,</span>  <span class="mf">2.</span>  <span class="p">])</span>
</pre></div>


<p>這個函數是這樣的，0是起始值，2是最終值，這個最終值是包含在數列裡的，9是代表數列會有九個數字，所以它會自動從這區間找九個數字均勻分配。</p>
<p>另外，也可以產生一個全部都零或一的數列，或是矩陣中的「單位矩陣」。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>     <span class="c1"># &quot;eye&quot; means &quot;I&quot;</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">]])</span>
</pre></div>


<p>或者，你想要亂數產生也可以。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.14405468</span><span class="p">,</span>  <span class="mf">0.2312139</span> <span class="p">,</span>  <span class="mf">0.79134702</span><span class="p">,</span>  <span class="mf">0.18676625</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.95305253</span><span class="p">,</span>  <span class="mf">0.44833768</span><span class="p">,</span>  <span class="mf">0.87919535</span><span class="p">,</span>  <span class="mf">0.69051727</span><span class="p">]])</span>
</pre></div>


<p>如果你想要數列依照你給定的規則產生，就先定義好函數，然後再利用<code>fromfunction</code>製造數列。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">func1</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfunction</span><span class="p">(</span><span class="n">func1</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</pre></div>


<p>這麼一來，每個位置的值都是由我們所定義的函數所決定。如果你覺得那個<code>func1</code>名稱很多餘，還有下面這個方法。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfunction</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</pre></div>


<p>上面我使用了<code>lambda</code>，這個東西稱之為『匿名函數』。</p>
<div class="highlight"><pre><span></span><span class="k">lambda</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span>
</pre></div>


<p>和</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">something</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span>
</pre></div>


<p>上面這兩個函式是等價的，差異只在於，第一個函式是沒有名稱的，稱為匿名函數，第二種就是一般的函式，具有名稱。</p>
<h5><u>Broadcasting</u></h5>
<p>在上一章，我有提到一般的矩陣運算，在Numpy中是採用element-wise operation，也就是每個相應元素做運算，然後產生新的ndarray，這個前題是兩組要運算的ndarray他們的shape是相同的，那如果遇到shape不一致，Numpy會怎麼處理呢？實際上，Numpy會幫你把陣列給延伸展開，就像廣播(broadcasting)一樣的傳遞出去，這遵照所謂的broadcasting rules。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span>      <span class="c1"># element-wise plus</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">6.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">B</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>


<p>上面就是最普遍的兩個相同shape的矩陣作運算。</p>
<p>那如果是這個情況呢？</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">4.</span><span class="p">,</span>  <span class="mf">5.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">6.</span><span class="p">,</span>  <span class="mf">8.</span><span class="p">]])</span>
</pre></div>


<p>你會發現如果矩陣對一個單一元素作運算，其實就等同於這個單一元素對矩陣內的元素分別作運算，這個方式相當好理解，那如果是這樣呢？</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">C</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">D</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">E</span> <span class="o">=</span> <span class="n">C</span> <span class="o">*</span> <span class="n">D</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">E</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">10.</span><span class="p">,</span>  <span class="mf">14.</span><span class="p">,</span> <span class="mf">22.</span> <span class="p">],</span>    <span class="c1"># [[ 2*5, 2*7, 2*11 ],</span>
       <span class="p">[</span> <span class="mf">15.</span><span class="p">,</span>  <span class="mf">21.</span><span class="p">,</span> <span class="mf">33.</span> <span class="p">]])</span>   <span class="c1">#  [ 3*5, 3*7, 3*11 ]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">E</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</pre></div>


<p>讓我來分解解說一下broadcasting究竟做了什麼，broadcasting能自動填滿矩陣有一個大前提，</p>
<blockquote>
<p>參與運算的所有矩陣必須符合以下規則才能做broadcasting，所有矩陣的shape由axis＝-1開始對齊去比較彼此間的rank，所有矩陣的在每個axis下的rank必須符合以下兩種規則其中之一：</p>
<ol>
<li>所有rank為同一個值</li>
<li>只能有一個矩陣rank為非0或1，其餘矩陣的rank都要為0或1</li>
</ol>
</blockquote>
<p>上面這個例子，在axis= -2之下，只有C矩陣rank具有非0或1的2，而D的rank則為1；在axis= -1之下，只有D矩陣rank具有非0或1的3，而C的rank則為1，因此這兩個陣列可以使用broadcasting rule來延伸。</p>
<p>為什麼我們需要這樣的前提假設，原因是符合這樣的情況下，我們可以藉由重複的複製貼上來使得兩個或多個矩陣有一樣的shape，C矩陣shape為(2,1)，所以在axis= -2的方向上，重複貼3次就會產生出shape為(2,3)的矩陣；D矩陣的shape為(1,3)，所以在axis= -1的方向上，重複貼2次就會產生出(2,3)的矩陣，如此一來兩個矩陣都是(2,3)就可以作element-wise operation。</p>
<p>逐步示範一下，</p>
<div class="highlight"><pre><span></span>C  = [[2],[3]] # shape = (2,1)
C&#39; = [[2,2,2],[3,3,3]] # shape = (2,3)
D  = [[5,7,11]] # shape = (1,3)
D&#39; = [[5,7,11],[5,7,11]] # shape = (2,3)
E = C&#39; * D&#39;
</pre></div>


<p>以下這些都是同樣道理</p>
<div class="highlight"><pre><span></span>A      (2d array):  5 x 4
B      (1d array):      1
Result (2d array):  5 x 4

A      (2d array):  5 x 4
B      (1d array):      4
Result (2d array):  5 x 4

A      (3d array):  15 x 3 x 5
B      (3d array):  15 x 1 x 5
Result (3d array):  15 x 3 x 5

A      (3d array):  15 x 3 x 5
B      (2d array):       3 x 5
Result (3d array):  15 x 3 x 5

A      (3d array):  2 x 3 x 4
B      (2d array):      3 x 1
Result (3d array):  2 x 3 x 4
</pre></div>


<p>我們再來看一下，如果維度不一樣是怎麼運作，譬如說2D碰上3D的，</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">F</span>
<span class="n">array</span><span class="p">([[[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]],</span>

       <span class="p">[[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">]]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">F</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">G</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span> <span class="o">=</span> <span class="n">F</span> <span class="o">+</span> <span class="n">G</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span>
<span class="n">array</span><span class="p">([[[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]],</span>

       <span class="p">[[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">]]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</pre></div>


<p>分解一下</p>
<div class="highlight"><pre><span></span>F  = [[[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]],
      [[12, 13, 14, 15],
       [16, 17, 18, 19],
       [20, 21, 22, 23]]]  # shape = (2,3,4)
G = [[1],
     [2],
     [3]] # shape = (3,1)
G&#39;= [[1,1,1,1],
     [2,2,2,2],
     [3,3,3,3]] # shape = (3,4)
G&quot;= [[[1,1,1,1],
      [2,2,2,2],
      [3,3,3,3]],
     [[1,1,1,1],
      [2,2,2,2],
      [3,3,3,3]]] # shape = (2,3,4)

H = F + G&quot;
   = [[[ 0+1,  1+1,  2+1,  3+1],
       [ 4+2,  5+2,  6+2,  7+2],
       [ 8+3,  9+3, 10+3, 11+3]],
      [[12+1, 13+1, 14+1, 15+1],
       [16+2, 17+2, 18+2, 19+2],
       [20+3, 21+3, 22+3, 23+3]]]
</pre></div>


<p>那這樣的性質可以怎麼運用呢？舉個例子。</p>
<div class="highlight"><pre><span></span>Example:
請問平面上這些點(102.0, 203.0),(132.0, 193.0),(45.0, 155.0),(57.0, 173.0)，哪一點最接近(111.0,188.0)?
</pre></div>


<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">observation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">111.0</span><span class="p">,</span><span class="mf">188.0</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">codes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">102.0</span><span class="p">,</span> <span class="mf">203.0</span><span class="p">],[</span><span class="mf">132.0</span><span class="p">,</span> <span class="mf">193.0</span><span class="p">],[</span><span class="mf">45.0</span><span class="p">,</span> <span class="mf">155.0</span><span class="p">],[</span><span class="mf">57.0</span><span class="p">,</span> <span class="mf">173.0</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">diff</span> <span class="o">=</span> <span class="n">codes</span> <span class="o">-</span> <span class="n">observation</span>  <span class="c1"># broadcasting</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">diff</span>
<span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">9.</span><span class="p">,</span>  <span class="mf">15.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">21.</span><span class="p">,</span>   <span class="mf">5.</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">66.</span><span class="p">,</span> <span class="o">-</span><span class="mf">33.</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">54.</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">diff</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span> <span class="c1"># distance</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dist</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">17.49285568</span><span class="p">,</span>  <span class="mf">21.58703314</span><span class="p">,</span>  <span class="mf">73.79024326</span><span class="p">,</span>  <span class="mf">56.04462508</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">nearest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">nearest</span>
<span class="mi">0</span>   <span class="c1"># ANS is (102.0, 203.0)</span>
</pre></div>


<h5><u>Slice and Fancy Indexing</u></h5>
<p>最後，來看一下我們可以怎麼去切ndarray。在python內建語言中，常見的slice是這個樣子</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>


<p>那如果是維度再加一級呢？則是這個樣子</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">w</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
<span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>


<p>如果是ndarray，我們常常處理維度大於1的陣列，如果用這個方法來slice，就顯得非常麻煩，Numpy提供了一種比較直覺的方式來做slice。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">M</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="mi">3</span>
</pre></div>


<p>在中括號裡頭用逗點隔開來表示在各個axis上要取的位置，還可以填入一個陣列來取出一個範圍。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>   <span class="c1"># &quot;:&quot;代表全取，效果和 M[1,0:2]一樣</span>
<span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span> <span class="c1"># 寫成陣列也可以，效果和 M[1,0:2]一樣</span>
<span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># 還可以做到在axis=0的方向上取範圍，這是list做不到的</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">M</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>


<p>我們也可以引入一個ndarray來做篩選，常見使用的是布林陣列。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span> <span class="n">N</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">N</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span>
<span class="n">array</span><span class="p">([[</span><span class="bp">False</span><span class="p">,</span>  <span class="bp">True</span><span class="p">],</span>
       <span class="p">[</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">N</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
<span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>


<p>b是由一個邏輯運算產生，這個邏輯運算會對矩陣作element-wise operation，所以會得出一個大小相同的布林陣列。而我們可以將b引入N當作篩選器，把符合的給取出來。事實上還可以更強大的去將取出來的值改值。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">N</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">N</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>


<p>上面我將取出來的值加倍，這樣的手法來取值改值會直接影響到原陣列，這是一個很重要的手法。</p>
<h5><u>子彈總結</u></h5>
<ul>
<li>產生ndarray的其他方法：np.arange, np.linspace, np.zeros, np.ones, np.eye, np.random.random 和 np.fromfunction</li>
<li>Broadcasting的前題：所有矩陣的shape由axis＝-1開始對齊去比較彼此間的rank，所有矩陣的在每個axis下的rank必須符合以下兩種規則其中之一：</li>
<li>所有rank為同一個值</li>
<li>只能有一個矩陣rank為非0或1，其餘矩陣的rank都要為0或1</li>
<li>Slicing Method ( Ex: M[1,0:2] )</li>
<li>布林陣列的取值賦值方法</li>
</ul></dd>
              
            	<dt>2017 / 4月 17</dt>
            	<dd><a href="../python-play-with-data_2.html">Python玩數據 (2)：Numpy [1/2]</a></dd>
              <dd style="border:0.5px solid rgb(200,200,200);padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vh;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><p>在上一次我們已經成功了安裝了IPython，這將會是我們這系列教學的主要舞台，而今天我要教大家在這個舞台上利用Numpy來做一些簡單的科學計算。</p>
<h5><u>IPython</u></h5>
<p>像上次一樣，打開IPython，緊接著把numpy和pandas載入，載入numpy之後我們習慣用<code>as</code>將它縮寫為<code>np</code>，pandas則縮寫為<code>pd</code>。</p>
<p><img alt="ipython" src="http://www.ycc.idv.tw/media/PlayDataWithPython/ipython.jpeg"></p>
<p>IPython是一個具有互動式介面的python執行介面，你可以一邊寫一邊理解目前的狀況，舉個例子</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">12</span> <span class="c1"># integer(整數)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span>     <span class="c1"># check variable a</span>
<span class="mi">12</span>
</pre></div>


<p>在第一行中，我令變數a為12，而第二行只要把變數a直接key出來，我們就可以立刻查看變數裡頭有什麼內容，注意喔！在一般的python語言中，直接把變數key出來這件事是沒有意義的，這只有在IPython上才有的方便功能，<strong>有了這樣一個互動式的介面，讓我們在處理數據的時候可以隨時查看，目前數據的狀況</strong>。</p>
<h5><u>Python常見的資料型別</u></h5>
<p>Python常見的資料型別有整數(integer)、浮點數(floating-point number)、字串(string)、串列(list)、序對(tuple)、字典(dictionary)，可以使用<code>type()</code>來查詢資料型別。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># integer</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">40.0</span> <span class="c1"># float, 必須有&#39;.&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="s1">&#39;word&#39;</span> <span class="c1"># string</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span> <span class="c1"># list</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">)</span> <span class="c1"># tuple</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="mi">2</span> <span class="p">}</span> <span class="c1"># dictionary</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="nb">str</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="nb">list</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="nb">dict</span>
</pre></div>


<p>list和tuple裡面可以塞入任意的資料型別，甚至可以塞入另外一個list，或是自己定義的物件，list和tuple其實非常的相似，差異只在於tuple一旦決定了就不能在變更，但是list卻可以。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;new&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># 取出第一項(index=0)加一再設定回去第一項</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># 刪除index=1的那項</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;new&#39;</span><span class="p">)</span>   <span class="c1"># fail</span>
<span class="ne">AttributeError</span><span class="p">:</span> <span class="s1">&#39;tuple&#39;</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">&#39;append&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>   <span class="c1"># fail</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="s1">&#39;tuple&#39;</span> <span class="nb">object</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">support</span> <span class="n">item</span> <span class="n">assignment</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># fail</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="s1">&#39;tuple&#39;</span> <span class="nb">object</span> <span class="n">doesn</span><span class="s1">&#39;t support item deletion</span>
</pre></div>


<p>在python中，整數和浮點數可以作簡單的四則運算</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">/</span> <span class="mi">2</span>
<span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="mf">6.0</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="mf">2.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">3</span> <span class="o">**</span> <span class="mi">2</span>  <span class="c1"># 指數</span>
<span class="mi">9</span>
</pre></div>


<p>一群整數做完運算輸出是整數，一群浮點數做完運算輸出是浮點數，那假如整數和浮點數混雜的情形呢？</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span>
<span class="mi">0</span>  <span class="c1"># 整數除整數，結果必定是整是，是整數0，而不是想像中的0.5，這種運算效果有點像求商</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">2.</span>
<span class="mf">0.5</span> <span class="c1"># 只要有任意浮點數出現，整數強迫轉為浮點數，然後再做運算，這才是我們要的結果</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">3</span> <span class="o">**</span> <span class="mf">2.</span>
<span class="mf">9.0</span>
</pre></div>


<p>所以在運算之前，你要想清楚你想要的目標是什麼？如果你有一個整數變數<code>someInt</code>接下來要作浮點數運算，可以使用<code>float(someInt)</code>強制先轉成浮點數再做接下來的運算，這樣比較不會犯錯。</p>
<p>事實上，轉成浮點數這樣的自動轉換在python中是很少見的，python是屬於<strong>強型別語言，所以型別和型別之間有很強的區份性，常常不會自動轉換</strong>，如果需要轉換必須要作額外的操作。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="s1">&#39;2&#39;</span> <span class="c1"># fail</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="n">unsupported</span> <span class="n">operand</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="o">+</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="ow">and</span> <span class="s1">&#39;str&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span> <span class="c1"># 使用int()將字串轉成整數</span>
<span class="mi">3</span>
</pre></div>


<p>常見的型別轉換函數有<code>int()</code>, <code>float()</code>, <code>str()</code>, <code>list()</code>, <code>tuple()</code>。所以如果要對一個tuple做更改，可以先轉成list再做運算。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># 在index為0的地方插入整數4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h</span>
<span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>


<h5><u>Numpy的數學運算</u></h5>
<p>在上一段我簡單介紹了python內建的運算，在大多數情況，內建的運算就已經足夠應付了，不過如果遇到複雜的運算，例如：三角函數、取最大最小值、exp、log、開根號、矩陣運算，我們就需要用到 Numpy    。</p>
<p>首先先介紹Numpy的一些數學運算，Numpy的數學運算詳細<a href="https://docs.scipy.org/doc/numpy/reference/routines.math.html">參考這</a>。</p>
<p>我這邊舉幾個比較常見的例子。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># 加總</span>
<span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># 最大值</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># 最小值</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># 求餘數</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span> <span class="c1"># 求sin</span>
<span class="mf">1.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="c1"># ln 和 e</span>
<span class="mf">1.0</span>
</pre></div>


<h5><u>Numpy基礎元素：ndarray</u></h5>
<p>Numpy最重要的元素就是ndarray，它是N-Dimensional Array的縮寫，在Numpy裡，dimesions被稱為axes，而axes的數量被稱為rank，axes是一個重要的概念，了解這個概念基本上就把Numpy搞懂一半以上了。</p>
<p>先來建立一個簡單1D的ndarray</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>


<p>從外到內第一個遇到的中括號就是axis=0，往內就遞增上去，所以從1到2再到3，這個方向就叫做axis=0，Numpy大部分的運算都支援陣列的運算，經常你需要限制要在哪個axis方向上作運算，舉個例子</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>  <span class="c1"># axis為None的時候則加總所有元素</span>
<span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># fail 因為A只有一維</span>
<span class="ne">ValueError</span><span class="p">:</span> <span class="s1">&#39;axis&#39;</span> <span class="n">entry</span> <span class="ow">is</span> <span class="n">out</span> <span class="n">of</span> <span class="n">bounds</span>
</pre></div>


<p>另外，也可以由內往外數，最內部的第一個中括後就是axis=-1，越外面就越負。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="mi">6</span>
</pre></div>


<p>剛來上面的例子可能看不出效果，再來就稍微有趣一點，我們來看看2D的ndarray</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">B</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>   <span class="c1"># [1+4, 2+5, 3+6]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>    <span class="c1"># [1+2+3, 4+5+6]</span>
</pre></div>


<p>有看懂axis怎麼運作嗎？最外面的中括號是axis=0，它包含[1,2,3]和[4,5,6]兩個元素，方向就是從[1,2,3]到[4,5,6]的方向，在這個方向上做sum，所以結果就會得到[1+4, 2+5, 3+6]。若是axis=1則是第二層中括號，也就是1到3和4到5的方向，所以結果會是[1+2+3, 4+5+6]。</p>
<p>一樣從內而外也可以，如果axis=None或defalut情形下，則是對矩陣內所有元素作運算。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="mi">21</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="c1"># same as above</span>
<span class="mi">21</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 和axis=1等價</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
</pre></div>


<p>相信大家已經有感覺了，那3D也是一樣道理的。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],[[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">]]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">C</span>
<span class="n">array</span><span class="p">([[[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">]],</span>

       <span class="p">[[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>    <span class="c1"># [1+7,  2+8,  3+9 ]</span>
       <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">]])</span>   <span class="c1"># [4+10, 5+11, 6+12]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mi">5</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">9</span><span class="p">],</span>    <span class="c1"># [1+4, 2+5, 3+6]</span>
       <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">21</span><span class="p">]])</span>   <span class="c1"># [7+10, 8+11, 9+12]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>        <span class="c1"># [1+2+3, 4+5+6]</span>
       <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">33</span><span class="p">]])</span>       <span class="c1"># [7+8+9, 10+11+12]</span>
</pre></div>


<p>畫張圖可能比較好理解一點，在各個方向上加總的結果都不一樣。</p>
<p><img alt="ndarray axis" src="http://www.ycc.idv.tw/media/PlayDataWithPython/ndarray_axis.png"></p>
<p>同樣，axis的概念也可以用在矩陣的shape</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">D</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">D</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>


<p><code>(3, 2)</code>這樣的shape我們就一點都不意外了，axis=0有三個元素，而axis=1有兩個元素。shape可以直接改，如果數量恰當的話就會自動重組。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">D</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">D</span>
<span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span>

       <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]])</span>
</pre></div>


<p>axis=0有兩個元素，axis=1有一個元素，axis=2有三個元素。</p>
<p>同樣的概念也可以用在取出單一元素上。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="mi">5</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="mi">3</span>
</pre></div>


<p>在axis=0上選第二個元素(1)，在axis=1上選第一個元素(0)，在axis=2上選第二個元素(1)，所以選出來的元素就是5啦！</p>
<p>有了axis的概念，我們來看另外一個重要的概念—dtype。</p>
<p>ndarray有其資料型別，這個資料型別就稱為dtype，有哪些內建的資料型別呢？我們可以透過numpy的內建資料來查看。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">sctypes</span>
<span class="p">{</span><span class="s1">&#39;complex&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">complex64</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">complex128</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">complex256</span><span class="p">],</span>
 <span class="s1">&#39;float&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">float16</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float128</span><span class="p">],</span>
 <span class="s1">&#39;int&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int64</span><span class="p">],</span>
 <span class="s1">&#39;others&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">void</span><span class="p">],</span>
 <span class="s1">&#39;uint&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint16</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint32</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint64</span><span class="p">]}</span>
</pre></div>


<p>有複數、浮點數、整數，另外每個資料型別還可以由資料的儲存容量大小來區分，例如：numpy.int32就代表是容量為32bits的整數。我們可以在設置ndarray的時候事先強迫設成某資料型別。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t1</span>
<span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t1</span><span class="o">.</span><span class="n">dtype</span>
<span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t2</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t2</span><span class="o">.</span><span class="n">dtype</span>
<span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>


<h5><u>Numpy的矩陣運算</u></h5>
<p>有了ndarray就可以作矩陣的運算了，矩陣運算有兩種系統，一種是element-wise(元素方面) operation，一種是matrix operation。</p>
<p>這樣講好像很抽象，我來解釋一下，element-wise operation就是每個元素獨立運算，例如，以下例子就是element-wise的相加。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">+</span><span class="n">B</span>      <span class="c1"># element-wise plus</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">6.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">]])</span>
</pre></div>


<p>A和B矩陣中同樣位置的元素相加，再放到新的矩陣中，這一種操作就叫做element-wise operation。</p>
<p>在numpy中如果沒有特別指定，所有的運算都是這類的運算，我們來看一下減、乘和除。</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">-</span><span class="n">B</span>      <span class="c1"># element-wise minus</span>
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">4.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">*</span><span class="n">B</span>      <span class="c1"># element-wise multiply</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">5.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">B</span><span class="o">/</span><span class="n">A</span>      <span class="c1"># element-wise divide</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">5.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
</pre></div>


<p>那我如果想要作矩陣操作(matrix operation)呢？譬如說矩陣內積，</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="c1"># 矩陣內積</span>
<span class="n">array</span><span class="p">([[</span>  <span class="mf">5.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">15.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">]])</span>
</pre></div>


<p>還有更多的矩陣操作，</p>
<p>矩陣轉置</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span> <span class="c1"># 矩陣轉置</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">]])</span>
</pre></div>


<p>反矩陣</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">A_rev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="c1"># 反矩陣</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">A_rev</span>
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">2.</span> <span class="p">,</span>  <span class="mf">1.</span> <span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">A_rev</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span>  <span class="mf">1.00000000e+00</span><span class="p">,</span>   <span class="mf">0.00000000e+00</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">8.88178420e-16</span><span class="p">,</span>   <span class="mf">1.00000000e+00</span><span class="p">]])</span>
</pre></div>


<p>A和A的反矩陣內積為單位矩陣，你有注意到<code>8.88178420e-16</code>這個奇怪的數字嗎？這是因為python在計算的過程有一些誤差的緣故，所以才會產生一個這麼小的數字，但基本上可以看作是0。</p>
<p>另外矩陣跟矩陣間也可以合併。</p>
<p>垂直方向合併</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">V</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">5.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
</pre></div>


<p>水平方向合併</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">5.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])</span>
</pre></div>


<p>當然也可以分割矩陣，</p>
<p>垂直方向分割</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">vsplit</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># 2代表切兩份</span>
<span class="p">[</span><span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">]]),</span> <span class="n">array</span><span class="p">([[</span> <span class="mf">5.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">]])]</span>
</pre></div>


<p>水平方向分割</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">hsplit</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># 4代表切四份</span>
<span class="p">[</span><span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">3.</span><span class="p">]]),</span> <span class="n">array</span><span class="p">([[</span> <span class="mf">2.</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">4.</span><span class="p">]]),</span> <span class="n">array</span><span class="p">([[</span> <span class="mf">5.</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.</span><span class="p">]]),</span> <span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">],</span>
        <span class="p">[</span> <span class="mf">0.</span><span class="p">]])]</span>
</pre></div>


<h5><u>子彈總結</u></h5>
<ul>
<li>Python常見的資料型別：整數(integer)、浮點數(floating-point number)、字串(string)、串列(list)、序對(tuple)、字典(dictionary)</li>
<li>ndarray的axes概念很重要，這會決定函數操作的方式，例如：np.sum</li>
<li>ndarray的資料型別(dtype)，例如：'float64', 'int64', 'string', ...</li>
<li>numpy的矩陣運算有element-wise operation和matrix operation兩種</li>
</ul>
<p>Numpy的基礎概念我們已經有了，在下一篇當中會再更深入的了解Numpy還有什麼進階的功能，包括：產生ndarray的多種方法、broadcast的概念以及ndarray的進階操作手法。</p></dd>
              
            	<dt>2017 / 3月 30</dt>
            	<dd><a href="../algorithm-complexity-theory.html">輕鬆談演算法的複雜度分界：什麼是P, NP, NP-Complete, NP-Hard問題</a></dd>
              <dd style="border:0.5px solid rgb(200,200,200);padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vh;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><p>在寫程式的時候，會聽到有人說這些問題是NP-Complete問題，或說這些是P問題，那這到底是什麼東西？其實這就是一套定義演算法複雜度的方法，今天我就想帶大家來聊聊這個艱澀但有趣的話題。</p>
<h5><u>Turing Machine</u></h5>
<p>我們先從 <a href="https://en.wikipedia.org/wiki/Turing_machine">Turing machine</a>（圖靈機）開始講起，Turing machine是現代電腦的基本雛型，是英國數學家圖靈（Alan Turing）於1936年提出的一種抽象計算模型，這個計算模型在猜想上可以「計算所有在演算法中可計算的問題」，也就是可以解決人類所有可解的問題，這個猜想稱之為 <a href="https://en.wikipedia.org/wiki/Church–Turing_thesis">Church–Turing thesis</a>（thesis代表假設或猜想），僅管目前還無法證明這個猜想，但是目前為止它幾乎完全被接受。</p>
<p>簡單的談一下 Turing machine的基本架構，首先我們需要一個磁帶，這一條磁帶上面可以一格一格的填入一些 symbols，這可以是單純的 0/1 symbols 或者更多種類的 symbols，但這些 symbols 的數量必須是有限的，而這個symbols就可以當作我的輸入，接下來我需要一個讀寫頭，這個讀寫頭會在磁帶上讀取或寫入 symbol，或左右移動，另外這個讀寫頭存有一個 state，這個 state 會隨著狀況改變，然後我就利用 symbol 和 state 來建立一個規則表，舉個例子，譬如說：初始的 state 是 q0，如果讀寫頭在 q0 的情況下讀到 symbol 0，就寫入 symbol 1，並且向右移動3格，並且改變 state q0 為 q1，... 等等，藉由規則來完成我們想做的運算，最後最重要的是它必須有一個 halt state 讓機器知道已經計算完畢了。Turing machine 不僅僅在理論上可以做任何的計算，而更有價值的是 Turing machine 的架構是有辦法用物理的方式來製造的，所以才會有現代電腦這玩意兒。</p>
<p>說到電腦，更嚴謹地說，我們當今的電腦架構是比較接近 <a href="https://en.wikipedia.org/wiki/Turing_machine">deterministic Turing machine</a> (DTM)，和它對比的是 <a href="https://en.wikipedia.org/wiki/Non-deterministic_Turing_machine">non-deterministic Turing machine</a> (NTM)，我來好好的解釋一下，deterministic 的中文稱為決定性，所以 non-deterministic 就是非決定性，如果給予 Turing machine 某個 state 和某個 symbol 下它的下一步如果只有一種可能，那我們就稱它為 deterministic Turing machine (DTM)，所以上述的讀取頭每次就依照當下特定的 symbol 和 state 然後「決定」下一步應該要怎麼動作。</p>
<p>但是 non-deterministic Turing machine (NTM) 就不拘於此，針對某個 state 和某個 symbol 它的下一步可能會有很多種，它會是一個分支，它可能同時要向右移3格，又同時要向左移動2格，所以你可以想像一下你的讀寫頭一分為二，然後再各自進行自己的任務，這個分支可以有無限多個，只要最後有某個分支到達 halt state，我們就解完問題了，這就是 non-deterministic Turing machine (NTM)。</p>
<p>顯而易見的，DTM 只是 NTM 的特例，所以 NTM 比 DTM 擁有更快的計算速度，但這裡不要誤會喔！不管是 DTM 和 NTM 能解的問題是一樣多的，而且在數學上可以將 NTM 轉換成 DTM，只是它們解決相同問題所用到的時間複雜度不一樣，不過這就很關鍵。</p>
<h5><u>時間複雜度</u></h5>
<p>接下來，我要開始切入正題，我們來聊聊時間複雜度吧！什麼是時間複雜度呢？時間複雜度用來評估演算法需要花多少時間做計算，我們常用<a href="https://zh.wikipedia.org/wiki/大O符号">大O符號</a>來描述，代表的是一個漸進的函數數量級上界，舉個例子，假設我想要在一個有序的數列2,3,5,7,13,27中找到7的位置，最簡單的做法就是從第一個元素開始檢查起，如果不是元素7就再找下一個，直到找到為止，所以最差的情形就是我一路找直到了最後一個元素，如果數列有Ｎ個元素，我們最差的情形就是做了Ｎ次的比較，而每次做比較所花的時間是一個常數時間，因此這個演算法的上界將被 a×N 所界定，a為常數，所以這個演算法的時間複雜度為O(N)，再舉個稍微難一點的例子：<a href="https://en.wikipedia.org/wiki/Subset_sum_problem">子集合加總問題</a>，假設給予一組集合{−7, −3, −2, 5, 8}，然後問是否有一組子集合相加為0，怎麼做呢？最簡單的做法就是，窮舉出所有可能的子集合然後相加驗證是否剛好為0，假設集合中有Ｎ個元素，我會有2^N種的子集合，而且要加總最多Ｎ個元素，所以這個過程的時間複雜度為 O(N×(2^N))。特別提醒，以上的分析方式大致上是符合DTM和現代電腦的運作方式，一步接著一步做（step-by-step），NTM就不這麼分析問題，當然兩者看待同一個問題的時間複雜度就會不一樣。</p>
<p>剛剛有提到 Turing machine 可以解所有演算法問題，那如果我製造一台機器符合 Turing machine或者是我購買一台電腦，是不是就可以躺著解所有的問題了，很可惜的，並不是的！我們剛剛有簡單的帶大家了解時間複雜度，我們知道每種演算法有其計算時間，子集合加總問題的時間複雜度為O(N×(2^N))，如果今天很單純的，我的元素只有1000個，這個數量不過分吧！但大家試著計算一下1000 ×(2^1000)就會發現這是一個天文數字，它大到縱使每個相加只需要0.00001秒，也需要遠遠超過地球年齡的時間才有辦法算完，因此這類問題就算是可解的，也並不實際，所以只有在一個數量級時間以下的問題我們才好應付，這個數量級被稱為 polynomial time（多項式時間），用大Ｏ表示為Ｏ(N^k)，剛剛上面提到的數列找元素問題，它得時間複雜度為O(N)，為 <a href="https://zh.wikipedia.org/wiki/多項式時間">polynomial time</a>，這是屬於好對付的問題，如果超過 polynomial time 的問題我們稱為 <a href="https://en.wikipedia.org/wiki/Intractability_(complexity)">intractable</a> problem (難解的問題)。</p>
<h5><u>P＝NP？</u></h5>
<p>如果有一群演算法用DTM來做計算所需時間是 polynomial time，那這類演算法或問題被稱為Ｐ問題，Ｐ就是 polynomial-time 的縮寫，另外如果有一群演算法用NTM來做計算所需時間是 polynomial time，那這類問題被稱為NP問題，NP是 non-deterministic polynomial-time 的縮寫，NP問題還有另一個數學上等價的判斷方法，從驗證解的難度來界定，如果用DTM來驗證一組解是否正確只需要 polynomial time，那這個問題就是一個NP問題，剛剛子集合加總問題，我們要驗證解是否正確很簡單也很快速，我們只要把解的數字加總起來看是不是為0就可以了，所以子集合加總問題是一個NP問題，但因為這個問題的時間複雜度為 O(N×(2^N))，所以它不是一個Ｐ問題，當然也許有一天可以找到一種演算法來解這個問題，並且只需要 polynomial time，那這個問題就是既是NP問題也是P問題，那麼這種演算法找得到嗎？這就牽扯出一樁數學懸案。</p>
<p>在討論這個問題之前，我先補充一件事，剛剛我提到NP問題有兩種定義是等價的，一種是NTM可在 polynomial time 內解決的問題，另一種是問題的解有辦法在DTM polynomial time下被驗證，這兩種定義如何連結起來呢？我來粗略地說明一下，因為NTM有無窮多個分支讓我利用，那我就讓每個分支去窮舉每種可能的解，然後再驗證每個分支的解是否正確，而驗證的過程只需要 polynomial time，所以自然在NTM下我只需要 polynomial time 就可以將這個問題給解完，也因此它們是等價的。那也許大家還有一個疑問，有什麼問題是無法在 polynomial time 內驗證解的？我們稍稍的改一下子集合加總問題，改問「這集合之中最多有多少種子集合符合加總為0 ?」這時候如果我告訴你解是3個，你要怎麼驗證這個答案是對的，你會發現你幾乎還是需要再重新解同樣的問題才有辦法驗證，這種問題被稱為Co-NP問題（<a href="https://zh.wikipedia.org/wiki/反NP">反NP問題</a>）。</p>
<p>毋庸置疑的，NP問題必定包含P問題，在DTM之下為 polynomial time 可解決的，在NTM之下也必定是 polynomial time 可解決的，但是P問題會等價於NP問題嗎？（<a href="https://en.wikipedia.org/wiki/P_versus_NP_problem">P=NP?</a>）這個問題到目前為止還是數學界無法證明的問題，目前既不能證明P=NP也不能證明P≠NP，克雷數學研究所曾在2000年公布千禧年大獎七大難題，每解破一題的解答者，會頒發獎金100萬美元，裡面的其中一題就是P=NP?問題，那為什麼這個問題很重要呢？ 舉個例子，有一種我們現今常用的加密方法叫做RSA加密，它的概念非常的簡單，我們知道由兩個質數相乘的合數，只有用這兩個質數的其中一個才有辦法整除它，今天我拿一個由兩個大質數相乘的合數當作鑰匙孔，所以手上有鑰匙（其中一個質數）的人就可以開啟這個鎖（整除它），如果你想要暴力破解這個鎖是很困難的，你需要超過 polynomial time 的時間，但是你要驗證解是否正確是很容易的，根據上面的定義<a href="https://zh.wikipedia.org/wiki/RSA加密演算法">RSA加密</a>是一個NP問題，如果今天有人找到方式可以把NP問題當作P問題處理，也就是說他可以輕易地用現代的電腦去解開RSA加密，還有破解其他的加密方法，目前的加密方法幾乎都是NP問題，這一定會造成世界不少的動盪，不過也不僅僅只有壞處啦，只要確立了NP=P，我們可以拿來解很多我們現今無法解的難題，含括各領域：人工智慧、物理、醫學 ...，人類知識科技將大步的躍進。</p>
<h5><u>NP-Complete 問題</u></h5>
<p>當數學家試圖解決 NP=P? 問題時，導出了一個重要的概念— NP-Complete問題。1971年美國 Stephen A. Cook提出了<a href="https://zh.wikipedia.org/wiki/Cook-Levin理論">Cook-Levin理論</a>，這個數學理論指出任何一個NP裡面的問題都可以在 polynomial time 內，使用DTM，將之化約成「一個布林方程式是否存在解」的問題，這個被化約的問題又稱為布爾可滿足性問題（SAT），我們稱SAT問題為NP-Complete問題。</p>
<p>只要滿足以下兩個條件的，我們都稱之為<a href="https://en.wikipedia.org/wiki/NP-completeness">NP-Complete</a>：1. 它本身是一個NP問題  2. 所有的NP問題都可以用DTM在 polynomial time 內化約成為它。</p>
<p>這個概念非常強大，假設我證明了SAT是P問題，就等於今天我隨便拿到一個NP問題就可以在 polynomial time 內把問題轉換成SAT，然後再用 polynomial time 把SAT解掉，所以所有的NP問題都只是P問題了，也就是P=NP，因此NP-Complete問題就是解決 P=NP 的關鍵，如果可以證明NP-Complete問題為P問題，就可以間接證明P=NP。</p>
<p>NP-Complete 問題不只有SAT一種，在Cook提出Cook-Levin理論的隔一年，1972年，Richard Karp將這個想法往前推進了一步，他證明了<a href="https://zh.wikipedia.org/wiki/卡普的二十一個NP-完全問題">21個不同但都難解的組合數學與圖論問題為NP-Complete問題</a>，一樣的其中的任何一種只要被證明為P問題，都可以間接證明P=NP，目前已經有更多問題被證明為NP-Complete 問題。</p>
<p>大家可能還會看到一個名詞叫做<a href="https://en.wikipedia.org/wiki/NP-hardness">NP-Hard</a>，它的定義很好了解，只需要符合NP-Complete的第二個條件：所有的NP問題都可以用DTM在 polynomial time 內化約成為它，就被稱為NP-Hard 問題。所以NP-Complete問題是NP-Hard 問題的一種特例，NP-Hard 問題可以不必是NP問題，譬如停機問題就是一個NP-Hard 問題但不是一個NP問題。</p>
<h5><u>後話</u></h5>
<p>最後，以下面這張圖作個結尾，左圖是假設P≠NP被證明的情形，NP-Hard有兩個部分，一個部分它同時是個NP問題，另外一部分則不是，所謂的NP問題就是可以用NTM在 polynomial time內給解掉的問題，另外其解的驗證必定能用DTM在 polynomial time內完成，兩種定義是等價的，有一部分的NP問題是屬於P問題，這些問題大部分都是易解的，有另外一部分的NP問題為NP-Complete問題，這些問題被視為難解的問題，我們只能用逼進的方法盡量接近答案。</p>
<p>右圖是假設P＝NP被證明的情形，此時NP-Complete問題已經被證明為P問題，利用NP-Complete問題的特性，我們可以化約所有NP問題為NP-Complete問題，在把這個NP-Complete問題用 polynomial time 解掉，所以P=NP=NP-Complete。</p>
<p>事實上，目前科學界普遍相信P≠NP，所以遇到NP-Complete的問題，就直接標註這是一道難題，使用近似解吧！這是一個不怎麼樂觀的看法，難道說我們真的無法把這樣的難題給解決掉了嗎？也未必啦！仔細想想我們也許還有另外一個方法，只要我們創建一個NTM就可以把這些難題給解決掉啦！<a href="https://en.m.wikipedia.org/wiki/BQP">不過連量子電腦都普遍不被認為是一個NTM</a>（最後又回補了一槍）。</p>
<p><img alt="P_np_np-complete_np-hard" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/P_np_np-complete_np-hard.svg/800px-P_np_np-complete_np-hard.svg.png"></p></dd>
              
            	<dt>2017 / 3月 20</dt>
            	<dd><a href="../python-play-with-data_1.html">Python玩數據 (1)：安裝Python, IPython, Numpy, Pandas</a></dd>
              <dd style="border:0.5px solid rgb(200,200,200);padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vh;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><p><strong>相較於R，我比較喜歡在工作上使用python來作數據處理</strong>，主要原因有四個，<strong>第一點，python是一個簡潔的語言</strong>，讓我們可以在不寫註解的情況下還可以很容易的看出每一行code在做哪些事，這可以省去了不少時間在；<strong>第二點，python可以更容易的寫成物件導向編程</strong>，物件導向編程可以讓code看起來更為直覺，而且更易於修改、重構或套用，如果是大型軟體開發的話，需要多人協作，此時物件導向便是絕對必要的；<strong>第三點，python是一個通用語言</strong>，不僅僅只可以作資料處理而已，你可以用python寫一套視窗程式，或者當作網站的後台（這個網站就是建基在python上），如果要做一些平行運算也很容易，<strong>最後一點，也是相當重要的一點，目前常見的deep learning套件TensorFlow或Keras都是架構在python上面</strong>，所以如果你的數據處理結束要作deep learning的話，直接用python處理是相當理想的。講了python這麼多優點，其實它是有一項缺點是不如R的，R是一個專為資料科學設計的語言，所以背後有強大的社群，也就是說能直接取得資料分析方法的套件會比python來的多，不過這方面在這幾年已經漸漸的改善了。</p>
<p>講了這麼多python的強大，不過在這個系列我並不會著墨太多在python上，這個部分我會在其他的文章中分享，這系列文章主要聚焦在python的資料處理這部份，我會從基礎講起，讓不懂python的人也可以聽懂。  </p>
<p><br></p>
<h5><u>最困難的第一步：安裝</u></h5>
<p>不要以為我在開玩笑，安裝往往是最困難的一步，有些時候安裝一些套件的時候，你必須要先行安裝另外幾個相依套件，如果程式在安裝的過程無法自己補足這些相依套件的話，你就得自己安裝，一般來說如果是python的套件的話，你可以先用待會要介紹的<code>pip install</code>來安裝，如果不幸在上面找不到的話，就只好上網Google了，另外有些時候安裝還會遇到bug，這個時候Google也同樣是你的好朋友，或者到<a href="https://stackoverflow.com">Stack Overflow</a> 上找答案（一個好的coder要培養自己上網找答案的能力），不過大家先不用擔心，以下我會帶大家一步一步的安裝。</p>
<p>我們將會用到python 2.7版（你也可以選擇更新的版本，不會差距太大），以及他的套件IPython, Numpy和Pandas。</p>
<p><br></p>
<h5><u>Python2.7</u></h5>
<h5><u>Mac</u></h5>
<p>python2.7已經是內建的程式了！打開「終端機」，直接輸入</p>
<div class="highlight"><pre><span></span>$ python2.7 -V

Python <span class="m">2</span>.7.13
</pre></div>


<p>就會顯示他的版本。</p>
<p>如果沒有的話，或者你想要自己安裝一份的話，可以參考<a href="https://stringpiggy.hpd.io/mac-osx-python3-dual-install/">這篇</a>的說明，或者跟著我往下作。</p>
<p><strong>Step 1:</strong> 安裝 Xcode：打開你的App Store，搜尋Xcode並安裝。</p>
<p><strong>Step 2:</strong> 安裝 <a href="https://brew.sh">Homebrew</a> 這個Mac上好用的套件管理，打開「終端機」，輸入</p>
<div class="highlight"><pre><span></span>$ /usr/bin/ruby -e <span class="s2">&quot;</span><span class="k">$(</span>curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install<span class="k">)</span><span class="s2">&quot;</span>

<span class="o">==</span>&gt; This script will install:
/usr/local/bin/brew
/usr/local/share/doc/homebrew
/usr/local/share/man/man1/brew.1
/usr/local/share/zsh/site-functions/_brew
/usr/local/etc/bash_completion.d/brew
/usr/local/Homebrew

Press RETURN to <span class="k">continue</span> or any other key to abort
</pre></div>


<p>(附註：我用 <code>＄</code> 代表終端機的輸入起始字元，後面才是你需要輸入的指令)</p>
<p>按下Enter就會開始安裝了。</p>
<p>安裝完畢你就可以直接在「終端機」上使用它，我們試著搜尋python</p>
<div class="highlight"><pre><span></span>$ brew search python

app-engine-python               boost-python@1.59               micropython                    
python-markdown                 wxpython
boost-python                    gst-python                      python ✔                       
python3 ✔                       zpython
homebrew/apache/mod_python            
Caskroom/cask/kk7ds-python-runtime          
Caskroom/cask/mysql-connector-python
</pre></div>


<p>因為我的電腦已經安裝了python2.7和python3.0，所以你會看到他們已經是打勾的狀態，我們的目標就是安裝「python」。</p>
<p><br></p>
<p><strong>Step 3:</strong> 安裝python2.7：</p>
<div class="highlight"><pre><span></span>$ brew install python
</pre></div>


<p>安裝完畢後檔案會被放在底下這個路徑，你可以打開來看一下</p>
<div class="highlight"><pre><span></span>$ open /usr/local/Cellar
</pre></div>


<p>應該就會看到python的資料夾了。</p>
<p><br></p>
<p><strong>Step 4:</strong> 設定路徑 $PATH（不跟系統 Python 打架）</p>
<p>這是什麼呢？當你輸入<code>brew</code> , <code>open</code> , <code>python2.7</code> 這些指令到「終端機」上，為什麼「終端機」會認的了這些指令，原因就出在於這個PATH上，又稱為「環境變數」，我們把它叫出來看看</p>
<div class="highlight"><pre><span></span>$ <span class="nb">echo</span> <span class="nv">$PATH</span>
/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin
</pre></div>


<p>你可以看到有五個路徑分別被字元 <code>:</code> 隔開，由前到後分別為<code>/user/local/bin</code>、<code>/usr/bin</code>、<code>/bin</code>、<code>/usr/sbin</code>、<code>/sbin</code>，這一些都是裝有執行檔的資料夾，今天你如果輸入某個指令，他就會從第一個資料夾下面開始找起，也就是<code>/user/local/bin</code>，沒有找到再依序往下找，直到找不到為止，如果今天<code>/usr/bin</code>底下有python，而你剛剛用brew安裝的另一個python放在<code>/user/local/bin</code> 底下，在這個例子中，你會執行到的就是第一個路徑<code>/user/local/bin</code> 下的python，那這也是我們要的結果，我們想要執行我們自己安裝的，而不是系統原有的。</p>
<p>如果<code>/user/local/bin</code>不是在第一個的話，就必須去修改PATH的順序。</p>
<div class="highlight"><pre><span></span>$ sudo emacs /etc/paths
</pre></div>


<p>輸入密碼後，就會進入修改模式，然後開始修改順序，利用以下指令把<code>/user/local/bin</code> 放到最上面</p>
<p>control + k：把一行字剪下來</p>
<p>control + y：把字貼上</p>
<p>control + x + s：存檔</p>
<p>control + x + c：關掉 emacs</p>
<p>修改完成重開「終端機」，讓環境變數重載，在輸入一次 <code>echo $PATH</code> 應該就可以看到修改後正確的環境變數了。</p>
<p><br></p>
<p><strong>Step 5:</strong> 那就安裝完畢啦！最後檢查一下你下<code>python2.7</code>的時候是不是來自於<code>/user/local/bin</code></p>
<div class="highlight"><pre><span></span>$ which python2.7
/usr/local/bin/python2.7
</pre></div>


<p>看起來很正常，Great!</p>
<p><br></p>
<h5><u>Ubuntu</u></h5>
<p>請參考<a href="https://tecadmin.net/install-python-2-7-on-ubuntu-and-linuxmint/">這篇</a> 。</p>
<p><strong>Step 1:</strong> 先安裝一些相依套件</p>
<div class="highlight"><pre><span></span>$ sudo apt-get install build-essential checkinstall
$ sudo apt-get install libreadline-gplv2-dev libncursesw5-dev libssl-dev libsqlite3-dev tk-dev libgdbm-dev libc6-dev libbz2-dev
</pre></div>


<p><strong>Step 2:</strong> 從網路上下載python2.7 source code</p>
<div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /usr/src
$ wget https://www.python.org/ftp/python/2.7.13/Python-2.7.13.tgz
</pre></div>


<p><strong>Step 3:</strong> 解壓縮並進去資料夾</p>
<div class="highlight"><pre><span></span>$ tar xzf Python-2.7.13.tgz
$ <span class="nb">cd</span> Python-2.7.13
</pre></div>


<p><strong>Step 4:</strong> 依環境配置並安裝</p>
<div class="highlight"><pre><span></span>$ sudo ./configure
$ sudo make altinstall
</pre></div>


<p><code>make altinstall</code> 是為了避免你去取代掉預設的python在/usr/bin/python。</p>
<p><br></p>
<h5><u>Windows</u></h5>
<p><strong>Step 1:</strong> 在這個<a href="https://www.python.org/downloads/release/python-2713/">網站</a>依照你的CPU架構下載安裝檔，並安裝。</p>
<p><img alt="python_win_install_01" src="https://dl.dropboxusercontent.com/s/awu45hdpv0d2j64/python_win_install_01.jpeg"></p>
<p><strong>Step 2:</strong> 設定環境變數</p>
<p>打開 控制台 &gt; 系統及安全性 &gt; 系統 &gt; 進階系統設定 &gt; 環境變數</p>
<p>選Path，並按下 編輯，將<code>C:\Python27;C:\Python27＼Scripts</code> 加到後面，並儲存。環境變數的說明請參考上面Mac安裝的第四步，原理是一樣的，不過在windows裡的區分的符號是<code>;</code>不是<code>:</code>。</p>
<p><br></p>
<h5><u>IPython, Numpy, Pandas</u></h5>
<h5><u>Mac ＆Ubuntu</u></h5>
<p><strong>Step 1:</strong> 安裝pip</p>
<div class="highlight"><pre><span></span>$ curl <span class="s2">&quot;https://bootstrap.pypa.io/get-pip.py&quot;</span> -o <span class="s2">&quot;get-pip.py&quot;</span>
$ python2.7 get-pip.py
</pre></div>


<p><strong>Step 2:</strong> 安裝套件</p>
<div class="highlight"><pre><span></span>$ pip2.7 install ipython
$ pip2.7 install numpy
$ pip2.7 install pandas
</pre></div>


<p><br></p>
<h5><u>Windows</u></h5>
<p>雖然不建議在windows下開發程式，不過我還是提供一個方法，讓你在接下的文章可以正常作操作。有一個好用的軟體—Anaconda，這個軟體不只可以在windows上使用，在linux和mac都有辦法使用。</p>
<ol>
<li>安裝windows版的Anaconda(python 2.7)：<a href="https://www.continuum.io/downloads#windows">網址</a></li>
<li>安裝結束，就已經安裝好「IPython」的程式，直接打開就可以使用。</li>
<li>安裝Numpy和Pandas：打開「Anaconda Prompt 」，輸入</li>
</ol>
<div class="highlight"><pre><span></span>$ conda install numpy
$ conda install pandas
</pre></div>


<p><br></p>
<h5><u>開啟IPython</u></h5>
<p>IPython將會是未來我們這系列會用的一個介面，只要能夠開啟它，我們今天就大功告成了。</p>
<ul>
<li>
<p>Mac ＆Ubuntu:  在終端機輸入 <code>$ ipython2</code></p>
</li>
<li>
<p>Windows：直接打開「IPython」程式</p>
</li>
</ul>
<p>試著import numpy和pandas進來，如果都正常，就代表成功了！</p>
<p><img alt="ipython" src="http://www.ycc.idv.tw/media/PlayDataWithPython/ipython.jpeg"></p>
<p>Ctrl + D 就可以結束跳出啦～ 今天就到這～</p></dd>
              
            </dl>
        </div>
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="../archives.html">Archives</a></li>
                            <li><a href="../tags.html">Tags</a></li>
                            <li><a href="YCNote/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Contact Me</div>
                        <ul class="list-unstyled">
                            <li><a href="./about-me.html" target="_blank">About Me</a></li>
                            <li><a href="https://github.com/GitYCC" target="_blank">Github</a></li>
                            <li><a href="mailto:ycc.tw.email@gmail.com" target="_blank">Email</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; YC Note 2018</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>