<!DOCTYPE html>
<html lang="zh">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="YC Note, 本網站內容包括機器學習(Machine Learning)、深度學習(Deep Learning)、類神經網路(Neural Network)、資料科學(Date Science)、Python、演算法(Algorithm)。">
        <meta name="keywords" content="">
        <link rel="icon" href="./static/img/favicon.png">

        <title>Homepage - YC Note</title>

        <!-- Stylesheets -->
        <link href="./theme/css/all.min.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="YCNote/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="YC Note Full Atom Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->



    </head>

    <body>

        <!-- Header -->
    <div class="header-container" style="background: linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)), url('./images/welcome_front_board.jpg'); background-position: center; background-size: cover;">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <div class="header-logo">
                        <a class="pull-left" href="./"><img class="logo" src="./static/img/favicon.png" alt="logo">YC Note</a>
                    </div>
                    <div class="nav pull-right">
                                <a href="./category/coding.html">Coding</a>
                                <a href="./category/aiml.html">AI.ML</a>
                                <a href="./category/reading.html">Reading</a>
                                <a href="./category/recording.html">Recording</a>
                                <a href="./about-me.html">About Me</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <div class="container header-wrapper">
        <div class="row">
              <div class="col-lg-12">
                  <div class="header-content">
                      <h1 class="header-title">YC NOTE</h1>
                      <div class="header-underline"></div>
                      <p class="header-subtitle header-subtitle-homepage">想像力比知識更重要</p>
                  </div>
              </div>
        </div>
    </div>
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
    
    <div class="archive-container">
        <div class="container content archive">
            <h2><a href="./index.html">Last Posts </a></h2>
            <dl class="dl-horizontal">
                <dt>2018 / 4月 14</dt>
                <dd><a href="./introduction-object-oriented-programming_3.html">物件導向武功秘笈（3）：內功篇 — 物件導向指導原則SOLID</a></dd>
                <dd style="border-style:solid;border-width:0.5px;padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vw;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><h5>物件導向怎麼用才能成就好的程式碼？</h5>
<p>一個好的工具，也要配合對於工具的理解，才能發揮效用。<a href="http://www.ycc.idv.tw/YCNote/post/48">在上一回中</a>，我們完整介紹了Java和Python的物件導向實現方式，我們講到了「封裝」、「繼承」、「多型」等等物件導向的特色，也講了「抽象類別」、「接口」等抽象化的方法，不過我並沒有告訴大家該怎麼用這些工具？使用這些工具是不是有什麼樣的法則？</p>
<p>在接下來的這一篇，我將會介紹物件導向的使用方式，我會提到物件導向著名的六大法則：</p>
<ol>
<li>單一職責原理</li>
<li>開閉原理</li>
<li>里氏替換原則</li>
<li>迪米特法則</li>
<li>依賴倒置原則</li>
<li>接口分隔原則</li>
</ol>
<p>在這之前我們先來介紹描述類別關係的UML類別圖。</p>
<h5>UML類別圖</h5>
<p>開始介紹各種原則之前，先來介紹UML類別圖，UML全名稱為Unified Modeling Language，是一種使用圖形來描繪軟體工程架構的方法，這邊準備介紹的是它的類別圖，這個工具有助於我們快速的了解物件與物件之間的關係。</p>
<ul>
<li>類別(Class): -代表<code>private</code>，+代表<code>public</code>，#代表<code>protected</code></li>
</ul>
<p><img alt="Class" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Class.png"></p>
<ul>
<li>抽象類別(Abstract Class)</li>
</ul>
<p><img alt="AbstractClass" src="https://www.ycc.idv.tw/media/SOLID_Introduction/AbstractClass.png"></p>
<ul>
<li>接口(Interface)</li>
</ul>
<p><img alt="Interface" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Interface.png"></p>
<ul>
<li>繼承關係(Inheritance)和抽象類、接口實現</li>
</ul>
<p><img alt="Inheritance" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Inheritance.png"></p>
<ul>
<li>關聯關係(Association)：A類中使用B類當作「成員變數」，但是A和B並沒有「擁有」的關係，只能說是「有個」的關係，就稱為：A關聯到B，英文為"has-a"的關係。</li>
</ul>
<p><img alt="Associatione" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Association.png"></p>
<ul>
<li>聚合關係(Aggregation)：A類中使用B類當作「成員變數」，而且A和B有一個弱的「擁有」關係，A包含B，但B不是A的一部分，拔掉B，A依然能存在，就稱為：A聚合到B，英文為"owns-a"關係。</li>
</ul>
<p><img alt="Aggregation" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Aggregation.png"></p>
<ul>
<li>合成（組合）關係(Composition)：A類中使用B類當作「成員變數」，而且A和B有一個強的「擁有」關係，B是A的組成的一部分，拔掉B，A就不完整，就稱為：A合成到B，英文為"is-part-of"關係。</li>
</ul>
<p><img alt="Composition" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Composition.png"></p>
<ul>
<li>依賴關係(Dependency)：A類中使用到B類，但僅僅是弱連結，譬如：B類作為A類方法的參數、B類作為A類的局域變數、A類調用B類的靜態方法、B類作為A類方法的回傳值，就稱為：A依賴B，英文為"uses-a"的關係。</li>
</ul>
<p><img alt="Dependency" src="https://www.ycc.idv.tw/media/SOLID_Introduction/Dependency.png"></p>
<h5>單一職責原則(Single Responsibility Principle, SRP)</h5>
<ul>
<li>
<p>定義：There should never be more than one reason for a class to change.（一個類別中不要有多於一個以上的變化理由）</p>
</li>
<li>
<p>簡單的說，就是一個類別中不要做超過一件事，要去切分直到不能再分割為止，如此一來可以提高內聚性。</p>
</li>
<li>
<p>乍看之下，這樣的原則很容易實現，但是魔鬼藏在細節裡，我們常常會沒注意到其實還可以繼續的切分。舉個例子，假設我想設計一個電話的接口，我可能是這樣設計的</p>
</li>
</ul>
<p><img alt="phone_1" src="https://www.ycc.idv.tw/media/SOLID_Introduction/phone_1.png"></p>
<p>乍看之下沒有問題，一個電話擁有撥號、掛號、數據傳送和接收，但是等等！連接的過程和數據的傳輸其實是兩個職責啊！它們之間沒有強烈的關聯性，完全是可以分開處理的，因此這個配置不符合「單一職責原則」，可以繼續切分下去，修改如下。</p>
<p><img alt="phone_2" src="https://www.ycc.idv.tw/media/SOLID_Introduction/phone_2.png"></p>
<ul>
<li>「單一職責原則」原文指的是類別的單一職責，但是務實上，類別如果切分到如此程度，程式碼會變得細碎不堪，這違反了程式碼的「可讀性」，所以我們一般只要求「接口必須保持單一原則」，而類別去套用接口，類別就盡量達成少的職責就好。</li>
</ul>
<h5>開閉原則(Open-Closed Principle, OCP)</h5>
<ul>
<li>
<p>定義：Software entities (classes, modules, functions, etc.) should be open for extension, but closed for modification.（軟體中的實體，例如：類、模組、函數等等，都必須對延伸開放，但對修改封閉）</p>
</li>
<li>
<p>對延伸開放：實體在因應新的改變時，必須是可以靈活擴充的。</p>
</li>
<li>
<p>對修改封閉：實體一旦完成，就盡量不要再去修改它了。</p>
</li>
<li>
<p>綜合以上兩點，我們可以總結出：實體本身的內聚性要高，可以讓我們未來不需要再做修改，單一職責可以做到增強內聚性；實體間的耦合性要低，所以實體像是積木一樣可以因應各種需求去任意組合、擴充。所以「開閉原則」只是進一步的把「低耦合高內聚」再說的更清楚一點，實現「開閉原則」將有利於單元測試、提高維護和擴充能力。</p>
</li>
</ul>
<h5>里氏替換原則(Liskov Subsititution Principle, LSP)</h5>
<ul>
<li>
<p>定義：What is wanted here is something like the following substitution property: If for each object o1 of type S there is an object o2 of type T such that for all programs P defined in terms of T, the behavior of P is unchanged when o1 is substituted for o2 then S is a subtype of T.（簡言之：子類對象能夠替換其父類對象，使用父類方法而不會有問題）</p>
</li>
<li>
<p>「里氏替換原則」用於規範繼承，子類繼承自父類的方法是保有彈性可以覆寫(Overriding)和多載(Overloading)的，但是應該怎麼做，程式碼才不會髒掉？「里氏替換原則」告訴我們一個簡單的法則，就是先寫一段父類的執行代碼，然後把父類替換成子類，然後再跑跑看能不能正常執行，如果正常執行代表這個繼承關係是健康的。</p>
</li>
<li>
<p>為什麼要這樣檢查？之前我們提過繼承主要是為了要避免Repeat Yourself而生，我們找出各種類別共享的屬性和方法，把它獨立出來，然後大家再一起繼承自它，所以我們要盡可能的避免父類出現不是共享的性質。也就是說在理想情況下「父類必須等於子類們的交集」，所以「父類必定是任一子類的子集合」，因此「使用子類來執行父類是不應該有問題的」，這就是「里氏替換原則」。</p>
</li>
<li>
<p>為了遵循「里氏替換原則」，則子類必須完全實現父類的方法。如果子類不能完整地實現父類的方法，或者父類的某些方法在子類中已經發生了「畸變」，則建議斷開父子繼承關係，採用依賴、聚集、組合等關係替代。</p>
</li>
<li>
<p>有了「里氏替換原則」，我們終於可以談談一個上一章沒提到的重要問題：什麼情況可以做繼承？有一些書籍會告訴你，繼承為"is-a"的關係，例如：瑪爾濟斯(B) is-a 狗(A)，所以瑪爾濟斯(B)可以繼承狗(A)，乍看之下沒問題，但這樣的說法存在缺陷，舉個例子，假設今天我先有了類別<code>Retangle</code>，也就是長方形，然後我想要弄一個新的類別<code>Square</code>，也就是正方形，我可以讓<code>Square</code>繼承自<code>Retangle</code>嗎？我們用"is-a"來檢視：正方形是一個長方形？答案是Yes，但是「里氏替換原則」持相反意見，來看一下，</p>
</li>
</ul>
<p><img alt="square_1" src="https://www.ycc.idv.tw/media/SOLID_Introduction/square_1.png"></p>
<p>依照「里氏替換原則」，<code>Square</code>不能繼承自<code>Retangle</code>，因為<code>Square</code>只需要<code>width</code>的成員變數，而<code>Retangle</code>則需要<code>width</code>和<code>height</code>兩個成員變數，當我們將子類<code>Square</code>放到父類<code>Retangle</code>的方法中，因為缺少<code>height</code>變數，必然會出錯，所以違反「里氏替換原則」，因此這兩類不適合作為「繼承」關係。我們可以這樣改善，讓<code>Square</code>應用<code>Retangle</code>來幫忙計算，使用「關聯」關係取代「繼承」關係。</p>
<p><img alt="square_2" src="https://www.ycc.idv.tw/media/SOLID_Introduction/square_2.png"></p>
<ul>
<li>下面這一張集合圖是我自創的，圖中清楚的指出「繼承」中的父類和子類應該是什麼樣的關係。</li>
</ul>
<p><img alt="Inheritance Principle.jpeg" src="https://www.ycc.idv.tw/media/SOLID_Introduction/inheritance_principle.jpeg"></p>
<h5>迪米特法則(Law of Demeter, LoD)</h5>
<ul>
<li>
<p>又稱為「最少知識原則」</p>
</li>
<li>
<p>定義：</p>
<ol>
<li>Each unit should have only limited knowledge about other units: only units "closely" related to the current unit.</li>
<li>Each unit should only talk to its friends; don't talk to strangers.</li>
<li>Only talk to your immediate friends.</li>
</ol>
</li>
<li>
<p>「朋友」的定義：對於類別C的所有方法M而言，在M的方法中僅能訪問以下物件的方法</p>
<ul>
<li><code>self</code>，類別C自身</li>
<li>M的輸入參數</li>
<li>C的成員變數</li>
<li>M的輸出物件</li>
<li>全域變數的物件</li>
</ul>
</li>
<li>
<p>白話總結：</p>
<ol>
<li>僅能訪問那些類別出現在自身、成員變數、方法的輸入和輸出參數中的方法。</li>
<li>減少類別的對外方法，將沒必要對外公布的方法隱藏起來。 </li>
</ol>
</li>
</ul>
<p><strong>（詳解）僅能訪問那些類別出現在自身、成員變數、方法的輸入和輸出參數中的方法。</strong></p>
<p>-- 例子: 假設今天一名老師給了學生名條想叫班長幫忙點名。</p>
<p>錯誤示範：</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Student</span><span class="p">:</span> <span class="c1">#friends: None</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

<span class="k">class</span> <span class="nc">Leader</span><span class="p">:</span> <span class="c1">#friends: Student</span>
    <span class="k">def</span> <span class="nf">countStudents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">student_list</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Total number of students is &quot;</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">student_list</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">Teacher</span><span class="p">:</span> <span class="c1">#friends: Leader</span>
    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name_list</span><span class="p">,</span><span class="n">leader</span><span class="p">):</span>
        <span class="n">student_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">:</span>
            <span class="n">student_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Student</span><span class="p">(</span><span class="n">name</span><span class="p">))</span> <span class="c1">#`Student` is not a friend</span>
        <span class="n">leader</span><span class="o">.</span><span class="n">countStudents</span><span class="p">(</span><span class="n">student_list</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">teacher</span> <span class="o">=</span> <span class="n">Teacher</span><span class="p">()</span>
    <span class="n">leader</span> <span class="o">=</span> <span class="n">Leader</span><span class="p">()</span>
    <span class="n">name_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>
    <span class="n">teacher</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span><span class="n">leader</span><span class="p">)</span>
</pre></div>


<p><img alt="teacher-leader-student_1" src="https://www.ycc.idv.tw/media/SOLID_Introduction/teacher-leader-student_1.png"></p>
<p>以上程式違反「迪米特法則」，因為在類別<code>Teacher</code>的方法<code>command</code>中訪問了不是朋友的<code>Student</code>，這會使得<code>Teacher</code>和<code>Student</code>會產生不必要的耦合，我們可以將創造<code>student_list</code>的權責轉移到<code>Leader</code>上，如此一來就可以斷開<code>Teacher</code>和<code>Student</code>的耦合。</p>
<p>正確示範：</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Student</span><span class="p">:</span> <span class="c1">#friends: None</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

<span class="k">class</span> <span class="nc">Leader</span><span class="p">:</span> <span class="c1">#friends: Student</span>
    <span class="k">def</span> <span class="nf">giveNameList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name_list</span><span class="p">):</span>
        <span class="n">student_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">:</span>
            <span class="n">student_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Student</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">__student_list</span> <span class="o">=</span> <span class="n">student_list</span>

    <span class="k">def</span> <span class="nf">countStudents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Total number of students is &quot;</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__student_list</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">Teacher</span><span class="p">:</span> <span class="c1">#friends: Leader</span>
    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name_list</span><span class="p">,</span><span class="n">leader</span><span class="p">):</span>
        <span class="n">leader</span><span class="o">.</span><span class="n">giveNameList</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span>
        <span class="n">leader</span><span class="o">.</span><span class="n">countStudents</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">teacher</span> <span class="o">=</span> <span class="n">Teacher</span><span class="p">()</span>
    <span class="n">leader</span> <span class="o">=</span> <span class="n">Leader</span><span class="p">()</span>
    <span class="n">name_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>
    <span class="n">teacher</span><span class="o">.</span><span class="n">command</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span><span class="n">leader</span><span class="p">)</span>
</pre></div>


<p><img alt="teacher-leader-student_2" src="https://www.ycc.idv.tw/media/SOLID_Introduction/teacher-leader-student_2.png"></p>
<p>-- Why it works? </p>
<p>先來想想「朋友」有什麼共通之處？其實它們都是類別本身無法斷開耦合的物件，既然無法斷開耦合，何不運用到底，運用這些「朋友」來完成任務，不要再去增加其他的耦合性，也同時幫助提升類別的內聚性，這就是「迪米特法則」真正想做的事。</p>
<p>以這樣的方式去寫程式，也可以避免寫出像是<code>A.getB().getC()</code>的程式碼（A和C不是朋友），這樣冗長的程式碼不僅增加了無益的耦合，也讓程式變得不利於可讀性。</p>
<p><strong>（詳解）減少類別的對外方法，將沒必要對外公布的方法隱藏起來。</strong></p>
<p>-- 例子: 安裝程式。</p>
<p>錯誤範例：</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Wizard</span><span class="p">:</span> <span class="c1"># 3 public methods</span>
    <span class="k">def</span> <span class="nf">first</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Install first step of wizard at mode&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Install second step of wizard at mode &quot;</span><span class="o">+</span><span class="n">mode</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">third</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Install third step of wizard&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Install</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">install</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wizard</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="n">wizard</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
        <span class="n">wizard</span><span class="o">.</span><span class="n">second</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
        <span class="n">wizard</span><span class="o">.</span><span class="n">third</span><span class="p">()</span>
</pre></div>


<p>有太多沒必要對外公布的細節了，依照「迪米特法則」，我們應該將盡量減少對外公布的資訊，把不必要公布的細節私有化。</p>
<p>正確範例：</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Wizard</span><span class="p">:</span> <span class="c1"># only 1 public method</span>
    <span class="k">def</span> <span class="nf">install</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__first</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__second</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__third</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__first</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Install first step of wizard&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__second</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Install second step of wizard at mode &quot;</span><span class="o">+</span><span class="n">mode</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__third</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Install third step of wizard&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Install</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">install</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wizard</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="n">wizard</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
</pre></div>


<h5>依賴倒置原則(Dependence Inversion Principle, DIP)</h5>
<ul>
<li>
<p>定義：High level modules should not depend upon low level modules. Both should depend upon abstractions. Abstractions should not depend upon details. Details should depend upon abstractions.（高層次模組不應該依賴低層次模組，兩者都應該依賴抽象。而抽象不應該依賴細節，反之細節應該要依賴抽象。）</p>
</li>
<li>
<p>範例：假設我們成立一家玩具車公司，開始著手設計我們的第一款車款A，設計的架構圖如下</p>
</li>
</ul>
<p><img alt="toycar_1" src="https://www.ycc.idv.tw/media/SOLID_Introduction/toycar_1.png"></p>
<p><code>ToyCarA</code>是我們的實體車子，可以使用<code>setRPM</code>來設定在幾秒之後到達什麼轉速，而控制他的是電腦模擬的虛擬車<code>VirtualCar</code>，虛擬車提供方法<code>setSpeeed</code>可以設定車速，當然！模擬的車速要和真實車速吻合，還需配合適當的調控實體車的轉速，所以<code>VirtualCarA</code>關聯到<code>ToyCarA</code>去做控制。然後我們公司會提供一個控制器<code>ControllerA</code>來控制車子，控制器上的搖桿分為五級，讓使用者可以控制速度，使用<code>controlBarLevel</code>方法根據級數去控制<code>VirtualCarA</code>的速度。</p>
<p>檢驗一下這個設計圖，它違反「依賴倒置原則」，<code>ControllerA</code>依賴<code>VirtualCarA</code>，<code>VirtualCarA</code>依賴<code>ToyCarA</code>，這些都是實體類別，高層次依賴了低層次。不過，公司的車子A還是賣得很好，沒有什麼大礙。</p>
<p>終於有一天災難降臨了，市場出現了比車子A馬力更強大的玩具車，我們公司如果不趕緊採用新的馬達推出新的車款，就會失去競爭力，我們需要採用新的玩具車<code>ToyCarB</code>，它擁有更好的馬達，我們需要為因應高速度而推出九級分級的搖桿，新的控制器<code>ControllerB</code>，結果回頭一看原本設計圖，完了！所有的A系列的程式碼都耦合在一起了，核心程式<code>VirtualCarA</code>原可以不需要大改，就建造出<code>VirtualCarB</code>的，但是現在程式碼全部耦合在一起，它已經變得不可擴張了。</p>
<p>如果我們一開始就依照「依賴倒置原則」，我們來看看擴張會有多容易</p>
<p><img alt="toycar_2" src="https://www.ycc.idv.tw/media/SOLID_Introduction/toycar_2.png"></p>
<p><code>VirtualCar</code>中的很多方法都可以在B車款上再重用，大大的減少重新開發的成本。</p>
<ul>
<li>
<p>依賴倒置原則又稱為「面向接口原則」，這裡的接口應該想的更廣義一點，不侷限在interface上，我認為只要藉由抽象化將架構擬定出來的這些抽象單元都可以稱作接口，「廣義的接口」可以是指</p>
</li>
<li>
<p>客戶端和業務邏輯的分離介面</p>
</li>
<li>物件的開放方法</li>
<li>抽象類別</li>
<li>定義行為的interface</li>
</ul>
<p>我們不讓作為實現的類別彼此依賴，而是使用接口將抽象架構擬定好，再讓類別去依賴接口實現目標。</p>
<h5>接口分隔原則(Interface Segregation Principle, ISP)</h5>
<ul>
<li>
<p>定義：Clients should not be forced to depend uponn interfaces that they don't use. The dependency of one class to another one should depend on the smallest possible interface.（客戶類不應該被強迫依賴那些它不需要的接口，類別間的彼此依賴應該建立在盡可能小的接口上）</p>
</li>
<li>
<p>這裡說的接口同樣的是剛剛所說的「廣義接口」，可以是客戶端和業務邏輯的分離介面、物件的開放方法、抽象類別和Interface。</p>
</li>
<li>
<p>接口分隔原則建議我們要讓這些廣義接口盡可能的細切，但在實務上，切的過細會導致程式碼非常零碎難以閱讀，所以YC的建議是切到遵守「單一職責原理」就足夠了，與剛剛的建議一致，Interface一定要遵守「單一職責原理」，但是類別就盡力而為吧！</p>
</li>
<li>
<p>範例：剛剛玩具車公司的設計圖其實還是不夠好，如果今天公司想要開發新的車款C，添加新「方向盤」的功能，你會發現夢魘又再次的降臨，抽象類別<code>ToyCar</code>、<code>VirtualCar</code>、<code>Controller</code>都需要改變，而且就算真的把「方向盤」的相關方法添加上去，抽象類別也會開始出現多於一的職責，所以我們用Interface來重新改寫架構，如下圖所示。不難看出，控制馬達、控制速度、控制搖桿的行為是彼此依賴的，我們可以將他們的行為由Interface獨立拉出並相互依賴。</p>
</li>
</ul>
<p><img alt="toycar_3" src="https://www.ycc.idv.tw/media/SOLID_Introduction/toycar_3.png"></p>
<p>如此一來，當我們想要開發新的車款C，添加新「方向盤」的功能，也能輕鬆的擴充，如下所示。<code>ToyCarPlus</code>、<code>VirtualCarPlus</code>、<code>ControllerPlus</code>是我們實作C車款的抽象類別，它現在可以直接套用<code>IMotor</code>、<code>ISpeed</code>、<code>IControlBar</code>的Interface。</p>
<p><img alt="toycar_4" src="https://www.ycc.idv.tw/media/SOLID_Introduction/toycar_4.png"></p>
<h5>總結：物件導向的指導原則—SOLID</h5>
<p>上面介紹的六大原理：</p>
<ol>
<li>Single Responsibility Principl</li>
<li>Open-Closed Principle</li>
<li>Liskov Subsititution Principle</li>
<li>Law of Demeter</li>
<li>Interface Segregation Principle</li>
<li>Dependence Inversion Principle</li>
</ol>
<p>剛剛好組成SOLID這個單字，所以又被統稱SOLID原則。</p>
<p>事實上，這些原則所要達到的目的，不外乎就是我們<a href="http://www.ycc.idv.tw/YCNote/post/47">第一篇</a>當中所介紹的好的程式碼特性：「正常執行」、「穩健」、「不重複撰寫」、「可讀性」、「可擴展」，或者是「低耦合、高內聚」，所以寫程式時如果能時時注意，說不定你也可以自己領會這六大法則。</p>
<p>我來快速的總結這六大法則告訴我們的事：</p>
<ol>
<li>在開發程式的初期，先定義好抽象架構，也就是廣義的接口，徹底的使客戶端與業務邏輯分離，將「行為」定義成Interface，將「類別的泛化」定義成Abstract Class。</li>
<li>所有的實體類別都依賴於抽象，細節依賴於抽象。</li>
<li>每個單元盡量達到：單一權責、對延伸開放但對修改封閉、盡可能少的對外方法。</li>
<li>牽涉「繼承」，必須要問自己：子類可以替換父類執行嗎？父類是不是為子類的交集？</li>
<li>類別中的方法僅能訪問那些類別出現在自身、成員變數、方法的輸入和輸出參數中的。</li>
</ol>
<p>如此一來，我們心中就有一個準則去使用物件導向。</p>
<p>在一般情形下，這三篇的內容應該就足夠讓你寫出好的程式碼，但是實際面上使用仍然會碰到許多問題，於是乎有人將問題整理並總結出一些套路，這就是「設計模式」，我們以後再來談談吧！今天就先到這。</p>
<h5>Reference</h5>
<ol>
<li><a href="https://www.tenlong.com.tw/products/9789866761799">大話設計模式</a></li>
<li><a href="https://www.tenlong.com.tw/products/9787111437871">設計模式之禪</a></li>
</ol></dd>
                <dt>2018 / 4月 10</dt>
                <dd><a href="./introduction-object-oriented-programming_2.html">物件導向武功秘笈（2）：招式篇 — Python與Java的物件導向編程介紹</a></dd>
                <dd style="border-style:solid;border-width:0.5px;padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vw;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><h5>物件導向編程</h5>
<p><a href="http://www.ycc.idv.tw/YCNote/post/47">在上一章當中</a>，我們藉由好的程式碼的特性：「正常執行」、「穩健」、「不重複撰寫」、「可讀性」、「可擴展」，自然而然引出物件導向的概念。在這一章當中YC會接續介紹完整的物件導向要如何實現，包括物件導向三大特性：封裝、繼承和多型。</p>
<p>在本章我會採用兩種語言交叉作說明，一種是靜態型別的語言Java，另一種是動態型別的語言Python，這兩種語言都是可以實現物件導向的語言，而所謂型別的動態與靜態可以用一個簡單的方法來區分：型別檢查(Type Checking)發生在什麼時候？像Java這類的靜態型別語言，它的型別檢查是在編譯時期(Compile Time)完成的，而像是Python這類的動態型別語言，它的型別檢查則是在執行時期(Runtime)才去做，所以Python可以不事先宣告變數型別，這點使得Python在開發上方便許多。</p>
<p>雖然Python和Java都是支援物件導向的語言，但在使用上有很大的差異，首先，因為Python的動態型別，所以有些物件導向的性質對它來說就不是那麼重要，另外，因為Python追求簡潔，簡化了相當多的東西，所以很多的使用方法不同於傳統的物件導向，需要認識到這些差異才可以讓你使用Python的物件導向不會顯得很彆扭。Java是一套對物件導向支援非常完整的語言，而Python是一套易於快速開發的語言，使用兩種語言說明物件導向是為了讓讀者更能了解物件導向的本質，而非語言本身。</p>
<p>本篇採用『<a href="https://www.tenlong.com.tw/products/9789866761799">大話設計模式</a>』書中的物件導向篇範例。</p>
<h5>類別(Class)與物件(Object)</h5>
<p>首先來看物件導向的基本組成，類別(Class)與物件(Object)。
<em> 類別：建立物件的藍圖，描述所建立的物件共同的屬性和方法。
</em> 物件：一個自我包含的實體，物件包括屬性（Properties）和方法（Methods），屬性就是需要記憶的資訊，方法就是物件能夠提供的服務。</p>
<p>舉個例子，我想要創造一隻有名字的貓，她有喵喵叫的能力，在Java中可以寫成</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">class</span> <span class="nc">Cat</span> <span class="o">{</span>  <span class="c1">//{1}</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span> <span class="c1">//{2}</span>

    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="c1">//{3}</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span> <span class="c1">//{4}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span> <span class="c1">//{5}</span>
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. meow~&quot;</span><span class="o">;</span> <span class="c1">//{6}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span> <span class="c1">//{7}</span>
        <span class="n">Cat</span> <span class="n">cat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cat</span><span class="o">(</span><span class="s">&quot;May&quot;</span><span class="o">);</span> <span class="c1">//{8}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">shout</span><span class="o">());</span> <span class="c1">//{9}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// output:</span>
<span class="c1">// My name is May. meow~</span>
</pre></div>


<p>{1} 建構一個<code>Cat</code>的類別，類別不是物件，類別只是物件的藍圖。</p>
<p>{2} 建立一個私有變數<code>name</code>，用來代表貓的名字，我們使用<code>private</code>的修飾詞讓它是私有的，也就是說外部環境沒辦法去讀取到這個變數，只有物件內部才可以讀取的到</p>
<p>{3} 提供建造方法(constructor)來初始化這一個物件，初始化需要<code>name</code>的參數。</p>
<p>{4} 在初始化的過程中，我們會將從外部讀取的<code>name</code>存入私有變數<code>this.name</code>裡，在Java裡頭，如果外部變數名稱與本地變數名稱相同，需要使用<code>this</code>來特別區分。</p>
<p>{5} 創造一個公開的類別方法<code>shout()</code>。</p>
<p>{6} 使用私有變數<code>name</code>讓貓可以自我介紹，再發出喵喵叫的聲音。</p>
<p>{7} Java只要遇到<code>main</code>就會去執行，方法<code>main</code>具有靜態方法的修飾詞<code>static</code>，也就是說<code>Test</code>不需要被實體化也能執行<code>main</code>這個方法。</p>
<p>{8} 使用<code>new</code>來創造一個物件，在創造的過程會執行初始化，所以必須放入初始化需要的參數<code>name</code>，所以上面的新的物件有了<code>"May"</code>的名字。</p>
<p>{9} 接下來使用<code>cat.shout()</code>去執行喵喵叫的動作，這個方法會回傳字串，再利用<code>System.out.println</code>的方法將字串顯示出來。注意！在物件導向的習慣中，會用<code>.</code>來表示在那物件中的方法或屬性，所以<code>cat.shout()</code>就是執行在物件<code>cat</code>中的方法<code>shout()</code>。</p>
<p>再來看Python怎麼表示，</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span> <span class="c1">#{1}</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span> <span class="c1">#{2}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__name</span> <span class="o">=</span> <span class="n">name</span> <span class="c1">#{3}</span>

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1">#{4}</span>
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">__name</span><span class="o">+</span><span class="s2">&quot;. meow~&quot;</span> <span class="c1">#{5}</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">cat</span> <span class="o">=</span> <span class="n">Cat</span><span class="p">(</span><span class="s2">&quot;May&quot;</span><span class="p">)</span> <span class="c1">#{6}</span>
    <span class="k">print</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">shout</span><span class="p">())</span> <span class="c1">#{7}</span>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span> <span class="c1">#{8}</span>
    <span class="n">main</span><span class="p">()</span>

<span class="c1"># output:</span>
<span class="c1"># My name is May. meow~</span>
</pre></div>


<p>{1} 建構<code>Cat</code>的類別，這是Python3的表示方法，如果是使用Python2.7的話，要寫成<code>class Cat(object):</code>才可以。</p>
<p>{2} Python的初始化方法，Python在初始化之前會先自行執行<code>__new__</code>的方法，這個過程會產生一個新的物件，也就是實體化，而這個新的物件會以第一個參數的方法被帶入<code>__init__</code>的方法裡進行初始化，我們通常會命名這個變數為<code>self</code>，這裡的<code>self</code>已經是個物件而不是類別，那初始化的過程需要引入外部資訊<code>name</code>的參數來進行命名，所以第二個參數就要設<code>name</code>，記住喔！第一個參數是Python自動產生的，不是由外部帶入的，所以外部只要給<code>name</code>一個參數就足夠了。</p>
<p>{3} 創造一個私有本地變數<code>__name</code>來將<code>name</code>存入，在Python當中以雙底線<code>__</code>開頭的變數會被視為是「私有的」，效果和Java的<code>private</code>接近，不過Python並沒有這麼嚴格禁止外部去讀取私有變數，所以需要配合工程師的自我規範。</p>
<p>{4} 類別方法<code>shout()</code>，只要你不是靜態的類別方法，Python都會自動幫你帶入物件資訊當作第一個參數，通常命名為<code>self</code>，那為什麼靜態方法沒有自動帶入，因為靜態方法不用實體化，所以根本不擁有物件的資訊。</p>
<p>{5} 使用到本地的<code>self.__name</code>變數</p>
<p>{6} 創造一個物件，在創造的過程會執行初始化，所以必須放入初始化需要的參數<code>name</code>，所以上面的新的物件有了<code>"May"</code>的名字。</p>
<p>{7} 接下來使用<code>cat.shout()</code>去執行喵喵叫的動作，這個方法會回傳字串，再利用<code>print</code>的方法將字串顯示出來。注意！在物件導向的習慣中，會用<code>.</code>來表示在那物件中的方法或屬性，所以<code>cat.shout()</code>就是執行在物件<code>cat</code>中的方法<code>shout()</code>。</p>
<p>{8} 在Python程式執行時，它的<code>__name__</code>會是<code>"__main__"</code>，也就是說會去執行這個<code>if</code>判斷式下面的程式。</p>
<h5>方法多載（Method Overloading）</h5>
<p>物件導向允許「使用不同的參數形式去實現同一個方法」，這就稱之為方法多載，這個方法涵蓋一般方法和構造初始化方法。</p>
<p>來延伸剛剛的貓的例子，假設今天我們允許用戶不去設定貓咪的名字，而程式會預先給貓咪No-Name的預設值，所以我們需要另外一個初始化方法是不用貓咪名字的參數形式。</p>
<p>Java的實現程式碼如下所示，如此一來只要碰到沒有參數的形式，程式會給予<code>"No-Name"</code>的名字去當作貓咪的名字，並進行初始化。</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">class</span> <span class="nc">Cat</span> <span class="o">{</span>  
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span> 

    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> 
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span> 
    <span class="o">}</span>
    <span class="c1">// method overloading</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="s">&quot;No-Name&quot;</span><span class="o">);</span> <span class="c1">// given &quot;No-Name&quot; as its name</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. meow~&quot;</span><span class="o">;</span> 
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span> 
        <span class="n">Cat</span> <span class="n">cat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cat</span><span class="o">();</span> <span class="c1">// no-argumant format</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">shout</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// output:</span>
<span class="c1">// My name is No-Name. meow~</span>
</pre></div>


<p>但在Python當中，不允許這種「相同方法名稱，卻又不同參數形式」，Python採用其他的方式來產生同樣的方法多載效果，如以下所示，我們可以看到Python使用default方法來實現多載，只要我們不給予<code>name</code>，它的default就是<code>"No-Name"</code>。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span> 
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;No-Name&quot;</span><span class="p">):</span> <span class="c1"># name&#39;s default is &quot;No-Name&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__name</span> <span class="o">=</span> <span class="n">name</span> 

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">__name</span><span class="o">+</span><span class="s2">&quot;. meow~&quot;</span> 

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">cat</span> <span class="o">=</span> <span class="n">Cat</span><span class="p">()</span> <span class="c1"># no-argument format</span>
    <span class="k">print</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">shout</span><span class="p">())</span> 

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span> 
    <span class="n">main</span><span class="p">()</span>

<span class="c1"># output:</span>
<span class="c1"># My name is No-Name. meow~</span>
</pre></div>


<h5>物件導向三大特性—封裝(Encapsulation)</h5>
<p>還記得「低耦合，高內聚」的原則嗎？為了符合這原則，每個物件都要盡可能的去包含需要用到的屬性和方法，並且使得外部不能以不合理的方法去影響物件，這就稱之為「封裝」。</p>
<p>我們來看看上次的成果，我們就用這個例子來說明「封裝」。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">class</span> <span class="nc">Calculation</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nums</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span> <span class="o">=</span> <span class="n">nums</span> <span class="c1">#{1}</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__checkPositiveInteger</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__checkPositiveInteger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span> <span class="c1">#{2}</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">num</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid positive integer: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__primeFactorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span> <span class="c1">#{3}</span>
        <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">while</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">prime_factorize</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">num</span> <span class="o">/=</span> <span class="n">i</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">prime_factorize</span>

    <span class="k">def</span> <span class="nf">findGCF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span><span class="p">:</span>
            <span class="n">prime_factorize</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__primeFactorize</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

        <span class="n">common_prime</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">prime_factorize</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">common_prime</span> <span class="o">&amp;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pf</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="n">gcf</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="n">common_prime</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
            <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">prime_factorize</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">pf</span><span class="p">[</span><span class="n">prime</span><span class="p">])</span>
            <span class="n">gcf</span> <span class="o">=</span> <span class="n">gcf</span> <span class="o">*</span> <span class="p">(</span><span class="n">prime</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">gcf</span>

    <span class="k">def</span> <span class="nf">findLCM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">gcf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findGCF</span><span class="p">()</span>
        <span class="n">lcm</span> <span class="o">=</span> <span class="n">gcf</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span><span class="p">:</span>
            <span class="n">lcm</span> <span class="o">*=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="o">/</span><span class="n">gcf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lcm</span>
</pre></div>


<p>{1} 使用私有變數，讓外部不能任意的改變<code>self.__name</code>變數，在這個例子當中，如果<code>self.__name</code>被任意改變，它將會逃過<code>__checkPositiveInteger</code>的檢查。
{2}&amp;{3} 不需要由外部讀取的方法，就盡量讓它是私有的。</p>
<p>再回到貓咪的這個例子，如果我們想要可以調控「叫聲次數」的話，可以這樣實現。</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">class</span> <span class="nc">Cat</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="s">&quot;No-Name&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">shout_num</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span> <span class="c1">//{1}</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getShoutNum</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">shout_num</span><span class="o">;</span> <span class="o">}</span> <span class="c1">//{2}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setShoutNum</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span> <span class="c1">//{3}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">IllegalArgumentException</span><span class="o">();</span>
        <span class="n">shout_num</span> <span class="o">=</span> <span class="n">num</span><span class="o">;</span> 
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">shout_num</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s">&quot;meow~ &quot;</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Cat</span> <span class="n">cat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cat</span><span class="o">(</span><span class="s">&quot;May&quot;</span><span class="o">);</span>
        <span class="n">cat</span><span class="o">.</span><span class="na">setShoutNum</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span> <span class="c1">//{4}</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">shout</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// output:</span>
<span class="c1">// My name is May. meow~ meow~ meow~ meow~ meow~</span>
</pre></div>


<p>{1} 設置私有變數<code>shout_num</code>來決定叫聲次數。</p>
<p>{2} 為了做到封裝，外部不能直接去讀取<code>shout_num</code>，而是經由<code>getShoutNum</code>的外部方法來得到叫聲次數，這個<code>getXXX</code>的形式在物件導向裡頭被稱為Getter。</p>
<p>{3} 為了做到封裝，外部不能直接去改變<code>shout_num</code>，而是經由<code>setShoutNum</code>的外部方法來以合理的方法改變叫聲次數，在這個方法中，我們會先檢查再設定，如果是直接的改變<code>shout_num</code>將會少了這一份檢查，這個<code>setXXX</code>的形式在物件導向裡頭被稱為Setter。</p>
<p>{4} 使用Setter方法由外部來改變叫聲次數。</p>
<p>在Python中，Getter和Setter被簡化了。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;No-Name&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__shout_num</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="nd">@property</span>  <span class="c1">#{1}</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__shout_num</span>

    <span class="nd">@shoutNum.setter</span>  <span class="c1">#{2}</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__shout_num</span> <span class="o">=</span> <span class="n">num</span>

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__shout_num</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;meow~ &quot;</span>
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">__name</span><span class="o">+</span><span class="s2">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">cat</span> <span class="o">=</span> <span class="n">Cat</span><span class="p">(</span><span class="s2">&quot;May&quot;</span><span class="p">)</span>
    <span class="n">cat</span><span class="o">.</span><span class="n">shout_num</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1">#{3}</span>
    <span class="k">print</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">shout</span><span class="p">())</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

<span class="c1"># output:</span>
<span class="c1"># My name is May. meow~ meow~ meow~ meow~ meow~</span>
</pre></div>


<p>{1} Python使用Decorator<code>@property</code>來創造Getter，一旦加上了<code>@property</code>，當下的函數方法就會變成一種性質。</p>
<p>{2} 再使用<code>shout_num.setter</code>來替<code>shout_num</code>這個特性加上Setter。</p>
<p>{3} 然後我們就可以以像是修改一般變數的方式來修改<code>shout_num</code>，但實際上<code>shout_num</code>是有被封裝的，如此一來就可以更為簡潔，不用去寫<code>getXX</code>和<code>setXXX</code>等囉唆的寫法。</p>
<h5>物件導向三大特性—繼承(Inheritance)</h5>
<p>還記得「Don't Repeat Yourself」原則嗎？物件導向同樣提供了這個選項，「繼承」可以讓子類擁有父類的屬性和方法，避免不必要的重寫，但同時也會增加父類和子類之間的耦合，所以使用時要去評估它影響了多少耦合性。</p>
<p>子類可以先繼承父類的屬性和方法，再去新增屬於子類自己的屬性和方法，甚至還可以去覆寫父類的方法，這稱之為方法覆寫(Method Overriding)，有了這些方法，子類可以在不重複撰寫父類方法的情況下，去增加自己的特色和自己的功能。</p>
<p>依循著剛剛的例子，如果我們今天想要增加狗的類別，但是又不想重複撰寫相同的部分，所以我們可以選擇創造動物的類別，再讓貓和狗繼承自動物。</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">class</span> <span class="nc">Animal</span> <span class="o">{</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span> <span class="c1">//{1}</span>

    <span class="kd">public</span> <span class="nf">Animal</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Animal</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="s">&quot;No-Name&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kt">int</span> <span class="n">shout_num</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getShoutNum</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">shout_num</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setShoutNum</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">IllegalArgumentException</span><span class="o">();</span>
        <span class="n">shout_num</span> <span class="o">=</span> <span class="n">num</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Cat</span> <span class="kd">extends</span> <span class="n">Animal</span><span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">name</span><span class="o">);</span> <span class="c1">//{2}</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">shout_num</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s">&quot;meow~ &quot;</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">extends</span> <span class="n">Animal</span><span class="o">{</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">shout_num</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s">&quot;woof~ &quot;</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>{1} <code>protected</code>的效果和<code>private</code>一樣，讓外部無法讀取到內部的私有化，但是<code>private</code>無法被「繼承」，而<code>protected</code>可以被繼承，所以如果希望可以被繼承的私有變數或方法，就使用<code>protected</code>。</p>
<p>{2} <code>super</code>指的是父類，這裡我們使用父類來做初始化，事實上這邊可以不用再初始化一次，子類本身就會繼承父類的初始化方法，所以可以像<code>Dog</code>一樣省略不寫。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="k">class</span> <span class="nc">Animal</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;No-Name&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1">#{1}</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span>
    <span class="nd">@shout_num.setter</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span> <span class="o">=</span> <span class="n">num</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;No_Name&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>  <span class="c1">#{2}</span>

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;meow~ &quot;</span>
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="o">+</span><span class="s2">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span>
<span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="s2">&quot;woof~ &quot;</span>
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="o">+</span><span class="s2">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span>
</pre></div>


<p>{1} Python的<code>protected</code>使用單底線<code>_</code>開頭表示。</p>
<p>{2} <code>super</code>指的是父類，這裡我們使用父類來做初始化，事實上這邊可以不用再初始化一次，子類本身就會繼承父類的初始化方法，所以可以像<code>Dog</code>一樣省略不寫。</p>
<h5>抽象化：抽象類別(Abstract Class)、抽象方法(Abstract Method)和接口(Interface)</h5>
<p>事實上，剛剛使用<code>Animal</code>的方法並不是很正確，我們將<code>Animal</code>當作一個類別處理，所以<code>Animal</code>其實是可以被實例化的，但是<code>Animal</code>根本沒有什麼有用的方法，它必須被繼承後再添加方法才有用處，所以我們其實可以把<code>Animal</code>抽象化，將<code>Animal</code>視為抽象類別，其中擁有一些方法需要在子類實現的，稱為抽象方法，我們直接看怎麼做。</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Animal</span> <span class="o">{</span> <span class="c1">//{1}</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Animal</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Animal</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="s">&quot;No-Name&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kt">int</span> <span class="n">shout_num</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getShoutNum</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">shout_num</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setShoutNum</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">IllegalArgumentException</span><span class="o">();</span>
        <span class="n">shout_num</span> <span class="o">=</span> <span class="n">num</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span> <span class="c1">//{2}</span>
        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">shout_num</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">getShoutSound</span><span class="o">()+</span><span class="s">&quot; &quot;</span><span class="o">;</span> <span class="c1">//{3}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">abstract</span> <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getShoutSound</span><span class="o">();</span> <span class="c1">//{4}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Cat</span> <span class="kd">extends</span> <span class="n">Animal</span><span class="o">{</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getShoutSound</span><span class="o">()</span> <span class="o">{</span> <span class="c1">//{5}</span>
        <span class="k">return</span> <span class="s">&quot;meow~&quot;</span><span class="o">;</span> 
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">extends</span> <span class="n">Animal</span><span class="o">{</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getShoutSound</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;woof~&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>


<p>{1} 使用<code>abstract class</code>修飾詞來創建抽象類別，只有在抽象類別中才可以擁有抽象方法，抽象類別不能直接被實例化。</p>
<p>{2} 抽象類別也可以有一般的具體方法。</p>
<p>{3} 這裡使用的<code>getShoutSound()</code>方法要等在子類才會被實現。</p>
<p>{4} 使用<code>abstract</code>設置抽象方法，繼承自抽象類別的子類必須要完全實現所有的抽象方法。</p>
<p>{5} 實現抽象方法。</p>
<p>在Python中沒有原生的抽象類別和方法，必須<code>import abc</code>。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="k">class</span> <span class="nc">Animal</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span> <span class="c1">#{1}</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;No-Name&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span>
    <span class="nd">@shout_num.setter</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span> <span class="o">=</span> <span class="n">num</span>

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getShoutSound</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; &quot;</span>
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="o">+</span><span class="s2">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span>  
    <span class="nd">@abc.abstractmethod</span>  <span class="c1">#{2}</span>
    <span class="k">def</span> <span class="nf">_getShoutSound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_getShoutSound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1">#{3}</span>
        <span class="k">return</span> <span class="s2">&quot;meow~&quot;</span>

<span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_getShoutSound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;woof~&quot;</span>
</pre></div>


<p>{1} 繼承<code>abc.ABC</code>來建立抽象類別。</p>
<p>{2} 使用<code>@abc.abstractmethod</code>來建立抽象方法。</p>
<p>{3} 實現抽象方法。</p>
<p>還有一種類型抽象化的更為徹底，稱之為「接口」，「接口」上的所有方法都是抽象未實現的，「接口」不能擁有任何具體的方法。雖然「接口」很像是完全抽象化的「抽象類別」，也確實可以利用「抽象類別」來創造「接口」，但是兩者的意義是不同的，「抽象類別」是從子類中發現共通的東西，而泛化出現的，但是「接口」可以根本不預先知道子類是什麼，而僅僅事先定義行為本身，換句話說，「抽象類別」是類別的抽象化，而「接口」則是行為的抽象化。</p>
<p>例如，我想要讓某些動物擁有「飛」的能力，這是一個行為，而不會事先知道它會套用到哪一個類別上面。</p>
<p>在Java之中只允許單一繼承，但是卻可以有多個「接口」；而Python沒有現成的「接口」可以使用，我們必須使用「抽象方法」來創造「接口」，所以開發者要謹記「接口」的限制：不能有任何的具體方法，因為Python允許多重繼承，所以就可以直接將模擬「接口」的抽象類別直接疊加上去。</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">interface</span> <span class="nc">IFly</span> <span class="o">{</span> <span class="c1">//{1}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">flyTo</span><span class="o">(</span><span class="n">String</span> <span class="n">place</span><span class="o">);</span> <span class="c1">//{2}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">FlyingCat</span> <span class="kd">extends</span> <span class="n">Cat</span> <span class="kd">implements</span> <span class="n">IFly</span> <span class="o">{</span> <span class="c1">//{3}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">flyTo</span><span class="o">(</span><span class="n">String</span> <span class="n">place</span><span class="o">)</span> <span class="o">{</span> <span class="c1">//{4}</span>
        <span class="k">return</span> <span class="n">shout</span><span class="o">()+</span><span class="s">&quot; I&#39;m going to fly to &quot;</span><span class="o">+</span><span class="n">place</span><span class="o">+</span><span class="s">&quot;.&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Test</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">FlyingCat</span> <span class="n">cat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlyingCat</span><span class="o">(</span><span class="s">&quot;May&quot;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cat</span><span class="o">.</span><span class="na">flyTo</span><span class="o">(</span><span class="s">&quot;Taiwan&quot;</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// output: </span>
<span class="c1">// My name is May. meow~ meow~ meow~ I&#39;m going to fly to Taiwan.</span>
</pre></div>


<p>{1} 使用<code>interface</code>創建「接口」，我們習慣會使用開頭大寫I來表示Interface(接口)。</p>
<p>{2} 「接口」定義未實現的抽象方法<code>flyTo</code>。</p>
<p>{3} <code>FlyingCat</code>繼承自<code>Cat</code>並且裝上<code>IFly</code>的「接口」。</p>
<p>{4} 必須實現「接口」上所有的抽象方法。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="k">class</span> <span class="nc">IFly</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span> <span class="c1">#{1}</span>
    <span class="nd">@abc.abstractmethod</span> <span class="c1">#{2}</span>
    <span class="k">def</span> <span class="nf">flyTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">place</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">FlyingCat</span><span class="p">(</span><span class="n">Cat</span><span class="p">,</span><span class="n">IFly</span><span class="p">):</span> <span class="c1">#{3}</span>
    <span class="k">def</span> <span class="nf">flyTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">place</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shout</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; I&#39;m going to fly to &quot;</span><span class="o">+</span><span class="n">place</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="p">;</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">cat</span> <span class="o">=</span> <span class="n">FlyingCat</span><span class="p">(</span><span class="s2">&quot;May&quot;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">fly</span><span class="p">(</span><span class="s2">&quot;Taiwan&quot;</span><span class="p">))</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

<span class="c1"># output: </span>
<span class="c1"># My name is May. meow~ meow~ meow~ I&#39;m going to fly to Taiwan.</span>
</pre></div>


<p>{1} 使用抽象類別來創造「接口」。</p>
<p>{2} 要注意！「接口」裡頭不能有具體方法。</p>
<p>{3} 直接使用多重繼承，將<code>IFly</code>安裝上去。</p>
<h5>物件導向三大特性—多型(Polymorphism)</h5>
<p>最後，來講講物件導向的最後一個特性，那就是「多型」。「多型」的涵義是指「子類可以以父類的身分出現」，而因為是以父類的角色出現，所以只能執行父類擁有的方法，也就是只能執行這些子類共同泛化分享的方法，當然不同的子類實現後的效果會不一樣，不然使用「多型」的意義就不大了，至於子類自己的特殊方法則不可以使用「多型」去執行。</p>
<p>直接來看範例，假設今天我要邀請三隻貓貓狗狗來參加叫聲比賽，分別請他們叫個幾聲來聽聽，此時就需要使用到「多型」的方法。</p>
<div class="highlight"><pre><span></span><span class="cm">/* Java */</span>

<span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">Animal</span> <span class="o">{</span> 
    <span class="kd">protected</span> <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Animal</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="nf">Animal</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="s">&quot;No-Name&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="kt">int</span> <span class="n">shout_num</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getShoutNum</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">shout_num</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setShoutNum</span><span class="o">(</span><span class="kt">int</span> <span class="n">num</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">IllegalArgumentException</span><span class="o">();</span>
        <span class="n">shout_num</span> <span class="o">=</span> <span class="n">num</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">shout</span><span class="o">()</span> <span class="o">{</span> 
        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">shout_num</span><span class="o">;</span> <span class="n">i</span><span class="o">++){</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="n">getShoutSound</span><span class="o">()+</span><span class="s">&quot; &quot;</span><span class="o">;</span> 
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">&quot;My name is &quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">abstract</span> <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getShoutSound</span><span class="o">();</span> 
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Cat</span> <span class="kd">extends</span> <span class="n">Animal</span><span class="o">{</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getShoutSound</span><span class="o">()</span> <span class="o">{</span> 
        <span class="k">return</span> <span class="s">&quot;meow~&quot;</span><span class="o">;</span> 
    <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">extends</span> <span class="n">Animal</span><span class="o">{</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getShoutSound</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;woof~&quot;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ShoutGame</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Animal</span><span class="o">[]</span> <span class="n">arrayAnimal</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Animal</span><span class="o">[</span><span class="mi">3</span><span class="o">];</span> <span class="c1">//{1}</span>
        <span class="c1">// polymorphism</span>
        <span class="n">arrayAnimal</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cat</span><span class="o">(</span><span class="s">&quot;May&quot;</span><span class="o">);</span> <span class="c1">//{2}</span>
        <span class="n">arrayAnimal</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Dog</span><span class="o">(</span><span class="s">&quot;Linda&quot;</span><span class="o">);</span>
        <span class="n">arrayAnimal</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cat</span><span class="o">(</span><span class="s">&quot;Joy&quot;</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Animal</span> <span class="n">animal</span><span class="o">:</span> <span class="n">arrayAnimal</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">animal</span><span class="o">.</span><span class="na">shout</span><span class="o">());</span> <span class="c1">//{3}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// output: </span>
<span class="c1">// My name is May. meow~ meow~ meow~</span>
<span class="c1">// My name is Linda. woof~ woof~ woof~</span>
<span class="c1">// My name is Joy. meow~ meow~ meow~</span>
</pre></div>


<p>{1} 創建<code>Animal</code>的Array，Animal是抽象類別不能實體化，這裡預定要放的是它的繼承實現類別。</p>
<p>{2} 將<code>Cat</code>和<code>Dog</code>任意放到<code>Animal</code>的Array是可以的，此時就套用「多型」，不管是<code>Cat</code>和<code>Dog</code>都是以<code>Animal</code>的形式出現，只能執行<code>Animal</code>有的方法。</p>
<p>{3} <code>shout()</code>是父類<code>Animal</code>有的方法，可以被執行。</p>
<p>而在Python當中，「多型」就沒這麼重要了，因為Python具有「鴨子型別」（Duck Typing），什麼是「鴨子型別」呢？有一句話道出它的意義：「當看到一隻鳥走起來像鴨子、游泳起來像鴨子、叫起來也像鴨子，那麼這隻鳥就可以被稱為鴨子」，因為Python是動態型別的語言，變數型態不需要事先宣告，所以一個變數具有彈性可以放入任意型別，直到出現不合適的使用方法，才會報錯，所以在Python中變數可以任意放入不同的類別的物件，只要確保這些類別都具有這些變數所需要用到的方法，就可以了，這不正是接近「多型」的概念。</p>
<div class="highlight"><pre><span></span><span class="c1">### Python3.4</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="k">class</span> <span class="nc">Animal</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span> 
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;No-Name&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span>
    <span class="nd">@shout_num.setter</span>
    <span class="k">def</span> <span class="nf">shout_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span> <span class="o">=</span> <span class="n">num</span>

    <span class="k">def</span> <span class="nf">shout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_shout_num</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getShoutSound</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; &quot;</span>
        <span class="k">return</span> <span class="s2">&quot;My name is &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="o">+</span><span class="s2">&quot;. &quot;</span><span class="o">+</span><span class="n">result</span>  
    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">_getShoutSound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Cat</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_getShoutSound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;meow~&quot;</span>

<span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_getShoutSound</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;woof~&quot;</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Shout Game</span>
    <span class="n">arrayAnimal</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#{1}</span>
    <span class="n">arrayAnimal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Cat</span><span class="p">(</span><span class="s2">&quot;May&quot;</span><span class="p">))</span> 
    <span class="n">arrayAnimal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Dog</span><span class="p">(</span><span class="s2">&quot;Linda&quot;</span><span class="p">))</span>
    <span class="n">arrayAnimal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Cat</span><span class="p">(</span><span class="s2">&quot;Joy&quot;</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">animal</span> <span class="ow">in</span> <span class="n">arrayAnimal</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">animal</span><span class="p">,</span><span class="n">Animal</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">TypeError</span> <span class="c1">#not necessary #{2}</span>
        <span class="k">print</span><span class="p">(</span><span class="n">animal</span><span class="o">.</span><span class="n">shout</span><span class="p">())</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

<span class="c1"># output: </span>
<span class="c1"># My name is May. meow~ meow~ meow~</span>
<span class="c1"># My name is Linda. woof~ woof~ woof~</span>
<span class="c1"># My name is Joy. meow~ meow~ meow~</span>
</pre></div>


<p>{1} 要存入多型的List不需要特別處理。</p>
<p>{2} 可以檢查是不是繼承自<code>Animal</code>，以確保多型的嚴格定義，但這個過程是非必要的。</p>
<h5>總結：物件導向使用方法</h5>
<p>好！我們花了好大的力氣，終於了解如何在Java和Python中使用物件導向。從一開始的「類別」和「物件」講起，再來談到物件導向的三大特性：「封裝」、「繼承」和「多型」，還談到方法可以「多載」也可以「覆寫」，以及一些抽象化的東西，包括「抽象類別」、「抽象方法」和「接口」。</p>
<p>但是等等！你知道該怎麼運用這些技巧嗎？沒錯，僅僅是了解這些招式不足以讓你寫出卓越的程式碼，你還需要了解如何使用，就像是外功招式還得配合內功才可以是一套完整的功夫，否則只是半吊子而已，我們將在下一章節中來帶大家了解如何去使用這些招式。</p></dd>
                <dt>2018 / 4月 05</dt>
                <dd><a href="./introduction-object-oriented-programming_1.html">物件導向武功秘笈（1）：認知篇 — 什麼是好的程式？</a></dd>
                <dd style="border-style:solid;border-width:0.5px;padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vw;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><h5>物件導向為何重要？</h5>
<p>我相信很多朋友一定像YC我一樣，想要學某個程式語言，就去買那個程式語言的簡介書籍，然後一章一章的唸下去，這種書通常會先教變數怎麼設定？然後再教if、while、for、function等程式邏輯。</p>
<p>那如果你學的是「物件導向」的語言，譬如：Java、C++、Python，接下來的章節就會開始介紹「類別」、「物件」等等難懂的東西，然後就會陷入一種霧煞煞的狀態，然後心中就會出現一種聲音：為什麼寫個程式你跟我扯什麼「物件」？我原本用前面所學的方法就可以完成所有事情啦！為何要把事情弄的這麼複雜？這東西到底有什麼好處啊？</p>
<p>YC一開始也是充滿著疑惑，然後一知半解的就把這些定義記在心中，然後天真的認為「物件導向」只是讓程式比較整齊的方法罷了！直到後來學了資料結構與演算法，然後又學了一點設計模式，然後又有過幾個大型軟體開發的經驗，一路走過才漸漸的了解「物件導向」是怎麼一回事？</p>
<p>所以我打算把這些收穫用三篇文章來說明，好讓讀者們可以少走一點冤枉路，在第一篇中，也就是本篇，我會帶大家認識好的程式是長什麼樣子的，它擁有什麼樣的特點，有了正確的認知，除了可以讓我們避免寫出糟糕的程式之外，我們也才能漸漸的認識到「物件導向」為何重要。</p>
<h5>程式的好壞？</h5>
<p>一開始，我們必須要對程式培養出鑑賞能力，我曾經聽過電視上有一位歌唱老師說過：「好的歌手必須先練他的聽力」，我覺得相同的，一個好的Programmer要先培養出對於程式的鑑賞能力。</p>
<p>首先，一個好的程式當然要「能正常執行」，要能滿足客戶的需求，這是基本款，所以一般而言我們會使用很多的測試去看看程式是否可以正常運作，我們會找一些一般的條件來測試，我們也會找一些合法但是位於極端條件的例子，也就是邊界條件（Edge Case）來測試，或者找一些不合法的例子試試程式是否可以排除錯誤條件。</p>
<p>測試可以即早的發現Bug，即早的治療，如果真的發現有Bug的話，接下來就是去找出Bug的源頭，這可就相當的困難，這裡想像一下喔！如果你的程式總共有1000行，而當你測試時發現有Bug，那想從這麼多行當中找出Bug的來源是相當困難的，所以好的方法是這樣的，先將一個大任務分解成為幾個小任務，然後完成這幾個小任務後，逐一的進行測試，稱之為「單元測試」，最後在將這些測試完成的小任務組合成為大任務，然後再做最後的總測試，這麼一來就可以避免在大範圍中找尋Bug，又可以做到對程式從裡到外的完整測試以達到程式「能正常執行」的目的。</p>
<p>這裡提出一個問題讓大家思考，究竟要使用什麼方法去解析問題？讓我們可以有條理的拆解出小「單元」，來組合出最後的目標，有沒有一個系統化的思考方法？</p>
<p>第二點，一個好的程式必須是「穩健的」(Robust)，程式原本能用的功能，不會因為更新、不會因為添加新功能，就出現錯誤！要做到這一點，除了剛剛說的「單元」拆分以外，還要讓「單元」和「單元」之間不會有太多的彼此影響，這麼一來在原先的功能所調用的「單元」不被動到的前提下，我還可以新增新的功能，才能做到「穩健的」特質。</p>
<p>第三點，一個好的程式必須具備「不重複撰寫」的特性，有一句經典的法則叫做「Don't Repeat Yourself」，不要去重複寫已經寫過的程式碼，如果是重複需要用到的「單元」我們就把它獨立出來，讓其他程式去調用它，對於工程師來說，「不重複撰寫」意味著可以少寫一點程式碼，增加開發的速度，更重要的是，調用公享的程式碼可以讓程式更有邏輯，更具一致性，能夠減少出錯的可能性。</p>
<p>第四點，好的程式要具有「可讀性」，軟體開發常常是長時間、多人合作、龐大的程式碼，如果程式碼沒有具備清晰的邏輯、沒有在該註解的部分寫清楚、沒有一個統一的規範，這樣的開發終就會陷入泥坑，永遠解不完的Bug會不斷的出現，解了一個又產生一個，永無止盡的輪迴，而且最慘的是完全不清楚真正的源頭在哪裡，這可是軟體工程師的夢魘啊！</p>
<p>第五點，一個好的程式要具備「可擴展」，工程師最討厭的一句話應該就是客戶說：「我突然想到我還需要XXX功能，這只是在這邊再多一點而已，應該不難吧！」呵呵～通常「這多一點」就要大大的修改整個程式碼，弄不好還可能把原本的功能給搞壞，所以工程師應該在設計的一開始就考慮到會有什麼潛在需要更改的部分，而先採取因應措施，好讓程式易於擴展，好讓自己不會因此而加班！</p>
<h5>低耦合、高內聚</h5>
<p>再重複一次，一個好的程式要具備「正常執行」、「穩健」、「不重複撰寫」、「可讀性」、「可擴展」的特性，請將這些原則記在心裡，隨時的檢視自己的程式是不是有違反這些規則。</p>
<p>而剛剛我們有了一個大致的想法：將任務分成幾個小的「單元」是一個很好的策略，而為了讓程式「穩健」，這些「單元」之間不能有太多的相依性；但是站在另外一個角度看，為了讓程式「不重複撰寫」，我們需要讓一個「單元」使用另外一個「單元」，好讓工程師可以做到「Don't Repeat Yourself」，如此一來則是增加了「單元」間的相依性，這兩者是一個Trade-off。</p>
<p>有關「單元」的相依性有兩個重要術語—耦合性(Coupling)和聚合性(Cohesion)，耦合性指的是「單元」和「單元」之間資訊或參數依賴的程度，所以我們要追求「低耦合」。聚合性指的是「單元」內使用到自身資訊或參數的程度，所以我們要追求「高內聚」，通常「低耦合」都會伴隨著「高內聚」。</p>
<h5>程式碼精練之旅</h5>
<p>來看個例子，假設今天我想要實現一個求最大公因數的計算機，使用<strong>Python</strong>隨便寫一段程式碼可能是這樣的。</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">str_numA</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer A: &quot;</span><span class="p">)</span>
    <span class="n">str_numB</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer B: &quot;</span><span class="p">)</span>

    <span class="n">numA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numA</span><span class="p">)</span>
    <span class="n">numB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numB</span><span class="p">)</span>

    <span class="n">prime_factorize_A</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span><span class="p">(</span><span class="n">numA</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">numA</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prime_factorize_A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize_A</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">numA</span> <span class="o">/=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">prime_factorize_B</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span><span class="p">(</span><span class="n">numB</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">numB</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prime_factorize_B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize_B</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">numB</span> <span class="o">/=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>    

    <span class="n">common_prime</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize_A</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize_B</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">gcf</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">common_prime</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">prime_factorize_A</span><span class="p">[</span><span class="n">prime</span><span class="p">],</span><span class="n">prime_factorize_B</span><span class="p">[</span><span class="n">prime</span><span class="p">])</span>
        <span class="n">gcf</span> <span class="o">=</span> <span class="n">gcf</span> <span class="o">*</span> <span class="p">(</span><span class="n">prime</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Greatest Common Factor: &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gcf</span><span class="p">))</span>
</pre></div>


<p>好！那接下來用剛剛的規則來檢視看看這個程式，第一點，有沒有「可正常執行」？上述的例子，沒有考慮到一些Edge Case，當輸入的值不是正整數，必須要報錯，所以我們將程式修改一下。</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">str_numA</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer A: &quot;</span><span class="p">)</span>
    <span class="n">str_numB</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer B: &quot;</span><span class="p">)</span>

    <span class="n">numA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numA</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">numA</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid positive integer: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">numA</span><span class="p">))</span>
    <span class="n">numB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numB</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">numB</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid positive integer: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">numB</span><span class="p">))</span>

    <span class="n">prime_factorize_A</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span><span class="p">(</span><span class="n">numA</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">numA</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prime_factorize_A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize_A</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">numA</span> <span class="o">/=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">prime_factorize_B</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span><span class="p">(</span><span class="n">numB</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">numB</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prime_factorize_B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize_B</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">numB</span> <span class="o">/=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>    

    <span class="n">common_prime</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize_A</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize_B</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">gcf</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">common_prime</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">prime_factorize_A</span><span class="p">[</span><span class="n">prime</span><span class="p">],</span><span class="n">prime_factorize_B</span><span class="p">[</span><span class="n">prime</span><span class="p">])</span>
        <span class="n">gcf</span> <span class="o">=</span> <span class="n">gcf</span> <span class="o">*</span> <span class="p">(</span><span class="n">prime</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Greatest Common Factor: &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gcf</span><span class="p">))</span>
</pre></div>


<p>再來檢查一下是不是具有「不重複撰寫」的特性？也就是Don't Repeat Yourself，顯然是沒有遵守，<code>numA</code>和<code>numB</code>處理方法幾乎一模一樣，這會造成程式碼很冗長，來稍做修改。</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">checkPositiveInteger</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">num</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid positive integer: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">primeFactorize</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">checkPositiveInteger</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

    <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prime_factorize</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">num</span> <span class="o">/=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">prime_factorize</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">str_numA</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer A: &quot;</span><span class="p">)</span>
    <span class="n">str_numB</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer B: &quot;</span><span class="p">)</span>

    <span class="n">numA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numA</span><span class="p">)</span>
    <span class="n">numB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numB</span><span class="p">)</span>

    <span class="n">prime_factorize_A</span> <span class="o">=</span> <span class="n">primeFactorize</span><span class="p">(</span><span class="n">numA</span><span class="p">)</span>
    <span class="n">prime_factorize_B</span> <span class="o">=</span> <span class="n">primeFactorize</span><span class="p">(</span><span class="n">numB</span><span class="p">)</span>

    <span class="n">common_prime</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize_A</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize_B</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">gcf</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">common_prime</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">prime_factorize_A</span><span class="p">[</span><span class="n">prime</span><span class="p">],</span><span class="n">prime_factorize_B</span><span class="p">[</span><span class="n">prime</span><span class="p">])</span>
        <span class="n">gcf</span> <span class="o">=</span> <span class="n">gcf</span> <span class="o">*</span> <span class="p">(</span><span class="n">prime</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Greatest Common Factor: &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gcf</span><span class="p">))</span>
</pre></div>


<p>接下來來檢查一下「穩健度」和「可擴展」，也就是程式是否符合：低耦合、高內聚，其實上面的程式碼有一個大問題，客戶端邏輯和業務邏輯混為一談，客戶端邏輯就是實現功能的部分，而業務邏輯就是實作的細節，所以上面的程式碼把所有的實作的細節全部攤在客戶端，這是相當不好的，這會造成不易更改，因此我們將程式作單元的拆分，讓業務邏輯和客戶端邏輯相分離，讓不直接實現客戶端的程式碼可以隱藏起來，減少客戶端和業務邏輯的耦合。然後順道加入求取最小公倍數的功能。</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="k">def</span> <span class="nf">checkPositiveInteger</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">num</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid positive integer: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">primeFactorize</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="n">checkPositiveInteger</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

    <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prime_factorize</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">num</span> <span class="o">/=</span> <span class="n">i</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">prime_factorize</span>

<span class="k">def</span> <span class="nf">findGCF</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>
    <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
        <span class="n">prime_factorize</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">primeFactorize</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

    <span class="n">common_prime</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">prime_factorize</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">common_prime</span> <span class="o">&amp;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pf</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">gcf</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="n">common_prime</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">prime_factorize</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">pf</span><span class="p">[</span><span class="n">prime</span><span class="p">])</span>
        <span class="n">gcf</span> <span class="o">=</span> <span class="n">gcf</span> <span class="o">*</span> <span class="p">(</span><span class="n">prime</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">gcf</span>

<span class="k">def</span> <span class="nf">findLCM</span><span class="p">(</span><span class="n">nums</span><span class="p">):</span>
    <span class="n">gcf</span> <span class="o">=</span> <span class="n">findGCF</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
    <span class="n">lcm</span> <span class="o">=</span> <span class="n">gcf</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
        <span class="n">lcm</span> <span class="o">*=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="o">/</span><span class="n">gcf</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lcm</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">str_numA</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer A: &quot;</span><span class="p">)</span>
    <span class="n">str_numB</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer B: &quot;</span><span class="p">)</span>

    <span class="n">numA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numA</span><span class="p">)</span>
    <span class="n">numB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numB</span><span class="p">)</span>

    <span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">numA</span><span class="p">,</span><span class="n">numB</span><span class="p">]</span>    
    <span class="n">gcf</span> <span class="o">=</span> <span class="n">findGCF</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
    <span class="n">lcm</span> <span class="o">=</span> <span class="n">findLCM</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Greatest Common Factor: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gcf</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Lowest Common Multiple: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lcm</span><span class="p">))</span>
</pre></div>


<p>如此一來程式碼就看起來乾淨很多，function和function之間的耦合性被降低了，而function本身的內聚性提高了，程式碼達到了低耦合、高內聚，但是似乎還可以更好。</p>
<h5>形塑出物件導向</h5>
<p>剛剛我們已經完成了一個看起來很乾淨的程式碼了，但是其實還可以更好，在這裡我們就必須形塑出物件導向，才有辦法再前進一步。</p>
<p>剛剛的程式碼當中的<code>checkPositiveInteger(num)</code>, <code>primeFactorize(num)</code>, <code>findGCF(nums)</code>, <code>findLCM(nums)</code>函數其實都是實現同一個目標—因式計算，但卻是被寫成一個一個獨立的函數，這裡的內聚性還可以再更好。</p>
<p>而且<code>checkPositiveInteger(num)</code>, <code>primeFactorize(num)</code>並不是用來實現主要的目的，而只是實現目的過程中，為了避免重複而產生的，這樣寫很容易讓人不清楚什麼是重要的函數，而什麼只是中繼的函數，這裡的「可讀性」應該還可以再提升。</p>
<p>輸入的數字<code>nums</code>對於<code>findGCF</code>和<code>findLCM</code>，應該是一模一樣的，有沒有一個方法可以讓<code>nums</code>避免重複呢？以增強「不要重複撰寫」的原則。</p>
<p>要擁有以上的功能，我們需要一個「物件」，這個「物件」能夠保有屬於它的變數，才可以儲存<code>nums</code>等參數，變數可以是對外公布的，也可以是私有的。另外,這個「對象」擁有屬於它的函數方法，而方法一樣可以是對外公布的，也可以是私有的，所以我們可以公布<code>findGCF(nums)</code>, <code>findLCM(nums)</code>，而私有化
<code>checkPositiveInteger(num)</code>, <code>primeFactorize(num)</code>。我們使用「藍圖」去建構「物件」的模版，再由「藍圖」配合不同的輸入參數去生成一個一個獨立的「物件」，以因應不同的狀況。</p>
<p>這就是物件導向！</p>
<p>接下來，我將上面程式碼引入物件導向改寫如下。（看不懂～沒關係！未來會詳述）</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="k">class</span> <span class="nc">Calculation</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nums</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span> <span class="o">=</span> <span class="n">nums</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__checkPositiveInteger</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__checkPositiveInteger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">num</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid positive integer: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__primeFactorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
        <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">while</span><span class="p">(</span><span class="n">num</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">prime_factorize</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prime_factorize</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">num</span> <span class="o">/=</span> <span class="n">i</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">prime_factorize</span>

    <span class="k">def</span> <span class="nf">findGCF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">prime_factorize</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span><span class="p">:</span>
            <span class="n">prime_factorize</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__primeFactorize</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>

        <span class="n">common_prime</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">prime_factorize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">prime_factorize</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">common_prime</span> <span class="o">&amp;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">pf</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="n">gcf</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">prime</span> <span class="ow">in</span> <span class="n">common_prime</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
            <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">prime_factorize</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">pf</span><span class="p">[</span><span class="n">prime</span><span class="p">])</span>
            <span class="n">gcf</span> <span class="o">=</span> <span class="n">gcf</span> <span class="o">*</span> <span class="p">(</span><span class="n">prime</span> <span class="o">**</span> <span class="n">m</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">gcf</span>

    <span class="k">def</span> <span class="nf">findLCM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">gcf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findGCF</span><span class="p">()</span>
        <span class="n">lcm</span> <span class="o">=</span> <span class="n">gcf</span>
        <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nums</span><span class="p">:</span>
            <span class="n">lcm</span> <span class="o">*=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="o">/</span><span class="n">gcf</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lcm</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">str_numA</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer A: &quot;</span><span class="p">)</span>
    <span class="n">str_numB</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Positive Integer B: &quot;</span><span class="p">)</span>

    <span class="n">numA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numA</span><span class="p">)</span>
    <span class="n">numB</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_numB</span><span class="p">)</span>

    <span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">numA</span><span class="p">,</span><span class="n">numB</span><span class="p">]</span>
    <span class="n">calc</span> <span class="o">=</span> <span class="n">Calculation</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
    <span class="n">gcf</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">findGCF</span><span class="p">()</span>
    <span class="n">lcm</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">findLCM</span><span class="p">()</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Greatest Common Factor: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gcf</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Lowest Common Multiple: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lcm</span><span class="p">))</span>
</pre></div>


<h5>總結：程式碼鑑賞能力</h5>
<p>本章YC帶大家建立一種品味，像是藝術評論家一樣，我們學會了如何鑑賞好的程式碼，我們提到了好的程式碼須要符合「正常執行」、「穩健」、「不重複撰寫」、「可讀性」、「可擴展」的特性，並且提到我們要追求低耦合、高內聚，但是「不重複撰寫」的這個原則會和低耦合相互違和，所以工程師要小心拿捏！有了鑑賞能力，我們開始精練我們的程式，而自然而然就可以引出物件導向的概念。當然，物件導向不只如此啦！我們下章就會看到物件導向還有什麼花拳繡腿。</p></dd>
                <dt>2018 / 2月 03</dt>
                <dd><a href="./the-selfish-gene.html">自私的基因：基因觀點下的天擇</a></dd>
                <dd style="border-style:solid;border-width:0.5px;padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vw;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><h5>物競天擇？</h5>
<p>『自私的基因』是當代相當重要的一本書，它在生物學上的地位等同於在物理學上的『時間簡史』。作者理察·道金斯（Richard Dawkins）是一個跨領域的通才，曾獲得動物學學士學位、文學碩士、哲學博士以及科學博士，我認為也是因為這樣的跨領域學習，才能讓他完成這樣一本創作俱佳的好書。</p>
<p>達爾文的天擇說提出後，生物學開始有了一個思考的脈絡來描述生物的演化，天擇說告訴我們「物競天擇，適者生存、不適者淘汰」，地球上目前存在的物種是多年來環境盲目篩選後的結果，但我們會發現如果以物種為單位來說明天擇會有一些說不清的地方。</p>
<p>舉個例子，物種的利他行為，例如許多小型鳥類遇到老鷹時會發出警訊給同伴，通知同伴趕快逃跑，這毫無疑問的是一種利他行為，發出警訊將會使自己暴露在危險之中，而換取到的是其他同伴的安全，針對這樣的利他行為，「群體選擇」理論會說生物會因演化而做出對種族有利的事，作者認為這是一種謬誤，生物間應該無法輕易的區分種族，就算可以，那我們又如何去劃分層次，要從界、門、綱、目、科、屬、種哪個層面下手去有意識的幫助自己的種族呢？以物種為單位的天擇說僅能說明生物本身的自利行為，但是解釋不清楚利他行為如何形成。</p>
<p>作者道金斯受到魏斯曼（A. Weismann）的學說「生殖細胞的延續性」所啟蒙，提出了天擇利己主義的基本單位，既非種，也非群體，亦非個體，而是「基因」（Gene）這個遺傳的基本單位。而也正是基因的自私行為才造就個體的利他行為，基因傾向於保全與自己基因相似的個體，以獲得基因本身的延續，基因是自私的，所以本書的書名才會叫做『自私的基因』。</p>
<h5>生命源自於複製</h5>
<p>為了說清楚基因觀點下的演化，我們回到四十億年前的地球，那時的地球海洋已經形成，稱之為太古混湯（primeval soup），海洋中存在著大量的基本化合物，譬如：水、二氧化碳、甲烷和氮。這些基本化合物會因為化學作用，而可能有機會合併形成更大、更複雜的化合物，在那個時候大的有機化合物因為沒有存在細菌可以分解它，所以是可以被完整保存下來的，直到有一天出現了一種可以自我複製的化合物，它就開始大量形成相同的化學結構，而且方便的是太古混湯擁有大量的垂手可得的建材，所以可以大量的複製出更多的複製者，這樣的複製就開始擴張開來。</p>
<p>當然像這類的複製者不只一種，太古混湯中夾雜許多可以自我複製的化合物種類，而且就連複製者在複製的過程當中都可能會出錯而產生出其他形式的複製者，當複製者越來越多，造成太古混湯開始缺乏素材而無法供養所有的複製者，競爭就開始了，天擇就開始了！而能存活的複製者必須符合長命、生產力大、複製正確度高等特性，否則將無法在歷史的長河中留下。</p>
<p>競爭只會隨著時間日益增加而不會減少，為了存活（不是有意識的，而是天擇的結果）複製者開始改良自身，增加自身的穩定性，瓦解對手的穩定度，譬如：形成蛋白質保護自己、形成可以分解對手分子鍵結的能力以得到更多的建材，為了生存，複製者走向發展出更精細的、更複雜的求生機器。</p>
<p>四十億年過去了，這些複製者在今日被稱之為基因，多個基因組成DNA，DNA可以轉譯成蛋白質分子來打造出求生機器，求生機器是承載基因的「工具」，承載數千、數萬個基因，每具肉體都是基因精巧的共同傑作，想要區分這個基因和另一個基因的貢獻，幾乎是做不到的。</p>
<p>書中作者用划船來作比喻，划船人員就像是基因，而這艘船就像是個體，當個體無法繁殖，這組團隊就像是輸了比賽就會被淘汰，而獲勝的團隊將可能在未來與其他的基因合作繼續的比賽下去，這艘船的每個船員都有適合他的位置，可能有船首、舵手或尾槳，把人放在適合的位置才可以發揮最好的實力，那麼最後存活下來的物種就是擁有好基因彼此之間合作無間的成果。</p>
<h5>基因的代理人—神經網絡</h5>
<p>動物和植物不同之處，動物擁有快速的行為，譬如遇到敵人就要拔腿就跑、看到獵物就要採取攻擊，這一些快速的行為不可能由基因直接控制，因為基因的影響速度太慢了，可能需要幾個月的時間，所以基因依造它們的需求打造出了神經網絡，然後神經網絡就接管了個體每時每刻的行為，才能因應各種環境的變化去做出相應的行為，使得個體得以生存，幫助基因可以繼續繁衍下去，如果用電腦來比喻的話，圍棋程式AlphaGo在比賽之前是由人類打造而成的，但是在真正比賽時，它會依照當下狀況去自行下決定，基因也是一樣的，基因先打造好神經網絡，接下來個體的行為就由這些神經網絡來代理了。</p>
<h5>再談利他行為</h5>
<p>好的基因產生的神經網絡所造就的動物行為，是要可以幫助基因複製自身的，基因是自私的，但不是有意識的，而是天擇造就了自私的基因得以存活下來，也正是這一層關係，物種的利他行為仍然是基因自私的結果。</p>
<p>像是一開始舉例的，小鳥會發出叫聲來提醒其他同伴，這樣的行為對個體是不利的，但是犧牲的個體可以保全其他相似的基因存活，這個基因就會延續下去。在人類社會，父母親給予子女的愛是無私的，但是這還是基因自私的結果，對子女無私的基因傾向讓子女更容易活下去，所以這樣的基因存活下來，相反的會拋下子女的基因，如果不能配合嬰兒時期可以自行生存的基因，這些子女也就會提早夭折，這樣的基因就會消失在歷史的長河裡頭。</p>
<p>因此，所有的生物行為都只有一個目的—讓基因複製下去，而環境會做出審判，作者還進一步的使用賽局理論來解釋哪些行為會是有利的、哪些行為會造成不利，譬如說某個族群50%的個體不喜歡起衝突而50%的個體喜歡追殺到底，想當然爾，如果這個種族在競爭食物時，喜歡追殺到底的個體比較有利，所以不喜歡起衝突的個體會數量減少，所以接下來可能是存在20%的個體不喜歡起衝突而80%的個體喜歡追殺到底，因此喜歡追殺到底的個體很容易遇到一樣喜歡追殺到底的個體，這些喜歡衝突的個體可能會弄的兩拜俱傷，而不喜歡衝突的個體可能使用逃跑的方式躲避反而是存活下來了，此時就會出現數量上的反轉，最後會形成一種平衡，稱為「演化穩定策略」（evolutionary stable strategy, ESS），那當然不會有全然不喜歡衝突和喜歡衝突的個體，所以這樣的平衡是反應在基因上面的，基因在編寫神經網絡的時候就會擬定一個對它最有利的穩定策略，當這個策略奏效，這樣的基因就得以存活。</p>
<p>這個部分讓我想起一個遊戲叫做<a href="https://audreyt.github.io/trust-zh-TW/">信任的演化</a>，這個遊戲是一個欺騙和合作的遊戲，當雙方都彼此合作時，會出現雙贏，而一方欺騙的情況下，欺騙者得利，另一方損失，如果雙方都欺騙則雙方都得不到好處。遊戲中有多個角色採取不同的策略，其中：「紅嬰仔」會一直信任對方，「黑到底」則會一直欺騙，「模仿貓」則是一開始採取合作的態度，當對方欺騙時在下一回合欺騙他，當對方合作時在下一回合就與他合作。當我們將這些角色丟進去進行多次的賽局，失敗者淘汰，成功者複製，在多次賽局之後你會發現「模仿貓」會勝出，利用這個遊戲你就能了解有限度的利他行為是如何勝出的，而基因所產生行為也就是在這樣多次的賽局下修正成有限度的利他行為。</p>
<h5>文化的複製者—迷因（Meme）</h5>
<p>基因為了自己的利益編寫出了神經網絡來幫助自己存活下去，但基因萬萬沒想到它所開發的東西居然會反過來對它不利！</p>
<p>人類的基因產生了非常厲害的人腦，的確是有助於基因的繁衍，你看地球上的人口數量就知道了，但是大腦複雜到一個程度，就產生了思想，人類發展出了語言作溝通，文化得以使用語言或文字傳承下去，這在定義上也是一種複製者，這種文化的複製因子，作者將它稱之為迷因（Meme）。</p>
<p>迷因（Meme）也是彼此競爭著，它們競爭的是你有限的大腦，如果你的大腦有資本主義，可能就容不下共產主義，而迷因也會不斷的改善自己，讓它們可以贏得競爭，然後傳播出去並大量的被複製。而有些時候迷因的競爭對手可能不只是其他迷因，也有可能會和基因作對，譬如說使用保險套的迷因，正阻止了基因的複製，激烈的宗教信仰的迷因，使人走向自殺式攻擊，同樣也是不利於基因的繁衍。</p>
<p>這讓我想起最近人工智慧的興起，很多人對人工智慧開始產生擔憂，擔心機器人會反撲人類，如果依照上述的觀點看，這個可能是有機會發生的，程式設計師就像是基因，為了我們自身的目的去創造人工智慧來為我們服務，但是如果人工智慧越來越聰明，而且它的運算速度又比人類快，我們會根本無法理解人工智慧在想什麼，但是它們也確實是幫助人類解決很多問題，所以就算無法理解也就繼續的使用著，直到有一天，這些人工智慧在運作中突變出一種可以複製自己的複製者，也許是一種病毒，而這樣的複製者又能快速在人工智慧溝通中被傳遞出去，它就有可能回頭做出不利於人類的事。</p>
<h5>結語：複製與競爭</h5>
<p>本書讓我們重新認識了演化論，有了可以自己複製自己的複製者，就會有擴張，擴張的結果就是資源的稀缺，因此就自然產生競爭，在競爭的過程中，成功的策略符合ESS使得複製者得以存活下來，而失敗的複製者則會被淘汰、無法複製下去，這就是天擇的適者生存。從這一層的思想讓我們對於演化有了更深的認識，如果是生物的演化這個複製者就是基因，如果是文化的演化這個複製者就是迷因，也許你能想到其他的複製者，歡迎在下面留言讓大家知道。</p></dd>
                <dt>2017 / 11月 09</dt>
                <dd><a href="./uwarn-performance_1.html">[吉他] 方大同-三人遊</a></dd>
                <dd style="border-style:solid;border-width:0.5px;padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vw;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><p><br/></p>
<iframe width="100%" height="450" src="https://www.youtube.com/embed/8lwc81a9mAo"  frameborder="0" gesture="media" allowfullscreen></iframe></dd>
                <dt>2017 / 11月 08</dt>
                <dd><a href="./uwarn-performance_2.html">[吉他] 光良-傷心地鐵</a></dd>
                <dd style="border-style:solid;border-width:0.5px;padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vw;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><p><br/></p>
<iframe width="100%" height="450" src="https://www.youtube.com/embed/7KpOh8N-9Z0" frameborder="0" gesture="media" allowfullscreen></iframe></dd>
                <dt>2017 / 9月 05</dt>
                <dd><a href="./stock-sell-point.html">股票策略：移動停損法</a></dd>
                <dd style="border-style:solid;border-width:0.5px;padding:15px;margin-top:10px;margin-bottom:50px;max-height:60vw;overflow:hidden;pointer-events:none;background-color:rgb(250,250,250);"><p>最近在研究股票，在網路上看到這篇文章</p>
<p>https://m.mobile01.com/topicdetail.php?f=291&amp;t=3065829&amp;p=1</p>
<p>覺得相當實用，在這邊跟大家分享，並且當作給自己參考的筆記。</p>
<p>一般我們常常說玩股票要做好風險管理，最廣為人知的就是設停損點，假設今天我以20元買入一張股票，假如停損比率設10%好了，那我的停損點就是18元，股票一到這個價位就忍痛賣出，以做到風險管理，避免自己大賠。</p>
<p>停損點的另外一個相反就是停利點，也就是當賺到某一個比例的金額時就獲利了結，假設一樣20元買入一張股票，設20%停利，也就是24元的時候賣出，設停利原本的目的是為了讓自己賣在高點，不過卻是有可能造成反效果。</p>
<p>如果今天你幸運的買到一張飆股，一連兩天漲了兩根來到了24元，到了你設下的停利點，你不會真的就把它給賣了吧！正常人應該會等它漲到夠了，等它開始反轉時再考慮賣出。那究竟應該在反轉後跌多少才應該賣？這就變成了新的問題，總不能還是以停損點當作賣點吧！那你應該永遠賺不到錢～</p>
<p>所以這篇的作者提供了一個方法，把停損點和停利點結合成為一點，而這一點會隨著股價上漲而移動上漲，所以下面的網友就稱這個叫做移動停損法。聽起來很神奇，其實概念很簡單，</p>
<blockquote>
<p>從買入當天開始算起，以過程的每天當中最高股價當作基準點，向下去設停損點，或是停利點，低於這點就當天賣，或隔天賣。</p>
</blockquote>
<p>這就是我們剛剛說的，等到股價反轉後再來賣，而這個方法也可以順便做到停損，所以這點既是停損點也是停利點，但行為上都一樣是賣出，差別只在於你有沒有賺到錢囉！所以接下來我會以「賣出點」來稱這一點，避免大家被混淆。</p>
<p>舉個例子好了，如果第一天我以50元買入一張股票，當天最高價位來到了51元，所以過程中最高價位目前是51元，假設我停損停利設10%，所以如果第二天股價低於51*90%=45.9元就賣出，45.9元就是目前的賣出點，假設未來都沒有價位超出51元，那賣出點永遠都在45.9元不會變。好，如果到了第二天，它飆上去了，收盤54元，最高價位曾經來到了55元，此時賣出點也跟著增加，以買股以來的最高價55元當作新的基準向下10％算出新的賣出點，也就是55*90%=49.5元，第三天氣勢依舊，開盤直接跳空漲停，最高價位來到了59.4元，所以賣出點目前是59.4*90%=53.45元，第四天開始反轉，微微下跌，最低價來到55元，最高價為57元，沒有低於賣出點所以不賣，此時賣出點也沒有改變，因為最高價沒有超過第三天，所以一樣是用第三天當作基準點向下算出賣出點53.45元，第五天終於稱不住了，股價跌到了53.45元，然後就當天賣出或隔天賣出，假如當天賣出的話，那就是53.45元，所以最後我的投報率是(53.45 - 50) / 50 = 6.9 %。</p>
<p>那這個停損停利的比例該怎麼訂呢？在這個作者寫這篇文章的時候漲跌停百分比為7%，所以他設10%很合理，不會只有一天跌停就賣出了，而目前的漲跌停百分比為10%，所以我認為應該設把停損停利百分比設更高一點，建議在10~15%之間。</p>
<p>那如果遇到除息的話，當然要將你口袋裡的股息從最高價上扣掉，在重新計算賣出點，這樣的賣出點才合理。</p>
<p>以上的策略在一種情形下會賺錢，那就是你投資的股票漲的比跌的還多，當然這是一句廢話啦！這讓我想起之前在跟我朋友聊股票，我朋友說他的股票都賠錢，我就跟他開玩笑，股票不就是買在低點，然後賣在高點，你怎麼不照做，難怪會賠錢。移動停損法提供一種紀律讓你不會賠太多，但如果真的要獲利的話，還是得從基本面或技術面去分析股票，並在低價買進好股票，然後等它上漲。</p></dd>
            </dl>
        </div>
    </div>
<!-- /Navigation -->
<div class="container navigation">
    	<a class="navigate pull-right" href="./index2.html">Next <i class="fa fa-caret-right"></i></a>
</div>              
<!-- /Navigation --> 
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Sitemap</div>
                        <ul class="list-unstyled">
                            <li><a href="./archives.html">Archives</a></li>
                            <li><a href="./tags.html">Tags</a></li>
                            <li><a href="YCNote/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">Atom Feed</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">Contact Me</div>
                        <ul class="list-unstyled">
                            <li><a href="./about-me.html" target="_blank">About Me</a></li>
                            <li><a href="https://github.com/GitYCC" target="_blank">Github</a></li>
                            <li><a href="mailto:ycc.tw.email@gmail.com" target="_blank">Email</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                    </div> 
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                        <p class="pull-right text-right">
                            <small><em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank">pelican</a></em></small><br/>
                            <small><em>Theme and code by <a href="https://github.com/molivier" target="_blank">molivier</a></em></small><br/>
                            <small>&copy; YC Note 2018</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>